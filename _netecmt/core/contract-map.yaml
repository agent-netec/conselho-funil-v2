# NETECMT APC Contract Mapping
# Defines which paths belong to which lane for automated auditing (sprint-audit)

lanes:
  core:
    paths:
      - "_netecmt/core/**"
    contract: "_netecmt/contracts/core.md"

  bmm:
    paths:
      - "_netecmt/core/**"
    contract: "_netecmt/contracts/bmm.md"

  bmb:
    paths:
      - "_netecmt/core/**"
    contract: "_netecmt/contracts/bmb.md"

  config:
    paths:
      - "_netecmt/_config/**"
      - "_netecmt/core/config.yaml"
    contract: "_netecmt/contracts/config.md"

  infrastructure:
    paths:
      - ".github/workflows/**"
      - ".agent/**"
      - ".claude/**"
      - ".cursor/**"
    contract: "_netecmt/contracts/infrastructure.md"

  orchestration:
    paths:
      - "app/src/lib/ai/prompts/party-mode.ts"
    contract: "_netecmt/contracts/party-mode-contracts.md"

  brand_hub:
    paths:
      - "app/src/app/brand-hub/**"
      - "app/src/lib/ai/brand-governance.ts"
    contract: "_netecmt/contracts/brand-hub-spec.md"

  dashboard:
    paths:
      - "app/src/app/page.tsx"
      - "app/src/components/dashboard/**"
      - "app/src/lib/hooks/use-stats.ts"
      - "app/src/lib/firebase/firestore.ts"
    contract: "_netecmt/contracts/dashboard-spec.md"

  ai_retrieval:
    paths:
      - "app/src/lib/ai/**"
    contract: "_netecmt/contracts/retrieval-contracts.md"

  social_intelligence:
    paths:
      - "app/src/lib/intelligence/social/**"
      - "app/src/app/api/social/**"
      - "app/src/types/social.ts"
    contract: "_netecmt/contracts/social-api-spec.md"

  personalization_engine:
    paths:
      - "app/src/lib/operations/personalization/**"
      - "app/src/app/api/operations/personalization/**"
    contract: "_netecmt/contracts/personalization-engine-spec.md"

  operations_meta:
    paths:
      - "app/src/lib/operations/meta/**"
      - "app/src/app/api/operations/meta/**"
    contract: "_netecmt/contracts/operations-api-contracts.md"

  operations_infrastructure:
    paths:
      - "app/src/app/api/webhooks/**"
      - "app/src/lib/security/monara/**"
    contract: "_netecmt/contracts/webhook-security-spec.md"

  brand_voice:
    paths:
      - "app/src/lib/ai/brand-voice/**"
      - "app/src/lib/ai/brand-governance.ts"
    contract: "_netecmt/contracts/brand-voice-spec.md"

  intelligence_wing:
    paths:
      # Storage & Data Access
      - "app/src/lib/intelligence/**"
      - "app/src/lib/firebase/intelligence.ts"
      # Competitors & Spy Agent
      - "app/src/lib/intelligence/competitors/**"
      - "app/src/app/api/intelligence/spy/**"
      # Types
      - "app/src/types/intelligence.ts"
      - "app/src/types/intelligence-agents.ts"
      - "app/src/types/competitors.ts"
      # Agents
      - "app/src/lib/agents/scout/**"
      - "app/src/lib/agents/analyst/**"
      - "app/src/lib/agents/spy/**"
      # UI Components
      - "app/src/components/intelligence/**"
      - "app/src/app/intelligence/**"
      # API Routes
      - "app/src/app/api/intelligence/**"
      # Hooks
      - "app/src/lib/hooks/use-intelligence*.ts"
    contract: "_netecmt/contracts/intelligence-storage.md"

  competitor_intelligence:
    paths:
      - "app/src/lib/intelligence/competitors/**"
      - "app/src/types/competitors.ts"
      - "app/src/app/api/intelligence/spy/**"
    contract: "_netecmt/contracts/competitor-intelligence-spec.md"

  funnel_autopsy:
    paths:
      - "app/src/app/api/intelligence/autopsy/**"
      - "app/src/lib/intelligence/autopsy/**"
      - "app/src/components/funnel-autopsy/**"
      - "app/src/types/autopsy.ts"
    contract: "_netecmt/contracts/funnel-autopsy-spec.md"

  performance_war_room:
    paths:
      - "app/src/lib/performance/**"
      - "app/src/app/api/performance/**"
      - "app/src/components/performance/**"
      - "app/src/types/performance.ts"
    contract: "_netecmt/contracts/performance-spec.md"

# Audit Rules
audit_rules:
  - name: "boundary-check"
    description: "Fail if files outside lane paths are modified without multi-lane approval"
  - name: "contract-presence"
    description: "Fail if story belongs to lane but lane contract is missing or empty"
  - name: "pack-consistency"
    description: "Verify that Story Pack allowed-context.md refers specifically to the lane contract defined here"
  - name: "pre-flight-proxy-check"
    description: "Mandatory cleanup of HTTP_PROXY/HTTPS_PROXY variables in CI/CD environments before execution"
    enforcement: "pre-flight"
    scope: ["infrastructure", "core"]
