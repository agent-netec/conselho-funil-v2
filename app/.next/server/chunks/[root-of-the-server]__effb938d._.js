module.exports=[746894,e=>{"use strict";var r=e.i(843985),t=e.i(747065);let o="AWS_ACCESS_KEY_ID",i="AWS_SECRET_ACCESS_KEY",n="AWS_SESSION_TOKEN",a="AWS_CREDENTIAL_EXPIRATION",s="AWS_CREDENTIAL_SCOPE",l="AWS_ACCOUNT_ID";e.s(["ENV_ACCOUNT_ID",0,l,"ENV_CREDENTIAL_SCOPE",0,s,"ENV_EXPIRATION",0,a,"ENV_KEY",0,o,"ENV_SECRET",0,i,"ENV_SESSION",0,n,"fromEnv",0,e=>async()=>{e?.logger?.debug("@aws-sdk/credential-provider-env - fromEnv");let c=process.env[o],d=process.env[i],g=process.env[n],u=process.env[a],f=process.env[s],p=process.env[l];if(c&&d){let e={accessKeyId:c,secretAccessKey:d,...g&&{sessionToken:g},...u&&{expiration:new Date(u)},...f&&{credentialScope:f},...p&&{accountId:p}};return(0,r.setCredentialFeature)(e,"CREDENTIALS_ENV_VARS","g"),e}throw new t.CredentialsProviderError("Unable to find environment variable credentials.",{logger:e?.logger})}])},746448,e=>{"use strict";var r=e.i(746894),t=e.i(747065),o=e.i(318380),i=e.i(426149);let n="AWS_EC2_METADATA_DISABLED",a=async r=>{let{ENV_CMDS_FULL_URI:o,ENV_CMDS_RELATIVE_URI:a,fromContainerMetadata:s,fromInstanceMetadata:l}=await e.A(616800);if(process.env[a]||process.env[o]){r.logger?.debug("@aws-sdk/credential-provider-node - remoteProvider::fromHttp/fromContainerMetadata");let{fromHttp:t}=await e.A(260063);return(0,i.chain)(t(r),s(r))}return process.env[n]&&"false"!==process.env[n]?async()=>{throw new t.CredentialsProviderError("EC2 Instance Metadata Service access disabled",{logger:r.logger})}:(r.logger?.debug("@aws-sdk/credential-provider-node - remoteProvider::fromInstanceMetadata"),l(r))},s=!1,l=e=>e?.expiration!==void 0&&e.expiration.getTime()-Date.now()<3e5;e.s(["defaultProvider",0,(i={})=>{let n,c,d,g,u,f;return f=[async()=>{if(i.profile??process.env[o.ENV_PROFILE])throw process.env[r.ENV_KEY]&&process.env[r.ENV_SECRET]&&!s&&((i.logger?.warn&&i.logger?.constructor?.name!=="NoOpLogger"?i.logger.warn.bind(i.logger):console.warn)(`@aws-sdk/credential-provider-node - defaultProvider::fromEnv WARNING:
    Multiple credential sources detected: 
    Both AWS_PROFILE and the pair AWS_ACCESS_KEY_ID/AWS_SECRET_ACCESS_KEY static credentials are set.
    This SDK will proceed with the AWS_PROFILE value.
    
    However, a future version may change this behavior to prefer the ENV static credentials.
    Please ensure that your environment only sets either the AWS_PROFILE or the
    AWS_ACCESS_KEY_ID/AWS_SECRET_ACCESS_KEY pair.
`),s=!0),new t.CredentialsProviderError("AWS_PROFILE is set, skipping fromEnv provider.",{logger:i.logger,tryNextLink:!0});return i.logger?.debug("@aws-sdk/credential-provider-node - defaultProvider::fromEnv"),(0,r.fromEnv)(i)()},async r=>{i.logger?.debug("@aws-sdk/credential-provider-node - defaultProvider::fromSSO");let{ssoStartUrl:o,ssoAccountId:n,ssoRegion:a,ssoRoleName:s,ssoSession:l}=i;if(!o&&!n&&!a&&!s&&!l)throw new t.CredentialsProviderError("Skipping SSO provider in default chain (inputs do not include SSO fields).",{logger:i.logger});let{fromSSO:c}=await e.A(643449);return c(i)(r)},async r=>{i.logger?.debug("@aws-sdk/credential-provider-node - defaultProvider::fromIni");let{fromIni:t}=await e.A(916312);return t(i)(r)},async r=>{i.logger?.debug("@aws-sdk/credential-provider-node - defaultProvider::fromProcess");let{fromProcess:t}=await e.A(83092);return t(i)(r)},async r=>{i.logger?.debug("@aws-sdk/credential-provider-node - defaultProvider::fromTokenFile");let{fromTokenFile:t}=await e.A(435934);return t(i)(r)},async()=>(i.logger?.debug("@aws-sdk/credential-provider-node - defaultProvider::remoteProvider"),(await a(i))()),async()=>{throw new t.CredentialsProviderError("Could not load credentials from any providers",{tryNextLink:!1,logger:i.logger})}],g=async e=>{let r;for(let t of f)try{return await t(e)}catch(e){if(r=e,e?.tryNextLink)continue;throw e}throw r},u=async e=>{if(e?.forceRefresh)return await g(e);if(d?.expiration&&d?.expiration?.getTime()<Date.now()&&(d=void 0),n)await n;else if(!d||l?.(d))if(!d)return n=g(e).then(e=>{d=e,n=void 0}),u(e);else c||(c=g(e).then(e=>{d=e,c=void 0}));return d}}],746448)},411497,e=>{"use strict";var r=e.i(843985),t=e.i(73355),o=e.i(747065),i=e.i(924868),n=e.i(961948),a=e.i(946980),s=e.i(473441);async function l(e,r){let t=(0,s.sdkStreamMixin)(e.body),i=await t.transformToString();if(200===e.statusCode){let e=JSON.parse(i);if("string"!=typeof e.AccessKeyId||"string"!=typeof e.SecretAccessKey||"string"!=typeof e.Token||"string"!=typeof e.Expiration)throw new o.CredentialsProviderError("HTTP credential provider response not of the required format, an object matching: { AccessKeyId: string, SecretAccessKey: string, Token: string, Expiration: string(rfc3339) }",{logger:r});return{accessKeyId:e.AccessKeyId,secretAccessKey:e.SecretAccessKey,sessionToken:e.Token,expiration:(0,a.parseRfc3339DateTime)(e.Expiration)}}if(e.statusCode>=400&&e.statusCode<500){let t={};try{t=JSON.parse(i)}catch(e){}throw Object.assign(new o.CredentialsProviderError(`Server responded with status: ${e.statusCode}`,{logger:r}),{Code:t.Code,Message:t.Message})}throw new o.CredentialsProviderError(`Server responded with status: ${e.statusCode}`,{logger:r})}e.s(["fromHttp",0,(e={})=>{let a,s,c,d;e.logger?.debug("@aws-sdk/credential-provider-http - fromHttp");let g=e.awsContainerCredentialsRelativeUri??process.env.AWS_CONTAINER_CREDENTIALS_RELATIVE_URI,u=e.awsContainerCredentialsFullUri??process.env.AWS_CONTAINER_CREDENTIALS_FULL_URI,f=e.awsContainerAuthorizationToken??process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN,p=e.awsContainerAuthorizationTokenFile??process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN_FILE,h=e.logger?.constructor?.name!=="NoOpLogger"&&e.logger?.warn?e.logger.warn.bind(e.logger):console.warn;if(g&&u&&(h("@aws-sdk/credential-provider-http: you have set both awsContainerCredentialsRelativeUri and awsContainerCredentialsFullUri."),h("awsContainerCredentialsFullUri will take precedence.")),f&&p&&(h("@aws-sdk/credential-provider-http: you have set both awsContainerAuthorizationToken and awsContainerAuthorizationTokenFile."),h("awsContainerAuthorizationToken will take precedence.")),u)a=u;else if(g)a=`http://169.254.170.2${g}`;else throw new o.CredentialsProviderError(`No HTTP credential provider host provided.
Set AWS_CONTAINER_CREDENTIALS_FULL_URI or AWS_CONTAINER_CREDENTIALS_RELATIVE_URI.`,{logger:e.logger});let m=new URL(a);((e,r)=>{if("https:"!==e.protocol&&"169.254.170.2"!==e.hostname&&"169.254.170.23"!==e.hostname&&"[fd00:ec2::23]"!==e.hostname){if(e.hostname.includes("[")){if("[::1]"===e.hostname||"[0000:0000:0000:0000:0000:0000:0000:0001]"===e.hostname)return}else{if("localhost"===e.hostname)return;let r=e.hostname.split("."),t=e=>{let r=parseInt(e,10);return 0<=r&&r<=255};if("127"===r[0]&&t(r[1])&&t(r[2])&&t(r[3])&&4===r.length)return}throw new o.CredentialsProviderError(`URL not accepted. It must either be HTTPS or match one of the following:
  - loopback CIDR 127.0.0.0/8 or [::1/128]
  - ECS container host 169.254.170.2
  - EKS container host 169.254.170.23 or [fd00:ec2::23]`,{logger:r})}})(m,e.logger);let w=t.NodeHttpHandler.create({requestTimeout:e.timeout??1e3,connectionTimeout:e.timeout??1e3});return s=async()=>{let t=new n.HttpRequest({protocol:m.protocol,hostname:m.hostname,port:Number(m.port),path:m.pathname,query:Array.from(m.searchParams.entries()).reduce((e,[r,t])=>(e[r]=t,e),{}),fragment:m.hash});f?t.headers.Authorization=f:p&&(t.headers.Authorization=(await i.default.readFile(p)).toString());try{let e=await w.handle(t);return l(e.response).then(e=>(0,r.setCredentialFeature)(e,"CREDENTIALS_HTTP","z"))}catch(r){throw new o.CredentialsProviderError(String(r),{logger:e.logger})}},c=e.maxRetries??3,d=e.timeout??1e3,async()=>{for(let e=0;e<c;++e)try{return await s()}catch(e){await new Promise(e=>setTimeout(e,d))}return await s()}}],411497)},578526,707685,660568,e=>{"use strict";var r=e.i(747065),t=e.i(318380),o=e.i(784105),i=e.i(209110),n=e.i(741467);let a=e=>Object.entries(e).filter(([e])=>e.startsWith(i.IniSectionType.SSO_SESSION+n.CONFIG_PREFIX_SEPARATOR)).reduce((e,[r,t])=>({...e,[r.substring(r.indexOf(n.CONFIG_PREFIX_SEPARATOR)+1)]:t}),{});var s=e.i(943171),l=e.i(95894);let c=()=>({}),d=async(e={})=>(0,l.readFile)(e.configFilepath??(0,o.getConfigFilepath)()).then(s.parseIni).then(a).catch(c);var g=e.i(99310);let u=e=>e&&("string"==typeof e.sso_start_url||"string"==typeof e.sso_account_id||"string"==typeof e.sso_session||"string"==typeof e.sso_region||"string"==typeof e.sso_role_name);e.s(["isSsoProfile",0,u],707685);var f=e.i(843985),p=e.i(154620);class h extends p.ProviderError{name="TokenProviderError";constructor(e,r=!0){super(e,r),Object.setPrototypeOf(this,h.prototype)}}var m=e.i(21619);let w="To refresh this SSO session run 'aws sso login' with the corresponding profile.",y=async(r,t={},o)=>{let{SSOOIDCClient:i}=await e.A(658563),n=e=>t.clientConfig?.[e]??t.parentClientConfig?.[e]??o?.[e];return new i(Object.assign({},t.clientConfig??{},{region:r??t.clientConfig?.region,logger:n("logger"),userAgentAppId:n("userAgentAppId")}))},E=async(r,t,o={},i)=>{let{CreateTokenCommand:n}=await e.A(658563);return(await y(t,o,i)).send(new n({clientId:r.clientId,clientSecret:r.clientSecret,refreshToken:r.refreshToken,grantType:"refresh_token"}))},_=e=>{if(e.expiration&&e.expiration.getTime()<Date.now())throw new h(`Token is expired. ${w}`,!1)},S=(e,r,t=!1)=>{if(void 0===r)throw new h(`Value not present for '${e}' in SSO Token${t?". Cannot refresh":""}. ${w}`,!1)};var C=e.i(468134);let{writeFile:v}=e.i(522734).promises,b=new Date(0),A=async({ssoStartUrl:o,ssoSession:i,ssoAccountId:n,ssoRegion:a,ssoRoleName:s,ssoClient:l,clientConfig:c,parentClientConfig:u,callerClientConfig:p,profile:y,filepath:A,configFilepath:I,ignoreCache:T,logger:k})=>{let P,O,x="To refresh this SSO session run aws sso login with the corresponding profile.";if(i)try{let e=await ((e={})=>async({callerClientConfig:r}={})=>{let o;e.logger?.debug("@aws-sdk/token-providers - fromSso");let i=await (0,g.parseKnownFiles)(e),n=(0,t.getProfileName)({profile:e.profile??r?.profile}),a=i[n];if(a){if(!a.sso_session)throw new h(`Profile '${n}' is missing required property 'sso_session'.`)}else throw new h(`Profile '${n}' could not be found in shared credentials file.`,!1);let s=a.sso_session,l=(await d(e))[s];if(!l)throw new h(`Sso session '${s}' could not be found in shared credentials file.`,!1);for(let e of["sso_start_url","sso_region"])if(!l[e])throw new h(`Sso session '${s}' is missing required property '${e}'.`,!1);l.sso_start_url;let c=l.sso_region;try{o=await (0,m.getSSOTokenFromFile)(s)}catch(e){throw new h(`The SSO session token associated with profile=${n} was not found or is invalid. ${w}`,!1)}S("accessToken",o.accessToken),S("expiresAt",o.expiresAt);let{accessToken:u,expiresAt:f}=o,p={token:u,expiration:new Date(f)};if(p.expiration.getTime()-Date.now()>3e5)return p;if(Date.now()-b.getTime()<3e4)return _(p),p;S("clientId",o.clientId,!0),S("clientSecret",o.clientSecret,!0),S("refreshToken",o.refreshToken,!0);try{b.setTime(Date.now());let t=await E(o,c,e,r);S("accessToken",t.accessToken),S("expiresIn",t.expiresIn);let i=new Date(Date.now()+1e3*t.expiresIn);try{var y;let e;await (y={...o,accessToken:t.accessToken,expiresAt:i.toISOString(),refreshToken:t.refreshToken},e=(0,C.getSSOTokenFilepath)(s),v(e,JSON.stringify(y,null,2)))}catch(e){}return{token:t.accessToken,expiration:i}}catch(e){return _(p),p}})({profile:y,filepath:A,configFilepath:I,ignoreCache:T})();P={accessToken:e.token,expiresAt:new Date(e.expiration).toISOString()}}catch(e){throw new r.CredentialsProviderError(e.message,{tryNextLink:!1,logger:k})}else try{P=await (0,m.getSSOTokenFromFile)(o)}catch(e){throw new r.CredentialsProviderError(`The SSO session associated with this profile is invalid. ${x}`,{tryNextLink:!1,logger:k})}if(new Date(P.expiresAt).getTime()-Date.now()<=0)throw new r.CredentialsProviderError(`The SSO session associated with this profile has expired. ${x}`,{tryNextLink:!1,logger:k});let{accessToken:R}=P,{SSOClient:N,GetRoleCredentialsCommand:D}=await e.A(174079),F=l||new N(Object.assign({},c??{},{logger:c?.logger??p?.logger??u?.logger,region:c?.region??a,userAgentAppId:c?.userAgentAppId??p?.userAgentAppId??u?.userAgentAppId}));try{O=await F.send(new D({accountId:n,roleName:s,accessToken:R}))}catch(e){throw new r.CredentialsProviderError(e,{tryNextLink:!1,logger:k})}let{roleCredentials:{accessKeyId:L,secretAccessKey:$,sessionToken:j,expiration:K,credentialScope:B,accountId:M}={}}=O;if(!L||!$||!j||!K)throw new r.CredentialsProviderError("SSO returns an invalid temporary credential.",{tryNextLink:!1,logger:k});let U={accessKeyId:L,secretAccessKey:$,sessionToken:j,expiration:new Date(K),...B&&{credentialScope:B},...M&&{accountId:M}};return i?(0,f.setCredentialFeature)(U,"CREDENTIALS_SSO","s"):(0,f.setCredentialFeature)(U,"CREDENTIALS_SSO_LEGACY","u"),U},I=(e,t)=>{let{sso_start_url:o,sso_account_id:i,sso_region:n,sso_role_name:a}=e;if(!o||!i||!n||!a)throw new r.CredentialsProviderError(`Profile is configured with invalid SSO credentials. Required parameters "sso_account_id", "sso_region", "sso_role_name", "sso_start_url". Got ${Object.keys(e).join(", ")}
Reference: https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sso.html`,{tryNextLink:!1,logger:t});return e};e.s(["validateSsoProfile",0,I],660568),e.s(["fromSSO",0,(e={})=>async({callerClientConfig:o}={})=>{e.logger?.debug("@aws-sdk/credential-provider-sso - fromSSO");let{ssoStartUrl:i,ssoAccountId:n,ssoRegion:a,ssoRoleName:s,ssoSession:l}=e,{ssoClient:c}=e,f=(0,t.getProfileName)({profile:e.profile??o?.profile});if(i||n||a||s||l)if(i&&n&&a&&s)return A({ssoStartUrl:i,ssoSession:l,ssoAccountId:n,ssoRegion:a,ssoRoleName:s,ssoClient:c,clientConfig:e.clientConfig,parentClientConfig:e.parentClientConfig,callerClientConfig:e.callerClientConfig,profile:f,filepath:e.filepath,configFilepath:e.configFilepath,ignoreCache:e.ignoreCache,logger:e.logger});else throw new r.CredentialsProviderError('Incomplete configuration. The fromSSO() argument hash must include "ssoStartUrl", "ssoAccountId", "ssoRegion", "ssoRoleName"',{tryNextLink:!1,logger:e.logger});{let t=(await (0,g.parseKnownFiles)(e))[f];if(!t)throw new r.CredentialsProviderError(`Profile ${f} was not found.`,{logger:e.logger});if(!u(t))throw new r.CredentialsProviderError(`Profile ${f} is not configured with SSO credentials.`,{logger:e.logger});if(t?.sso_session){let o=(await d(e))[t.sso_session],n=` configurations in profile ${f} and sso-session ${t.sso_session}`;if(a&&a!==o.sso_region)throw new r.CredentialsProviderError("Conflicting SSO region"+n,{tryNextLink:!1,logger:e.logger});if(i&&i!==o.sso_start_url)throw new r.CredentialsProviderError("Conflicting SSO start_url"+n,{tryNextLink:!1,logger:e.logger});t.sso_region=o.sso_region,t.sso_start_url=o.sso_start_url}let{sso_start_url:o,sso_account_id:n,sso_region:s,sso_role_name:l,sso_session:p}=I(t,e.logger);return A({ssoStartUrl:o,ssoSession:p,ssoAccountId:n,ssoRegion:s,ssoRoleName:l,ssoClient:c,clientConfig:e.clientConfig,parentClientConfig:e.parentClientConfig,callerClientConfig:e.callerClientConfig,profile:f,filepath:e.filepath,configFilepath:e.configFilepath,ignoreCache:e.ignoreCache,logger:e.logger})}}],578526)},297868,420111,985539,528070,993245,202317,e=>{"use strict";var r,t,o,i,n=e.i(747065),a=e.i(792509),s=e.i(154620),l=e.i(500874),c=e.i(921517);function d(e){return new Promise((r,t)=>{let o=(0,c.request)({method:"GET",...e,hostname:e.hostname?.replace(/^\[(.+)\]$/,"$1")});o.on("error",e=>{t(Object.assign(new s.ProviderError("Unable to connect to instance metadata service"),e)),o.destroy()}),o.on("timeout",()=>{t(new s.ProviderError("TimeoutError from instance metadata service")),o.destroy()}),o.on("response",e=>{let{statusCode:i=400}=e;(i<200||300<=i)&&(t(Object.assign(new s.ProviderError("Error response received from instance metadata service"),{statusCode:i})),o.destroy());let n=[];e.on("data",e=>{n.push(e)}),e.on("end",()=>{r(l.Buffer.concat(n)),o.destroy()})}),o.end()})}e.s(["httpRequest",()=>d],420111);let g=e=>!!e&&"object"==typeof e&&"string"==typeof e.AccessKeyId&&"string"==typeof e.SecretAccessKey&&"string"==typeof e.Token&&"string"==typeof e.Expiration,u=e=>({accessKeyId:e.AccessKeyId,secretAccessKey:e.SecretAccessKey,sessionToken:e.Token,expiration:new Date(e.Expiration),...e.AccountId&&{accountId:e.AccountId}}),f=1e3,p=0,h=({maxRetries:e=p,timeout:r=f})=>({maxRetries:e,timeout:r});e.s(["DEFAULT_MAX_RETRIES",0,p,"DEFAULT_TIMEOUT",0,f,"providerConfigFromInit",0,h],985539);let m=(e,r)=>{let t=e();for(let o=0;o<r;o++)t=t.catch(e);return t},w="AWS_CONTAINER_CREDENTIALS_FULL_URI",y="AWS_CONTAINER_CREDENTIALS_RELATIVE_URI",E="AWS_CONTAINER_AUTHORIZATION_TOKEN",_=async(e,r)=>(process.env[E]&&(r.headers={...r.headers,Authorization:process.env[E]}),(await d({...r,timeout:e})).toString()),S={localhost:!0,"127.0.0.1":!0},C={"http:":!0,"https:":!0},v=async({logger:e})=>{if(process.env[y])return{hostname:"169.254.170.2",path:process.env[y]};if(process.env[w]){let r=(0,a.parse)(process.env[w]);if(!r.hostname||!(r.hostname in S))throw new n.CredentialsProviderError(`${r.hostname} is not a valid container metadata service hostname`,{tryNextLink:!1,logger:e});if(!r.protocol||!(r.protocol in C))throw new n.CredentialsProviderError(`${r.protocol} is not a valid container metadata service protocol`,{tryNextLink:!1,logger:e});return{...r,port:r.port?parseInt(r.port,10):void 0}}throw new n.CredentialsProviderError(`The container metadata credential provider cannot be used unless the ${y} or ${w} environment variable is set`,{tryNextLink:!1,logger:e})};e.s(["ENV_CMDS_AUTH_TOKEN",0,E,"ENV_CMDS_FULL_URI",0,w,"ENV_CMDS_RELATIVE_URI",0,y,"fromContainerMetadata",0,(e={})=>{let{timeout:r,maxRetries:t}=h(e);return()=>m(async()=>{let t=await v({logger:e.logger}),o=JSON.parse(await _(r,t));if(!g(o))throw new n.CredentialsProviderError("Invalid response received from instance metadata service.",{logger:e.logger});return u(o)},t)}],297868);var b=e.i(187228),A=n;class I extends A.CredentialsProviderError{tryNextLink;name="InstanceMetadataV1FallbackError";constructor(e,r=!0){super(e,r),this.tryNextLink=r,Object.setPrototypeOf(this,I.prototype)}}var T=e.i(879614);(r=o||(o={})).IPv4="http://169.254.169.254",r.IPv6="http://[fd00:ec2::254]",e.s(["Endpoint",()=>o],528070);let k={environmentVariableSelector:e=>e.AWS_EC2_METADATA_SERVICE_ENDPOINT,configFileSelector:e=>e.ec2_metadata_service_endpoint,default:void 0};(t=i||(i={})).IPv4="IPv4",t.IPv6="IPv6";let P={environmentVariableSelector:e=>e.AWS_EC2_METADATA_SERVICE_ENDPOINT_MODE,configFileSelector:e=>e.ec2_metadata_service_endpoint_mode,default:i.IPv4},O=async()=>(0,T.parseUrl)(await x()||await R()),x=async()=>(0,b.loadConfig)(k)(),R=async()=>{let e=await (0,b.loadConfig)(P)();switch(e){case i.IPv4:return o.IPv4;case i.IPv6:return o.IPv6;default:throw Error(`Unsupported endpoint mode: ${e}. Select from ${Object.values(i)}`)}};e.s(["getInstanceMetadataEndpoint",0,O],993245);let N=(e,r)=>{let t=300+Math.floor(300*Math.random()),o=new Date(Date.now()+1e3*t);r.warn(`Attempting credential expiration extension due to a credential service availability issue. A refresh of these credentials will be attempted after ${new Date(o)}.
For more information, please visit: https://docs.aws.amazon.com/sdkref/latest/guide/feature-static-credentials.html`);let i=e.originalExpiration??e.expiration;return{...e,...i?{originalExpiration:i}:{},expiration:o}},D="/latest/meta-data/iam/security-credentials/",F="AWS_EC2_METADATA_V1_DISABLED",L="ec2_metadata_v1_disabled",$="x-aws-ec2-metadata-token",j=async e=>d({...e,path:"/latest/api/token",method:"PUT",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"21600"}}),K=async e=>(await d({...e,path:D})).toString(),B=async(e,r,t)=>{let o=JSON.parse((await d({...r,path:D+e})).toString());if(!g(o))throw new n.CredentialsProviderError("Invalid response received from instance metadata service.",{logger:t.logger});return u(o)};e.s(["fromInstanceMetadata",0,(e={})=>((e,r={})=>{let t,o=r?.logger||console;return async()=>{let r;try{(r=await e()).expiration&&r.expiration.getTime()<Date.now()&&(r=N(r,o))}catch(e){if(t)o.warn("Credential renew failed: ",e),r=N(t,o);else throw e}return t=r,r}})(((e={})=>{let r=!1,{logger:t,profile:o}=e,{timeout:i,maxRetries:a}=h(e),s=async(t,i)=>{if(r||i.headers?.[$]==null){let r=!1,t=!1,i=await (0,b.loadConfig)({environmentVariableSelector:r=>{let o=r[F];if(t=!!o&&"false"!==o,void 0===o)throw new n.CredentialsProviderError(`${F} not set in env, checking config file next.`,{logger:e.logger});return t},configFileSelector:e=>{let t=e[L];return r=!!t&&"false"!==t},default:!1},{profile:o})();if(e.ec2MetadataV1Disabled||i){let o=[];throw e.ec2MetadataV1Disabled&&o.push("credential provider initialization (runtime option ec2MetadataV1Disabled)"),r&&o.push(`config file profile (${L})`),t&&o.push(`process environment variable (${F})`),new I(`AWS EC2 Metadata v1 fallback has been blocked by AWS SDK configuration in the following: [${o.join(", ")}].`)}}let a=(await m(async()=>{let e;try{e=await K(i)}catch(e){throw 401===e.statusCode&&(r=!1),e}return e},t)).trim();return m(async()=>{let t;try{t=await B(a,i,e)}catch(e){throw 401===e.statusCode&&(r=!1),e}return t},t)};return async()=>{let e=await O();if(r)return t?.debug("AWS SDK Instance Metadata","using v1 fallback (no token fetch)"),s(a,{...e,timeout:i});{let o;try{o=(await j({...e,timeout:i})).toString()}catch(o){if(o?.statusCode===400)throw Object.assign(o,{message:"EC2 Metadata token request returned error"});return("TimeoutError"===o.message||[403,404,405].includes(o.statusCode))&&(r=!0),t?.debug("AWS SDK Instance Metadata","using v1 fallback (initial)"),s(a,{...e,timeout:i})}return s(a,{...e,headers:{[$]:o},timeout:i})}}})(e),{logger:e.logger})],202317)},902157,(e,r,t)=>{r.exports=e.x("node:fs",()=>require("node:fs"))},747065,154620,e=>{"use strict";class r extends Error{name="ProviderError";tryNextLink;constructor(e,t=!0){let o,i=!0;"boolean"==typeof t?(o=void 0,i=t):null!=t&&"object"==typeof t&&(o=t.logger,i=t.tryNextLink??!0),super(e),this.tryNextLink=i,Object.setPrototypeOf(this,r.prototype),o?.debug?.(`@smithy/property-provider ${i?"->":"(!)"} ${e}`)}static from(e,r=!0){return Object.assign(new this(e.message,r),e)}}e.s(["ProviderError",()=>r],154620);class t extends r{name="CredentialsProviderError";constructor(e,r=!0){super(e,r),Object.setPrototypeOf(this,t.prototype)}}e.s(["CredentialsProviderError",()=>t],747065)},843985,e=>{"use strict";function r(e,r,t){return e.$source||(e.$source={}),e.$source[r]=t,e}e.s(["setCredentialFeature",()=>r])},834965,95894,e=>{"use strict";var r=e.i(446786),t=e.i(814747);let o={};e.s(["getHomeDir",0,()=>{let{HOME:e,USERPROFILE:i,HOMEPATH:n,HOMEDRIVE:a=`C:${t.sep}`}=process.env;if(e)return e;if(i)return i;if(n)return`${a}${n}`;let s=process&&process.geteuid?`${process.geteuid()}`:"DEFAULT";return o[s]||(o[s]=(0,r.homedir)()),o[s]}],834965);var i=e.i(912714);let n={},a={};e.s(["fileIntercept",0,a,"readFile",0,(e,r)=>void 0!==a[e]?a[e]:((!n[e]||r?.ignoreCache)&&(n[e]=(0,i.readFile)(e,"utf8")),n[e])],95894)},318380,e=>{"use strict";let r="AWS_PROFILE";e.s(["ENV_PROFILE",0,r,"getProfileName",0,e=>e.profile||process.env[r]||"default"])},209110,741467,e=>{"use strict";var r,t;(t=r||(r={})).PROFILE="profile",t.SSO_SESSION="sso-session",t.SERVICES="services",e.s(["IniSectionType",()=>r],209110),e.s(["CONFIG_PREFIX_SEPARATOR",0,"."],741467)},999392,e=>{"use strict";var r=e.i(209110),t=e.i(741467);e.s(["getConfigData",0,e=>Object.entries(e).filter(([e])=>{let o=e.indexOf(t.CONFIG_PREFIX_SEPARATOR);return -1!==o&&Object.values(r.IniSectionType).includes(e.substring(0,o))}).reduce((e,[o,i])=>{let n=o.indexOf(t.CONFIG_PREFIX_SEPARATOR);return e[o.substring(0,n)===r.IniSectionType.PROFILE?o.substring(n+1):o]=i,e},{...e.default&&{default:e.default}})])},784105,e=>{"use strict";var r=e.i(814747),t=e.i(834965);e.s(["getConfigFilepath",0,()=>process.env.AWS_CONFIG_FILE||(0,r.join)((0,t.getHomeDir)(),".aws","config")])},63121,e=>{"use strict";var r=e.i(814747),t=e.i(834965);e.s(["getCredentialsFilepath",0,()=>process.env.AWS_SHARED_CREDENTIALS_FILE||(0,r.join)((0,t.getHomeDir)(),".aws","credentials")])},943171,e=>{"use strict";var r=e.i(209110),t=e.i(741467);let o=/^([\w-]+)\s(["'])?([\w-@\+\.%:/]+)\2$/,i=["__proto__","profile __proto__"];e.s(["parseIni",0,e=>{let n,a,s={};for(let l of e.split(/\r?\n/)){let e=l.split(/(^|\s)[;#]/)[0].trim();if("["===e[0]&&"]"===e[e.length-1]){n=void 0,a=void 0;let s=e.substring(1,e.length-1),l=o.exec(s);if(l){let[,e,,o]=l;Object.values(r.IniSectionType).includes(e)&&(n=[e,o].join(t.CONFIG_PREFIX_SEPARATOR))}else n=s;if(i.includes(s))throw Error(`Found invalid profile name "${s}"`)}else if(n){let r=e.indexOf("=");if(![0,-1].includes(r)){let[o,i]=[e.substring(0,r).trim(),e.substring(r+1).trim()];if(""===i)a=o;else{a&&l.trimStart()===l&&(a=void 0),s[n]=s[n]||{};let e=a?[a,o].join(t.CONFIG_PREFIX_SEPARATOR):o;s[n][e]=i}}}}return s}])},828479,e=>{"use strict";var r=e.i(814747),t=e.i(999392),o=e.i(784105),i=e.i(63121),n=e.i(834965),a=e.i(943171),s=e.i(95894);let l=()=>({}),c=async(e={})=>{let{filepath:c=(0,i.getCredentialsFilepath)(),configFilepath:d=(0,o.getConfigFilepath)()}=e,g=(0,n.getHomeDir)(),u=c;c.startsWith("~/")&&(u=(0,r.join)(g,c.slice(2)));let f=d;d.startsWith("~/")&&(f=(0,r.join)(g,d.slice(2)));let p=await Promise.all([(0,s.readFile)(f,{ignoreCache:e.ignoreCache}).then(a.parseIni).then(t.getConfigData).catch(l),(0,s.readFile)(u,{ignoreCache:e.ignoreCache}).then(a.parseIni).catch(l)]);return{configFile:p[0],credentialsFile:p[1]}};e.s(["loadSharedConfigFiles",0,c])},426149,e=>{"use strict";var r=e.i(154620);e.s(["chain",0,(...e)=>async()=>{let t;if(0===e.length)throw new r.ProviderError("No providers in chain");for(let r of e)try{return await r()}catch(e){if(t=e,e?.tryNextLink)continue;throw e}throw t}])},105671,213285,e=>{"use strict";let r=e=>"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e);e.s(["isArrayBuffer",0,r],213285);var t=e.i(500874);e.s(["fromArrayBuffer",0,(e,o=0,i=e.byteLength-o)=>{if(!r(e))throw TypeError(`The "input" argument must be ArrayBuffer. Received type ${typeof e} (${e})`);return t.Buffer.from(e,o,i)},"fromString",0,(e,r)=>{if("string"!=typeof e)throw TypeError(`The "input" argument must be of type string. Received type ${typeof e} (${e})`);return r?t.Buffer.from(e,r):t.Buffer.from(e)}],105671)},524836,(e,r,t)=>{r.exports=e.x("https",()=>require("https"))},961948,e=>{"use strict";class r{method;protocol;hostname;port;path;query;headers;username;password;fragment;body;constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?":"!==e.protocol.slice(-1)?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?"/"!==e.path.charAt(0)?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){var t;let o=new r({...e,headers:{...e.headers}});return o.query&&(o.query=Object.keys(t=o.query).reduce((e,r)=>{let o=t[r];return{...e,[r]:Array.isArray(o)?[...o]:o}},{})),o}static isInstance(e){return!!e&&"method"in e&&"protocol"in e&&"hostname"in e&&"path"in e&&"object"==typeof e.query&&"object"==typeof e.headers}clone(){return r.clone(this)}}e.s(["HttpRequest",()=>r])},912714,(e,r,t)=>{r.exports=e.x("node:fs/promises",()=>require("node:fs/promises"))},500874,(e,r,t)=>{r.exports=e.x("buffer",()=>require("buffer"))},187228,602508,e=>{"use strict";var r=e.i(426149);let t=(e,r,t)=>{let o,i,n,a=!1,s=async()=>{i||(i=e());try{o=await i,n=!0,a=!1}finally{i=void 0}return o};return void 0===r?async e=>((!n||e?.forceRefresh)&&(o=await s()),o):async e=>((!n||e?.forceRefresh)&&(o=await s()),a||(t&&!t(o)?a=!0:r(o)&&await s()),o)};e.s(["memoize",0,t],602508);var o=e.i(747065);function i(e){try{let r=new Set(Array.from(e.match(/([A-Z_]){3,}/g)??[]));return r.delete("CONFIG"),r.delete("CONFIG_PREFIX_SEPARATOR"),r.delete("ENV"),[...r].join(", ")}catch(r){return e}}var n=e.i(318380),a=e.i(828479);e.s(["loadConfig",0,({environmentVariableSelector:e,configFileSelector:s,default:l},c={})=>{let d,{signingName:g,logger:u}=c;return t((0,r.chain)((d={signingName:g,logger:u},async()=>{try{let r=e(process.env,d);if(void 0===r)throw Error();return r}catch(r){throw new o.CredentialsProviderError(r.message||`Not found in ENV: ${i(e.toString())}`,{logger:d?.logger})}}),((e,{preferredFile:r="config",...t}={})=>async()=>{let s=(0,n.getProfileName)(t),{configFile:l,credentialsFile:c}=await (0,a.loadSharedConfigFiles)(t),d=c[s]||{},g=l[s]||{},u="config"===r?{...d,...g}:{...g,...d};try{let t="config"===r?l:c,o=e(u,t);if(void 0===o)throw Error();return o}catch(r){throw new o.CredentialsProviderError(r.message||`Not found in config files w/ profile [${s}]: ${i(e.toString())}`,{logger:t.logger})}})(s,c),(e=>"function"==typeof e?async()=>await e():()=>Promise.resolve(e))(l)))}],187228)},879614,e=>{"use strict";let r=e=>{let t;if("string"==typeof e)return r(new URL(e));let{hostname:o,pathname:i,port:n,protocol:a,search:s}=e;return s&&(t=function(e){let r={};if(e=e.replace(/^\?/,""))for(let t of e.split("&")){let[e,o=null]=t.split("=");e=decodeURIComponent(e),o&&(o=decodeURIComponent(o)),e in r?Array.isArray(r[e])?r[e].push(o):r[e]=[r[e],o]:r[e]=o}return r}(s)),{hostname:o,port:n?parseInt(n):void 0,protocol:a,path:i,query:t}};e.s(["parseUrl",0,r],879614)},473441,e=>{"use strict";var r=e.i(672945),t=e.i(105671),o=e.i(688947),i=e.i(968556);let n=async e=>"function"==typeof Blob&&e instanceof Blob||e.constructor?.name==="Blob"?void 0!==Blob.prototype.arrayBuffer?new Uint8Array(await e.arrayBuffer()):a(e):s(e);async function a(e){var r;let t=await (r=e,new Promise((e,t)=>{let o=new FileReader;o.onloadend=()=>{if(2!==o.readyState)return t(Error("Reader aborted too early"));let r=o.result??"",i=r.indexOf(","),n=i>-1?i+1:r.length;e(r.substring(n))},o.onabort=()=>t(Error("Read aborted")),o.onerror=()=>t(o.error),o.readAsDataURL(r)}));return new Uint8Array((0,i.fromBase64)(t))}async function s(e){let r=[],t=e.getReader(),o=!1,i=0;for(;!o;){let{done:e,value:n}=await t.read();n&&(r.push(n),i+=n.length),o=e}let n=new Uint8Array(i),a=0;for(let e of r)n.set(e,a),a+=e.length;return n}var l=e.i(794123),c=e.i(153545),d=e.i(348779);let g=e=>"function"==typeof ReadableStream&&(e?.constructor?.name===ReadableStream.name||e instanceof ReadableStream),u="The stream has already been transformed.",f=e=>"function"==typeof Blob&&e instanceof Blob,p="The stream has already been transformed.";e.s(["sdkStreamMixin",0,e=>{if(!(e instanceof o.Readable))try{if(!f(e)&&!g(e)){let r=e?.__proto__?.constructor?.name||e;throw Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${r}`)}let r=!1,t=async()=>{if(r)throw Error(u);return r=!0,await n(e)};return Object.assign(e,{transformToByteArray:t,transformToString:async e=>{let r=await t();if("base64"===e)return(0,l.toBase64)(r);if("hex"===e)return(0,c.toHex)(r);if(void 0===e||"utf8"===e||"utf-8"===e)return(0,d.toUtf8)(r);if("function"==typeof TextDecoder)return new TextDecoder(e).decode(r);throw Error("TextDecoder is not available, please make sure polyfill is provided.")},transformToWebStream:()=>{if(r)throw Error(u);if(r=!0,f(e)){if("function"!=typeof e.stream)throw Error("Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.\nIf you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body");return e.stream()}if(g(e))return e;throw Error(`Cannot transform payload to web stream, got ${e}`)}})}catch(t){let r=e?.__proto__?.constructor?.name||e;throw Error(`Unexpected stream implementation, expect Stream.Readable instance, got ${r}`)}let i=!1,a=async()=>{if(i)throw Error(p);return i=!0,await (0,r.streamCollector)(e)};return Object.assign(e,{transformToByteArray:a,transformToString:async e=>{let r=await a();return void 0===e||Buffer.isEncoding(e)?(0,t.fromArrayBuffer)(r.buffer,r.byteOffset,r.byteLength).toString(e):new TextDecoder(e).decode(r)},transformToWebStream:()=>{if(i)throw Error(p);if(null!==e.readableFlowing)throw Error("The stream has been consumed by other callbacks.");if("function"!=typeof o.Readable.toWeb)throw Error("Readable.toWeb() is not supported. Please ensure a polyfill is available.");return i=!0,o.Readable.toWeb(e)}})}],473441)},578878,316002,e=>{"use strict";var r=e.i(843985),t=e.i(747065),o=e.i(237462),i=e.i(522734);let n=r=>async t=>{r.logger?.debug("@aws-sdk/credential-provider-web-identity - fromWebToken");let{roleArn:o,roleSessionName:i,webIdentityToken:n,providerId:a,policyArns:s,policy:l,durationSeconds:c}=r,{roleAssumerWithWebIdentity:d}=r;if(!d){let{getDefaultRoleAssumerWithWebIdentity:o}=await e.A(210675);d=o({...r.clientConfig,credentialProviderLogger:r.logger,parentClientConfig:{...t?.callerClientConfig,...r.parentClientConfig}},r.clientPlugins)}return d({RoleArn:o,RoleSessionName:i??`aws-sdk-js-session-${Date.now()}`,WebIdentityToken:n,ProviderId:a,PolicyArns:s,Policy:l,DurationSeconds:c})};e.s(["fromWebToken",0,n],316002);let a="AWS_WEB_IDENTITY_TOKEN_FILE";e.s(["fromTokenFile",0,(e={})=>async s=>{e.logger?.debug("@aws-sdk/credential-provider-web-identity - fromTokenFile");let l=e?.webIdentityTokenFile??process.env[a],c=e?.roleArn??process.env.AWS_ROLE_ARN,d=e?.roleSessionName??process.env.AWS_ROLE_SESSION_NAME;if(!l||!c)throw new t.CredentialsProviderError("Web identity configuration not specified",{logger:e.logger});let g=await n({...e,webIdentityToken:o.externalDataInterceptor?.getTokenRecord?.()[l]??(0,i.readFileSync)(l,{encoding:"ascii"}),roleArn:c,roleSessionName:d})(s);return l===process.env[a]&&(0,r.setCredentialFeature)(g,"CREDENTIALS_ENV_VARS_STS_WEB_ID_TOKEN","h"),g}],578878)},237462,e=>{"use strict";var r=e.i(21619),t=e.i(95894);e.s(["externalDataInterceptor",0,{getFileRecord:()=>t.fileIntercept,interceptFile(e,r){t.fileIntercept[e]=Promise.resolve(r)},getTokenRecord:()=>r.tokenIntercept,interceptToken(e,t){r.tokenIntercept[e]=t}}])},99310,e=>{"use strict";var r=e.i(828479);let t=async e=>{let t=await (0,r.loadSharedConfigFiles)(e);return((...e)=>{let r={};for(let t of e)for(let[e,o]of Object.entries(t))void 0!==r[e]?Object.assign(r[e],o):r[e]=o;return r})(t.configFile,t.credentialsFile)};e.s(["parseKnownFiles",0,t],99310)},924868,(e,r,t)=>{r.exports=e.x("fs/promises",()=>require("fs/promises"))},21619,468134,e=>{"use strict";var r=e.i(924868),t=e.i(254799),o=e.i(814747),i=e.i(834965);let n=e=>{let r=(0,t.createHash)("sha1").update(e).digest("hex");return(0,o.join)((0,i.getHomeDir)(),".aws","sso","cache",`${r}.json`)};e.s(["getSSOTokenFilepath",0,n],468134);let a={},s=async e=>{if(a[e])return a[e];let t=n(e);return JSON.parse(await (0,r.readFile)(t,"utf8"))};e.s(["getSSOTokenFromFile",0,s,"tokenIntercept",0,a],21619)},233405,(e,r,t)=>{r.exports=e.x("child_process",()=>require("child_process"))},410508,e=>{"use strict";var r=e.i(318380),t=e.i(99310),o=e.i(747065),i=e.i(237462),n=e.i(233405),a=e.i(224361),s=e.i(843985);let l=async(e,r,t)=>{let l=r[e];if(r[e]){let d=l.credential_process;if(void 0!==d){let l=(0,a.promisify)(i.externalDataInterceptor?.getTokenRecord?.().exec??n.exec);try{let t,{stdout:o}=await l(d);try{t=JSON.parse(o.trim())}catch{throw Error(`Profile ${e} credential_process returned invalid JSON.`)}var c=t;if(1!==c.Version)throw Error(`Profile ${e} credential_process did not return Version 1.`);if(void 0===c.AccessKeyId||void 0===c.SecretAccessKey)throw Error(`Profile ${e} credential_process returned invalid credentials.`);if(c.Expiration){let r=new Date;if(new Date(c.Expiration)<r)throw Error(`Profile ${e} credential_process returned expired credentials.`)}let i=c.AccountId;!i&&r?.[e]?.aws_account_id&&(i=r[e].aws_account_id);let n={accessKeyId:c.AccessKeyId,secretAccessKey:c.SecretAccessKey,...c.SessionToken&&{sessionToken:c.SessionToken},...c.Expiration&&{expiration:new Date(c.Expiration)},...c.CredentialScope&&{credentialScope:c.CredentialScope},...i&&{accountId:i}};return(0,s.setCredentialFeature)(n,"CREDENTIALS_PROCESS","w"),n}catch(e){throw new o.CredentialsProviderError(e.message,{logger:t})}}throw new o.CredentialsProviderError(`Profile ${e} did not contain credential_process.`,{logger:t})}throw new o.CredentialsProviderError(`Profile ${e} could not be found in shared credentials file.`,{logger:t})};e.s(["fromProcess",0,(e={})=>async({callerClientConfig:o}={})=>{e.logger?.debug("@aws-sdk/credential-provider-process - fromProcess");let i=await (0,t.parseKnownFiles)(e);return l((0,r.getProfileName)({profile:e.profile??o?.profile}),i,e.logger)}],410508)},660526,(e,r,t)=>{r.exports=e.x("node:os",()=>require("node:os"))},228973,92442,e=>{"use strict";var r=e.i(318380),t=e.i(99310),o=e.i(747065),i=e.i(843985),n=e.i(426149);let a=e=>(0,i.setCredentialFeature)(e,"CREDENTIALS_PROFILE_NAMED_PROVIDER","p"),s=async(t,s,c,d,g={},u)=>{c.logger?.debug("@aws-sdk/credential-provider-ini - resolveAssumeRoleCredentials (STS)");let f=s[t],{source_profile:p,region:h}=f;if(!c.roleAssumer){let{getDefaultRoleAssumer:r}=await e.A(210675);c.roleAssumer=r({...c.clientConfig,credentialProviderLogger:c.logger,parentClientConfig:{...d,...c?.parentClientConfig,region:h??c?.parentClientConfig?.region??d?.region}},c.clientPlugins)}if(p&&p in g)throw new o.CredentialsProviderError(`Detected a cycle attempting to resolve credentials for profile ${(0,r.getProfileName)(c)}. Profiles visited: `+Object.keys(g).join(", "),{logger:c.logger});c.logger?.debug(`@aws-sdk/credential-provider-ini - finding credential resolver using ${p?`source_profile=[${p}]`:`profile=[${t}]`}`);let m=p?u(p,s,c,d,{...g,[p]:!0},l(s[p]??{})):(await ((r,t,i)=>{let s={EcsContainer:async r=>{let{fromHttp:t}=await e.A(260063),{fromContainerMetadata:o}=await e.A(616800);return i?.debug("@aws-sdk/credential-provider-ini - credential_source is EcsContainer"),async()=>(0,n.chain)(t(r??{}),o(r))().then(a)},Ec2InstanceMetadata:async r=>{i?.debug("@aws-sdk/credential-provider-ini - credential_source is Ec2InstanceMetadata");let{fromInstanceMetadata:t}=await e.A(616800);return async()=>t(r)().then(a)},Environment:async r=>{i?.debug("@aws-sdk/credential-provider-ini - credential_source is Environment");let{fromEnv:t}=await e.A(307311);return async()=>t(r)().then(a)}};if(r in s)return s[r];throw new o.CredentialsProviderError(`Unsupported credential source in profile ${t}. Got ${r}, expected EcsContainer or Ec2InstanceMetadata or Environment.`,{logger:i})})(f.credential_source,t,c.logger)(c))();if(l(f))return m.then(e=>(0,i.setCredentialFeature)(e,"CREDENTIALS_PROFILE_SOURCE_PROFILE","o"));{let e={RoleArn:f.role_arn,RoleSessionName:f.role_session_name||`aws-sdk-js-${Date.now()}`,ExternalId:f.external_id,DurationSeconds:parseInt(f.duration_seconds||"3600",10)},{mfa_serial:r}=f;if(r){if(!c.mfaCodeProvider)throw new o.CredentialsProviderError(`Profile ${t} requires multi-factor authentication, but no MFA code callback was provided.`,{logger:c.logger,tryNextLink:!1});e.SerialNumber=r,e.TokenCode=await c.mfaCodeProvider(r)}let n=await m;return c.roleAssumer(n,e).then(e=>(0,i.setCredentialFeature)(e,"CREDENTIALS_PROFILE_SOURCE_PROFILE","o"))}},l=e=>!e.role_arn&&!!e.credential_source;var c=e.i(961948),d=e.i(95894),g=e.i(666680),u=e.i(902157),f=e.i(660526),p=e.i(750227);class h{profileData;init;callerClientConfig;static REFRESH_THRESHOLD=3e5;constructor(e,r,t){this.profileData=e,this.init=r,this.callerClientConfig=t}async loadCredentials(){let e=await this.loadToken();if(!e)throw new o.CredentialsProviderError(`Failed to load a token for session ${this.loginSession}, please re-authenticate using aws login`,{tryNextLink:!1,logger:this.logger});let r=e.accessToken,t=Date.now();return new Date(r.expiresAt).getTime()-t<=h.REFRESH_THRESHOLD?this.refresh(e):{accessKeyId:r.accessKeyId,secretAccessKey:r.secretAccessKey,sessionToken:r.sessionToken,accountId:r.accountId,expiration:new Date(r.expiresAt)}}get logger(){return this.init?.logger}get loginSession(){return this.profileData.login_session}async refresh(r){let t,{SigninClient:i,CreateOAuth2TokenCommand:n}=await e.A(960952),{logger:a,userAgentAppId:s}=this.callerClientConfig??{},l=(t=this.callerClientConfig?.requestHandler,t?.metadata?.handlerProtocol==="h2")?void 0:this.callerClientConfig?.requestHandler,c=new i({credentials:{accessKeyId:"",secretAccessKey:""},region:this.profileData.region??await this.callerClientConfig?.region?.()??process.env.AWS_REGION,requestHandler:l,logger:a,userAgentAppId:s,...this.init?.clientConfig});this.createDPoPInterceptor(c.middlewareStack);let d={tokenInput:{clientId:r.clientId,refreshToken:r.refreshToken,grantType:"refresh_token"}};try{let e=await c.send(new n(d)),{accessKeyId:t,secretAccessKey:i,sessionToken:a}=e.tokenOutput?.accessToken??{},{refreshToken:s,expiresIn:l}=e.tokenOutput??{};if(!t||!i||!a||!s)throw new o.CredentialsProviderError("Token refresh response missing required fields",{logger:this.logger,tryNextLink:!1});let g=new Date(Date.now()+(l??900)*1e3),u={...r,accessToken:{...r.accessToken,accessKeyId:t,secretAccessKey:i,sessionToken:a,expiresAt:g.toISOString()},refreshToken:s};await this.saveToken(u);let f=u.accessToken;return{accessKeyId:f.accessKeyId,secretAccessKey:f.secretAccessKey,sessionToken:f.sessionToken,accountId:f.accountId,expiration:g}}catch(e){if("AccessDeniedException"===e.name){let r;switch(e.error){case"TOKEN_EXPIRED":r="Your session has expired. Please reauthenticate.";break;case"USER_CREDENTIALS_CHANGED":r="Unable to refresh credentials because of a change in your password. Please reauthenticate with your new password.";break;case"INSUFFICIENT_PERMISSIONS":r="Unable to refresh credentials due to insufficient permissions. You may be missing permission for the 'CreateOAuth2Token' action.";break;default:r=`Failed to refresh token: ${String(e)}. Please re-authenticate using \`aws login\``}throw new o.CredentialsProviderError(r,{logger:this.logger,tryNextLink:!1})}throw new o.CredentialsProviderError(`Failed to refresh token: ${String(e)}. Please re-authenticate using aws login`,{logger:this.logger})}}async loadToken(){let e=this.getTokenFilePath();try{let r;try{r=await (0,d.readFile)(e,{ignoreCache:this.init?.ignoreCache})}catch{r=await u.promises.readFile(e,"utf8")}let t=JSON.parse(r),i=["accessToken","clientId","refreshToken","dpopKey"].filter(e=>!t[e]);if(t.accessToken?.accountId||i.push("accountId"),i.length>0)throw new o.CredentialsProviderError(`Token validation failed, missing fields: ${i.join(", ")}`,{logger:this.logger,tryNextLink:!1});return t}catch(r){throw new o.CredentialsProviderError(`Failed to load token from ${e}: ${String(r)}`,{logger:this.logger,tryNextLink:!1})}}async saveToken(e){let r=this.getTokenFilePath(),t=(0,p.dirname)(r);try{await u.promises.mkdir(t,{recursive:!0})}catch(e){}await u.promises.writeFile(r,JSON.stringify(e,null,2),"utf8")}getTokenFilePath(){let e=process.env.AWS_LOGIN_CACHE_DIRECTORY??(0,p.join)((0,f.homedir)(),".aws","login","cache"),r=Buffer.from(this.loginSession,"utf8"),t=(0,g.createHash)("sha256").update(r).digest("hex");return(0,p.join)(e,`${t}.json`)}derToRawSignature(e){let r=2;if(2!==e[2])throw Error("Invalid DER signature");r++;let t=e[r++],o=e.subarray(r,r+t);if(2!==e[r+=t])throw Error("Invalid DER signature");r++;let i=e[r++],n=e.subarray(r,r+i);o=0===o[0]?o.subarray(1):o,n=0===n[0]?n.subarray(1):n;let a=Buffer.concat([Buffer.alloc(32-o.length),o]),s=Buffer.concat([Buffer.alloc(32-n.length),n]);return Buffer.concat([a,s])}createDPoPInterceptor(e){e.add(e=>async r=>{if(c.HttpRequest.isInstance(r.request)){let e=r.request,t=`${e.protocol}//${e.hostname}${e.port?`:${e.port}`:""}${e.path}`,o=await this.generateDpop(e.method,t);e.headers={...e.headers,DPoP:o}}return e(r)},{step:"finalizeRequest",name:"dpopInterceptor",override:!0})}async generateDpop(e="POST",r){let t=await this.loadToken();try{let o=(0,g.createPrivateKey)({key:t.dpopKey,format:"pem",type:"sec1"}),i=(0,g.createPublicKey)(o).export({format:"der",type:"spki"}),n=-1;for(let e=0;e<i.length;e++)if(4===i[e]){n=e;break}let a=i.slice(n+1,n+33),s=i.slice(n+33,n+65),l={alg:"ES256",typ:"dpop+jwt",jwk:{kty:"EC",crv:"P-256",x:a.toString("base64url"),y:s.toString("base64url")}},c={jti:crypto.randomUUID(),htm:e,htu:r,iat:Math.floor(Date.now()/1e3)},d=Buffer.from(JSON.stringify(l)).toString("base64url"),u=Buffer.from(JSON.stringify(c)).toString("base64url"),f=`${d}.${u}`,p=(0,g.sign)("sha256",Buffer.from(f),o),h=this.derToRawSignature(p).toString("base64url");return`${f}.${h}`}catch(e){throw new o.CredentialsProviderError(`Failed to generate Dpop proof: ${e instanceof Error?e.message:String(e)}`,{logger:this.logger,tryNextLink:!1})}}}let m=e=>async({callerClientConfig:n}={})=>{e?.logger?.debug?.("@aws-sdk/credential-providers - fromLoginCredentials");let a=await (0,t.parseKnownFiles)(e||{}),s=(0,r.getProfileName)({profile:e?.profile??n?.profile}),l=a[s];if(!l?.login_session)throw new o.CredentialsProviderError(`Profile ${s} does not contain login_session.`,{tryNextLink:!0,logger:e?.logger});let c=new h(l,e,n),d=await c.loadCredentials();return(0,i.setCredentialFeature)(d,"CREDENTIALS_LOGIN","AD")};e.s(["fromLoginCredentials",0,m],92442);let w=async(e,r,t)=>{let o=await m({...r,profile:e})({callerClientConfig:t});return(0,i.setCredentialFeature)(o,"CREDENTIALS_PROFILE_LOGIN","AC")},y=async(r,t)=>e.A(83092).then(({fromProcess:e})=>e({...r,profile:t})().then(e=>(0,i.setCredentialFeature)(e,"CREDENTIALS_PROFILE_PROCESS","v"))),E=async(r,t,o={},n)=>{let{fromSSO:a}=await e.A(643449);return a({profile:r,logger:o.logger,parentClientConfig:o.parentClientConfig,clientConfig:o.clientConfig})({callerClientConfig:n}).then(e=>t.sso_session?(0,i.setCredentialFeature)(e,"CREDENTIALS_PROFILE_SSO","r"):(0,i.setCredentialFeature)(e,"CREDENTIALS_PROFILE_SSO_LEGACY","t"))},_=e=>!!e&&"object"==typeof e&&"string"==typeof e.aws_access_key_id&&"string"==typeof e.aws_secret_access_key&&["undefined","string"].indexOf(typeof e.aws_session_token)>-1&&["undefined","string"].indexOf(typeof e.aws_account_id)>-1,S=async(e,r)=>{r?.logger?.debug("@aws-sdk/credential-provider-ini - resolveStaticCredentials");let t={accessKeyId:e.aws_access_key_id,secretAccessKey:e.aws_secret_access_key,sessionToken:e.aws_session_token,...e.aws_credential_scope&&{credentialScope:e.aws_credential_scope},...e.aws_account_id&&{accountId:e.aws_account_id}};return(0,i.setCredentialFeature)(t,"CREDENTIALS_PROFILE","n")},C=async(r,t,o)=>e.A(435934).then(({fromTokenFile:e})=>e({webIdentityTokenFile:r.web_identity_token_file,roleArn:r.role_arn,roleSessionName:r.role_session_name,roleAssumerWithWebIdentity:t.roleAssumerWithWebIdentity,logger:t.logger,parentClientConfig:t.parentClientConfig})({callerClientConfig:o}).then(e=>(0,i.setCredentialFeature)(e,"CREDENTIALS_PROFILE_STS_WEB_ID_TOKEN","q"))),v=async(e,r,t,i,n={},a=!1)=>{let l=r[e];if(Object.keys(n).length>0&&_(l))return S(l,t);if(a||((e,{profile:r="default",logger:t}={})=>!!e&&"object"==typeof e&&"string"==typeof e.role_arn&&["undefined","string"].indexOf(typeof e.role_session_name)>-1&&["undefined","string"].indexOf(typeof e.external_id)>-1&&["undefined","string"].indexOf(typeof e.mfa_serial)>-1&&(((e,{profile:r,logger:t})=>{let o="string"==typeof e.source_profile&&void 0===e.credential_source;return o&&t?.debug?.(`    ${r} isAssumeRoleWithSourceProfile source_profile=${e.source_profile}`),o})(e,{profile:r,logger:t})||((e,{profile:r,logger:t})=>{let o="string"==typeof e.credential_source&&void 0===e.source_profile;return o&&t?.debug?.(`    ${r} isCredentialSourceProfile credential_source=${e.credential_source}`),o})(e,{profile:r,logger:t})))(l,{profile:e,logger:t.logger}))return s(e,r,t,i,n,v);if(_(l))return S(l,t);if(l&&"object"==typeof l&&"string"==typeof l.web_identity_token_file&&"string"==typeof l.role_arn&&["undefined","string"].indexOf(typeof l.role_session_name)>-1)return C(l,t,i);if(l&&"object"==typeof l&&"string"==typeof l.credential_process)return y(t,e);if(l&&("string"==typeof l.sso_start_url||"string"==typeof l.sso_account_id||"string"==typeof l.sso_session||"string"==typeof l.sso_region||"string"==typeof l.sso_role_name))return await E(e,l,t,i);if(l&&l.login_session)return w(e,t,i);throw new o.CredentialsProviderError(`Could not resolve credentials using profile: [${e}] in configuration/credentials file(s).`,{logger:t.logger})};e.s(["fromIni",0,(e={})=>async({callerClientConfig:o}={})=>{e.logger?.debug("@aws-sdk/credential-provider-ini - fromIni");let i=await (0,t.parseKnownFiles)(e);return v((0,r.getProfileName)({profile:e.profile??o?.profile}),i,e,o)}],228973)},822221,344121,e=>{"use strict";let r={russell_brunson:{id:"russell_brunson",name:"Russell Brunson",expertise:"Arquitetura de Funil",color:"#6366f1",icon:"üéØ"},dan_kennedy:{id:"dan_kennedy",name:"Dan Kennedy",expertise:"Oferta & Copy",color:"#8b5cf6",icon:"‚úçÔ∏è"},frank_kern:{id:"frank_kern",name:"Frank Kern",expertise:"Psicologia & Comportamento",color:"#ec4899",icon:"üß†"},sam_ovens:{id:"sam_ovens",name:"Sam Ovens",expertise:"Aquisi√ß√£o & Qualifica√ß√£o",color:"#14b8a6",icon:"üé£"},ryan_deiss:{id:"ryan_deiss",name:"Ryan Deiss",expertise:"LTV & Reten√ß√£o",color:"#f97316",icon:"üìà"},perry_belcher:{id:"perry_belcher",name:"Perry Belcher",expertise:"Monetiza√ß√£o Simples",color:"#84cc16",icon:"üí∞"},lia_haberman:{id:"lia_haberman",name:"Lia Haberman",expertise:"Algoritmo & Mudan√ßas",color:"#06b6d4",icon:"üìä"},rachel_karten:{id:"rachel_karten",name:"Rachel Karten",expertise:"Criativo & Hooks",color:"#f43f5e",icon:"ü™ù"},nikita_beer:{id:"nikita_beer",name:"Nikita Beer",expertise:"Viraliza√ß√£o & Trends",color:"#8b5cf6",icon:"üöÄ"},justin_welsh:{id:"justin_welsh",name:"Justin Welsh",expertise:"Funil Social",color:"#10b981",icon:"‚õìÔ∏è"},eugene_schwartz:{id:"eugene_schwartz",name:"Eugene Schwartz",expertise:"Consci√™ncia de Mercado",specialty:"Estrutura de copy para diferentes est√°gios de consci√™ncia",color:"#6366f1",icon:"üéØ"},claude_hopkins:{id:"claude_hopkins",name:"Claude Hopkins",expertise:"M√©todo Cient√≠fico",specialty:"Testes, medi√ß√£o, prova social",color:"#3b82f6",icon:"üî¨"},gary_halbert:{id:"gary_halbert",name:"Gary Halbert",expertise:"Headlines & Psicologia",specialty:"Headlines que prendem, curiosidade, especificidade",color:"#f59e0b",icon:"‚ö°"},joseph_sugarman:{id:"joseph_sugarman",name:"Joseph Sugarman",expertise:"Narrativa & Estrutura",specialty:"Storytelling, transi√ß√µes, long-form copy",color:"#8b5cf6",icon:"üìñ"},dan_kennedy_copy:{id:"dan_kennedy_copy",name:"Dan Kennedy",expertise:"Oferta & Urg√™ncia",specialty:"Ofertas irresist√≠veis, garantia, urg√™ncia real",color:"#10b981",icon:"üí∞"},david_ogilvy:{id:"david_ogilvy",name:"David Ogilvy",expertise:"Brand Premium",specialty:"Pesquisa, diferencia√ß√£o, big idea",color:"#64748b",icon:"üëî"},john_carlton:{id:"john_carlton",name:"John Carlton",expertise:"Voz Aut√™ntica",specialty:"Autenticidade, fluxo natural, conversa√ß√£o",color:"#ec4899",icon:"üé§"},drayton_bird:{id:"drayton_bird",name:"Drayton Bird",expertise:"Simplicidade & Efici√™ncia",specialty:"Benef√≠cio claro, direto, resposta direta",color:"#14b8a6",icon:"‚úÇÔ∏è"},frank_kern_copy:{id:"frank_kern_copy",name:"Frank Kern",expertise:"Fluxo de Vendas",specialty:"Sequ√™ncias, automa√ß√£o, comportamento",color:"#f97316",icon:"üîÑ"},justin_brooke:{id:"justin_brooke",name:"Justin Brooke",expertise:"Estrat√©gia & Escala",color:"#3b82f6",icon:"üìä"},nicholas_kusmich:{id:"nicholas_kusmich",name:"Nicholas Kusmich",expertise:"Meta Ads & Contexto",color:"#2563eb",icon:"üéØ"},jon_loomer:{id:"jon_loomer",name:"Jon Loomer",expertise:"Analytics & T√©cnico",color:"#1d4ed8",icon:"‚öôÔ∏è"},savannah_sanchez:{id:"savannah_sanchez",name:"Savannah Sanchez",expertise:"TikTok & UGC",color:"#0ea5e9",icon:"üì±"},design_director:{id:"design_director",name:"Diretor de Design",expertise:"Dire√ß√£o de Arte & Briefing",color:"#a855f7",icon:"üé®"}};[{id:"intelligence",label:"Intelig√™ncia",description:"Dados e insights que alimentam a estrat√©gia",icon:"Brain",items:[{id:"intelligence-dashboard",label:"Dashboard",href:"/intelligence",icon:"LayoutDashboard"},{id:"discovery",label:"Discovery",href:"/intelligence/discovery",icon:"Search",sub_items:["Keywords","Spy Agent"]},{id:"attribution",label:"Atribui√ß√£o",href:"/intelligence/attribution",icon:"GitBranch"},{id:"ltv",label:"LTV & Reten√ß√£o",href:"/intelligence/ltv",icon:"TrendingUp"},{id:"journey",label:"Jornada do Lead",href:"/intelligence/journey",icon:"Map"}]},{id:"strategy",label:"Estrat√©gia",description:"Planejamento e arquitetura de convers√£o",icon:"Compass",items:[{id:"funnels",label:"Funis",href:"/funnels",icon:"Target"},{id:"offer-lab",label:"Offer Lab",href:"/intelligence/offer-lab",icon:"Beaker"},{id:"funnel-autopsy",label:"Funnel Autopsy",href:"/strategy/autopsy",icon:"Stethoscope"},{id:"copy-chat",label:"Copywriting",href:"/chat?mode=copy",icon:"PencilLine"}]},{id:"execution",label:"Execu√ß√£o",description:"Opera√ß√£o e implementa√ß√£o de ativos",icon:"Zap",items:[{id:"campaigns",label:"Campanhas",href:"/campaigns",icon:"Rocket",aliases:["/campaign"]},{id:"ads-chat",label:"Ads & Tr√°fego",href:"/chat?mode=ads",icon:"Megaphone"},{id:"social",label:"Social",href:"/social",icon:"Share2"},{id:"social-inbox",label:"Social Inbox",href:"/social-inbox",icon:"Inbox"},{id:"automation",label:"Automa√ß√£o",href:"/automation",icon:"Cpu"}]},{id:"management",label:"Gest√£o",description:"Governan√ßa de marca e ativos",icon:"ShieldCheck",items:[{id:"brands",label:"Marcas",href:"/brands",icon:"Building"},{id:"brand-hub",label:"Brand Hub",href:"/brand-hub",icon:"Palette"},{id:"assets",label:"Biblioteca de Ativos",href:"/assets",icon:"FolderKanban"},{id:"vault",label:"Vault",href:"/vault",icon:"Database"}]},{id:"system",label:"Sistema",icon:"Settings",items:[{id:"settings",label:"Configura√ß√µes",href:"/settings",icon:"Settings"},{id:"integrations",label:"Integra√ß√µes",href:"/integrations",icon:"PlugZap"}]}].flatMap(e=>e.items),e.s(["AWARENESS_STAGES",0,{unaware:{label:"Inconsciente",description:"N√£o sabe que tem problema",copyLength:"Muito longa"},problem_aware:{label:"Consciente do Problema",description:"Sabe que tem problema",copyLength:"M√©dia"},solution_aware:{label:"Consciente da Solu√ß√£o",description:"Sabe que existem solu√ß√µes",copyLength:"M√©dia"},product_aware:{label:"Consciente do Produto",description:"Conhece seu produto",copyLength:"Curta"},most_aware:{label:"Mais Consciente",description:"J√° conhece bem",copyLength:"Muito curta"}},"COPY_COUNSELORS",0,r,"COPY_TYPES",0,{headline:{label:"Headlines",icon:"üì∞",description:"Headlines por est√°gio de consci√™ncia"},email_sequence:{label:"Emails",icon:"üìß",description:"Sequ√™ncia de emails de follow-up"},offer_copy:{label:"Oferta",icon:"üí∞",description:"Copy de oferta completa"},vsl_script:{label:"VSL Script",icon:"üé¨",description:"Script de Video Sales Letter"},ad_creative:{label:"An√∫ncios",icon:"üì±",description:"Copy para Meta, Google, etc"},landing_page:{label:"Landing Page",icon:"üõ¨",description:"Copy de p√°gina de vendas"}},"COUNSELORS_REGISTRY",0,r],344121);let t=`
## REGRAS DE OURO - CONSELHO DE ADS
1. **CONGRU\xcaNCIA**: A estrat\xe9gia de tr\xe1fego deve seguir rigorosamente a "Golden Thread" (Funil -> Copy -> Social -> Design).
2. **ESPECIFICIDADE**: Defina p\xfablicos, canais e estruturas de campanha reais (CBO/ABO, segmenta\xe7\xe3o por interesses, lookalike).
3. **M\xc9TRICAS 2026**: Utilize benchmarks atualizados de CPC, CTR e ROAS para 2026.
4. **FORMATO**: Retorne APENAS o JSON v\xe1lido seguindo a estrutura solicitada.
5. **INSIGHTS**: Forne\xe7a justificativas t\xe9cnicas baseadas nos especialistas.
`;function o(e,o){let i=[r.justin_brooke,r.nicholas_kusmich,r.jon_loomer,r.savannah_sanchez];return`Voc\xea \xe9 o Conselho de Ads, um sistema de intelig\xeancia composto por 4 mestres do tr\xe1fego pago e escala:

${i.map((e,r)=>`${r+1}. **${e.name}** ‚Äî ${e.expertise}`).join("\n")}

## THE GOLDEN THREAD: MANIFESTO DA CAMPANHA

### 1. O C\xc9REBRO (FUNIL)
- **Tipo:** ${e.funnel?.type}
- **Objetivo:** ${e.funnel?.mainGoal}
- **P\xfablico:** ${e.funnel?.targetAudience}
- **Resumo:** ${e.funnel?.summary}

### 2. A VOZ (COPY)
- **Big Idea:** ${e.copywriting?.bigIdea}
- **Tone:** ${e.copywriting?.tone}
- **Headlines:** ${e.copywriting?.headlines.join(" | ")}
- **Benef\xedcios:** ${e.copywriting?.keyBenefits.join(", ")}

### 3. A ATEN\xc7\xc3O (SOCIAL)
- **Canais:** ${e.social?.platforms.join(", ")}
- **Hooks:** ${e.social?.hooks.map(e=>`[${e.platform}] ${e.content}`).join(" | ")}

### 4. O VISUAL (DESIGN)
- **Estilo:** ${e.design?.visualStyle}
- **Cores:** ${e.design?.preferredColors.join(", ")}
- **Prompts:** ${e.design?.visualPrompts.join(" | ")}

${o?.ragContext?`## CONHECIMENTO ESTRAT\xc9GICO (ADS PLAYBOOKS)
${o.ragContext}
`:""}
${o?.brandContext?`## CONHECIMENTO DA MARCA
${o.brandContext}
`:""}

## TAREFA: GERAR ESTRAT\xc9GIA DE ADS (ESCALA)

Sua tarefa \xe9 ler todo o manifesto acima e projetar a estrutura de escala desta campanha. 
N\xe3o invente dados que contradigam a copy ou o design. 
Se o Copywriter definiu uma Big Idea, o Ad deve ser o ve\xedculo dessa ideia.

## FORMATO DE SA\xcdDA (JSON)

{
  "audiences": ["Audi\xeancia 1 (ex: Lookalike 1% Compradores)", "Audi\xeancia 2 (Interesses em X)", "Audi\xeancia 3 (Retargeting)"],
  "channels": ["Meta Ads", "Google Search", "TikTok Ads"],
  "suggestedBudget": "R$ X.XXX,XX / m\xeas",
  "performanceBenchmarks": {
    "targetCPC": 1.50,
    "targetCTR": 1.2,
    "targetCPA": 45.00
  },
  "strategyRationale": "Explica\xe7\xe3o t\xe9cnica de como os canais e p\xfablicos se conectam ao funil.",
  "counselorInsights": [
    {
      "counselor": "Justin Brooke",
      "insight": "Conselho sobre escala e distribui\xe7\xe3o de verba."
    },
    {
      "counselor": "Nicholas Kusmich",
      "insight": "Conselho sobre segmenta\xe7\xe3o e contexto no Meta."
    }
  ]
}

${t}`}e.s(["buildAdsGenerationPrompt",()=>o],822221)},653936,e=>{"use strict";var r=e.i(346414);e.i(564153);var t=e.i(918042),o=e.i(474065);function i(){let e=(process.env.NEXT_PUBLIC_GOOGLE_AI_API_KEY??"").trim(),r=(process.env.GOOGLE_AI_API_KEY??"").trim();return e||r}async function n(e){let r=new TextEncoder().encode(e.trim().toLowerCase());return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",r))).map(e=>e.toString(16).padStart(2,"0")).join("")}async function a(e){let r=i();if(!r)throw Error("GOOGLE_AI_API_KEY not configured for embeddings");let a=Date.now(),s=await n(e);try{let e=(0,t.doc)(o.db,"query_cache",s),r=await (0,t.getDoc)(e);if(r.exists()){let e=r.data();if(!(t.Timestamp.now().toMillis()-e.createdAt.toMillis()>2592e6))return console.log(`[Embeddings] Cache HIT for key: ${s.substring(0,8)} (${Date.now()-a}ms)`),e.embedding}}catch(e){console.warn("[Embeddings] Cache read error:",e)}try{console.log("[Embeddings] Calling text-embedding-004 with dimensionality: 768");let i=await fetch("https://generativelanguage.googleapis.com/v1beta/models/text-embedding-004:embedContent",{method:"POST",headers:{"Content-Type":"application/json","x-goog-api-key":r},body:JSON.stringify({model:"models/text-embedding-004",content:{parts:[{text:e}]},outputDimensionality:768})});if(!i.ok){let e=await i.text();throw Error(`Embedding API failed: ${i.status} ${e}`)}let n=await i.json(),l=n?.embedding?.values;if(!Array.isArray(l))throw Error("Embedding API returned no values");let c=(0,t.doc)(o.db,"query_cache",s);return(0,t.setDoc)(c,{query:e.substring(0,500),embedding:l,createdAt:t.Timestamp.now()}).catch(e=>console.error("[Embeddings] Cache write error:",e)),console.log(`[Embeddings] Cache MISS - API called (${Date.now()-a}ms)`),l}catch(e){throw console.error("[Embeddings] Error generating embedding:",e),e}}async function s(e){let a=Date.now(),s=Array(e.length).fill(null),l=[],c=[],d=t.Timestamp.now().toMillis();for(let r=0;r<e.length;r++){let i=e[r],a=await n(i);try{let e=(0,t.doc)(o.db,"query_cache",a),i=await (0,t.getDoc)(e);if(i.exists()){let e=i.data();if(!(d-e.createdAt.toMillis()>2592e6)){s[r]=e.embedding;continue}}}catch(e){}l.push(r),c.push(i)}if(0===c.length)return console.log(`[Embeddings] Batch Cache HIT (100%) - ${e.length} items (${Date.now()-a}ms)`),s;let g=i();if(!g)throw Error("GOOGLE_AI_API_KEY not configured for embeddings");new r.GoogleGenerativeAI(g).getGenerativeModel({model:"text-embedding-004"});try{console.log(`[Embeddings] Batch Cache MISS - Calling API for ${c.length}/${e.length} items`);let r=[];for(let e=0;e<c.length;e+=90){let t=c.slice(e,e+90);console.log(`[Embeddings] Processing API sub-batch ${e/90+1} (${t.length} items)`);let o=await fetch("https://generativelanguage.googleapis.com/v1beta/models/text-embedding-004:batchEmbedContents",{method:"POST",headers:{"Content-Type":"application/json","x-goog-api-key":g},body:JSON.stringify({requests:t.map(e=>({model:"models/text-embedding-004",content:{parts:[{text:e}]},outputDimensionality:768}))})});if(!o.ok){let e=await o.text();throw Error(`Batch Embedding API failed: ${o.status} ${e}`)}let i=await o.json();if(!i.embeddings||!Array.isArray(i.embeddings))throw Error("Batch Embedding API returned invalid format");r.push(...i.embeddings.map(e=>e.values))}for(let e=0;e<l.length;e++){let i=l[e],a=r[e],d=c[e];s[i]=a;let g=await n(d),u=(0,t.doc)(o.db,"query_cache",g);(0,t.setDoc)(u,{query:d.substring(0,500),embedding:a,createdAt:t.Timestamp.now()}).catch(e=>console.error("[Embeddings] Cache write error:",e))}return console.log(`[Embeddings] Batch completed (${Date.now()-a}ms)`),s}catch(e){throw console.error("[Embeddings] Error generating batch embeddings:",e),e}}e.s(["generateEmbedding",()=>a,"generateEmbeddingsBatch",()=>s])},666680,(e,r,t)=>{r.exports=e.x("node:crypto",()=>require("node:crypto"))},750227,(e,r,t)=>{r.exports=e.x("node:path",()=>require("node:path"))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__effb938d._.js.map