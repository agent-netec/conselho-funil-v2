module.exports=[328668,e=>{"use strict";e.i(564153);var t=e.i(918042),a=e.i(474065);async function n(e){return s(e)}async function r(e){return(await (0,t.addDoc)((0,t.collection)(a.db,"brand_assets"),{...e,isApprovedForAI:e.isApprovedForAI??!1})).id}async function o(e){let n=(0,t.query)((0,t.collection)(a.db,"brand_assets"),(0,t.where)("brandId","==",e),(0,t.orderBy)("createdAt","desc"));return(await (0,t.getDocs)(n)).docs.map(e=>({id:e.id,...e.data()}))}async function s(e){let n=(0,t.doc)(a.db,"brand_assets",e),r=await (0,t.getDoc)(n);return r.exists()?{id:r.id,...r.data()}:null}async function i(e,n,r){let o=(0,t.doc)(a.db,"brand_assets",e),s={status:n};"ready"===n&&(s.processedAt=t.Timestamp.now()),r&&(s.processingError=r),await (0,t.updateDoc)(o,s)}async function c(e,n){let r=(0,t.doc)(a.db,"brand_assets",e);await (0,t.updateDoc)(r,n)}e.i(608612),e.i(569157),e.i(382396),e.s(["createAsset",()=>r,"fetchBrandAsset",()=>n,"getAsset",()=>s,"getBrandAssets",()=>o,"updateAssetStatus",()=>i,"updateBrandAsset",()=>c],328668)},382396,e=>{"use strict";var t=e.i(474065);e.i(564153);var a=e.i(918042);async function n(e,n,r,o){try{let s=(0,a.collection)(t.db,"brands",e,"audit_logs");await (0,a.addDoc)(s,{action:n,details:r,userId:o,createdAt:a.Timestamp.now()})}catch(e){console.error("Failed to log audit:",e)}}async function r(e,r,o,s){var i;let c=(0,a.doc)(t.db,"brands",e),d=await (0,a.getDoc)(c);if(!d.exists())throw Error("Marca n√£o encontrada");let l=d.data();if(l.brandKit?.logoLock?.locked)throw Error("Logo Lock ativo: Desbloqueie o BrandKit para alterar os logos oficiais.");"svg"===o.format&&o.svgRaw&&(o.svgRaw=(i=o.svgRaw)?i.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/on\w+="[^"]*"/gi,"").replace(/on\w+='[^']*'/gi,"").replace(/javascript:[^"']*/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"").replace(/<object\b[^<]*(?:(?!<\/object>)<[^<]*)*<\/object>/gi,"").trim():"");let u={...l.brandKit?.logoLock,variants:{...l.brandKit?.logoLock?.variants,[r]:o},updatedAt:a.Timestamp.now()};await (0,a.updateDoc)(c,{"brandKit.logoLock":u,updatedAt:a.Timestamp.now()}),await n(e,`UPDATE_LOGO_${r.toUpperCase()}`,{asset:o},s)}async function o(e,r,o){let s=(0,a.doc)(t.db,"brands",e);await (0,a.updateDoc)(s,{"brandKit.logoLock.locked":r,"brandKit.logoLock.updatedAt":a.Timestamp.now(),updatedAt:a.Timestamp.now()}),await n(e,r?"LOCK_LOGOS":"UNLOCK_LOGOS",{locked:r},o)}e.s(["toggleLogoLock",()=>o,"updateLogoLock",()=>r])},413263,e=>{"use strict";function t(){let e=process.env.PINECONE_API_KEY,t=process.env.PINECONE_INDEX||process.env.PINECONE_INDEX_NAME||"cf-dev-assets",a=process.env.PINECONE_HOST||process.env.PINECONE_HOST_URL;if(!e)throw Error("PINECONE_API_KEY ausente.");return{apiKey:e,indexName:t,host:a}}let a=null,n=null;async function r(){if(a)return a;let{apiKey:n}=t(),{Pinecone:r}=await e.A(465660);return a=new r({apiKey:n})}async function o(){if(n)return n;let{indexName:e,host:a}=t(),o=await r();return o?n=a?o.index(e,a):o.index(e):null}async function s(e,t={}){if(!e?.length)return{upserted:0};let a=await o();if(!a)return{upserted:0};let n=t.namespace?a.namespace(t.namespace):a;return await n.upsert(e),{upserted:e.length}}async function i(e){let{vector:t,topK:a=10,namespace:n,filter:r}=e,s=await o();if(!s)return{matches:[]};let i=n?s.namespace(n):s;return await i.query({vector:t,topK:a,filter:r,includeMetadata:!0})}async function c(){let{indexName:e}=t(),a=await o(),n=await r();if(!a||!n)return null;let s=await a.describeIndexStats();return await n.describeIndex(e),{status:"connected",index:e,totalVectors:s.totalRecordCount??0}}e.s(["checkPineconeHealth",()=>c,"getPineconeClient",()=>r,"getPineconeIndex",()=>o,"queryPinecone",()=>i,"upsertToPinecone",()=>s])},569157,e=>{"use strict";e.i(564153);var t=e.i(918042),a=e.i(474065);e.i(653137),e.i(653936),e.i(413263);var n=e.i(317036);class r{static getCollectionPath(e){return`brands/${e}/secrets`}static async saveToken(e,r){let o=(0,t.doc)(a.db,this.getCollectionPath(e),`token_${r.provider}`),s={...r,accessToken:(0,n.encrypt)(r.accessToken),refreshToken:r.refreshToken?(0,n.encrypt)(r.refreshToken):void 0,updatedAt:t.Timestamp.now()};await (0,t.setDoc)(o,s)}static async getToken(e,r){let o=(0,t.doc)(a.db,this.getCollectionPath(e),`token_${r}`),s=await (0,t.getDoc)(o);if(!s.exists())return null;let i=s.data();return{...i,accessToken:(0,n.decrypt)(i.accessToken),refreshToken:i.refreshToken?(0,n.decrypt)(i.refreshToken):void 0}}static isTokenExpiring(e){let t=Date.now();return e.expiresAt.toMillis()-t<864e5}}e.s(["MonaraTokenVault",()=>r],569157)}];

//# sourceMappingURL=OneDrive_Desktop_CURSOR_CONSELHO%20DE%20FUNIL_app_src_lib_57023dff._.js.map