module.exports=[328668,e=>{"use strict";e.i(564153);var t=e.i(918042),a=e.i(474065);e.i(608612);var r=e.i(949620);async function n(e){return i(e)}async function o(e){return(await (0,t.addDoc)((0,t.collection)(a.db,"brand_assets"),{...e,isApprovedForAI:e.isApprovedForAI??!1})).id}async function s(e){let r=(0,t.query)((0,t.collection)(a.db,"brand_assets"),(0,t.where)("brandId","==",e),(0,t.orderBy)("createdAt","desc"));return(await (0,t.getDocs)(r)).docs.map(e=>({id:e.id,...e.data()}))}async function i(e){let r=(0,t.doc)(a.db,"brand_assets",e),n=await (0,t.getDoc)(r);return n.exists()?{id:n.id,...n.data()}:null}async function c(e,r,n){let o=(0,t.doc)(a.db,"brand_assets",e),s={status:r};"ready"===r&&(s.processedAt=t.Timestamp.now()),n&&(s.processingError=n),await (0,t.updateDoc)(o,s)}async function d(e,r){let n=(0,t.doc)(a.db,"brand_assets",e);await (0,t.updateDoc)(n,r)}e.i(569157),(0,r.getStorage)(a.default),e.i(382396),e.s(["createAsset",()=>o,"fetchBrandAsset",()=>n,"getAsset",()=>i,"getBrandAssets",()=>s,"updateAssetStatus",()=>c,"updateBrandAsset",()=>d],328668)},382396,e=>{"use strict";var t=e.i(474065);e.i(564153);var a=e.i(918042);async function r(e,r,n,o){try{let s=(0,a.collection)(t.db,"brands",e,"audit_logs");await (0,a.addDoc)(s,{action:r,details:n,userId:o,createdAt:a.Timestamp.now()})}catch(e){console.error("Failed to log audit:",e)}}async function n(e,n,o,s){var i;let c=(0,a.doc)(t.db,"brands",e),d=await (0,a.getDoc)(c);if(!d.exists())throw Error("Marca n√£o encontrada");let l=d.data();if(l.brandKit?.logoLock?.locked)throw Error("Logo Lock ativo: Desbloqueie o BrandKit para alterar os logos oficiais.");"svg"===o.format&&o.svgRaw&&(o.svgRaw=(i=o.svgRaw)?i.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/on\w+="[^"]*"/gi,"").replace(/on\w+='[^']*'/gi,"").replace(/javascript:[^"']*/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"").replace(/<object\b[^<]*(?:(?!<\/object>)<[^<]*)*<\/object>/gi,"").trim():"");let u={...l.brandKit?.logoLock,variants:{...l.brandKit?.logoLock?.variants,[n]:o},updatedAt:a.Timestamp.now()};await (0,a.updateDoc)(c,{"brandKit.logoLock":u,updatedAt:a.Timestamp.now()}),await r(e,`UPDATE_LOGO_${n.toUpperCase()}`,{asset:o},s)}async function o(e,n,o){let s=(0,a.doc)(t.db,"brands",e);await (0,a.updateDoc)(s,{"brandKit.logoLock.locked":n,"brandKit.logoLock.updatedAt":a.Timestamp.now(),updatedAt:a.Timestamp.now()}),await r(e,n?"LOCK_LOGOS":"UNLOCK_LOGOS",{locked:n},o)}e.s(["toggleLogoLock",()=>o,"updateLogoLock",()=>n])},413263,e=>{"use strict";function t(){let e=process.env.PINECONE_API_KEY,t=process.env.PINECONE_INDEX||process.env.PINECONE_INDEX_NAME||"cf-dev-assets",a=process.env.PINECONE_HOST||process.env.PINECONE_HOST_URL;if(!e)throw Error("PINECONE_API_KEY ausente.");return{apiKey:e,indexName:t,host:a}}let a=null,r=null;async function n(){if(a)return a;let{apiKey:r}=t(),{Pinecone:n}=await e.A(465660);return a=new n({apiKey:r})}async function o(){if(r)return r;let{indexName:e,host:a}=t(),o=await n();return o?r=a?o.index(e,a):o.index(e):null}async function s(e,t={}){if(!e?.length)return{upserted:0};let a=await o();if(!a)return{upserted:0};let r=t.namespace?a.namespace(t.namespace):a;return await r.upsert(e),{upserted:e.length}}async function i(e){let{vector:t,topK:a=10,namespace:r,filter:n}=e,s=await o();if(!s)return{matches:[]};let i=r?s.namespace(r):s;return await i.query({vector:t,topK:a,filter:n,includeMetadata:!0})}async function c(){let{indexName:e}=t(),a=await o(),r=await n();if(!a||!r)return null;let s=await a.describeIndexStats();return await r.describeIndex(e),{status:"connected",index:e,totalVectors:s.totalRecordCount??0}}e.s(["checkPineconeHealth",()=>c,"getPineconeClient",()=>n,"getPineconeIndex",()=>o,"queryPinecone",()=>i,"upsertToPinecone",()=>s])},569157,e=>{"use strict";e.i(564153);var t=e.i(918042),a=e.i(474065);e.i(653137),e.i(653936),e.i(413263);var r=e.i(317036);class n{static getCollectionPath(e){return`brands/${e}/secrets`}static async saveToken(e,n){let o=(0,t.doc)(a.db,this.getCollectionPath(e),`token_${n.provider}`),s={...n,accessToken:(0,r.encrypt)(n.accessToken),refreshToken:n.refreshToken?(0,r.encrypt)(n.refreshToken):void 0,updatedAt:t.Timestamp.now()};await (0,t.setDoc)(o,s)}static async getToken(e,n){let o=(0,t.doc)(a.db,this.getCollectionPath(e),`token_${n}`),s=await (0,t.getDoc)(o);if(!s.exists())return null;let i=s.data();return{...i,accessToken:(0,r.decrypt)(i.accessToken),refreshToken:i.refreshToken?(0,r.decrypt)(i.refreshToken):void 0}}static isTokenExpiring(e){let t=Date.now();return e.expiresAt.toMillis()-t<864e5}}e.s(["MonaraTokenVault",()=>n],569157)}];

//# sourceMappingURL=OneDrive_Desktop_CURSOR_CONSELHO%20DE%20FUNIL_app_src_lib_57023dff._.js.map