module.exports=[202561,a=>{"use strict";var b=a.i(194327),c=a.i(582583),d=a.i(126236),e=a.i(539514),f=a.i(289036),g=a.i(704241),h=a.i(459966),i=a.i(248842),j=a.i(168565),k=a.i(635870),l=a.i(326149),m=a.i(535847),n=a.i(761925),o=a.i(399385),p=a.i(19761),q=a.i(393045),r=a.i(749172),s=a.i(698565),t=a.i(822399),u=a.i(317953),v=a.i(880925),w=a.i(47916);let x=(0,w.default)("bookmark-plus",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}],["line",{x1:"12",x2:"12",y1:"7",y2:"13",key:"1cppfj"}],["line",{x1:"15",x2:"9",y1:"10",y2:"10",key:"1gty7f"}]]);var y=a.i(343583),z=a.i(339491),A=a.i(789241);a.i(543317);var B=a.i(134034),C=a.i(860342),D=a.i(433027),E=a.i(810045),F=a.i(300180),G=a.i(919550),H=a.i(985461),I=a.i(473827),J=a.i(460228);let K={EXECUTAR:{icon:o.CheckCircle2,color:"text-emerald-400",bg:"bg-emerald-500/10",border:"border-emerald-500/30",label:"Aprovado para ExecuÃ§Ã£o"},AJUSTAR:{icon:F.RefreshCw,color:"text-amber-400",bg:"bg-amber-500/10",border:"border-amber-500/30",label:"Ajustes Solicitados"},MATAR:{icon:p.XCircle,color:"text-red-400",bg:"bg-red-500/10",border:"border-red-500/30",label:"Descartado"}};function L({decision:a,isLast:d}){let[e,h]=(0,c.useState)(!1),j=K[a.type]??K.EXECUTAR,k=j.icon,l=(a.createdAt?.toDate?.()||new Date).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});return(0,b.jsxs)("div",{className:"relative flex gap-4",children:[!d&&(0,b.jsx)("div",{className:"absolute left-5 top-12 bottom-0 w-px bg-zinc-800"}),(0,b.jsx)("div",{className:(0,E.cn)("relative z-10 flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-xl",j.bg,j.border,"border"),children:(0,b.jsx)(k,{className:(0,E.cn)("h-5 w-5",j.color)})}),(0,b.jsx)("div",{className:"flex-1 pb-8",children:(0,b.jsxs)("div",{className:(0,E.cn)("rounded-xl border p-4 transition-all cursor-pointer","border-white/[0.06] bg-white/[0.02]","hover:border-white/[0.1] hover:bg-white/[0.04]"),onClick:()=>h(!e),children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:(0,E.cn)("font-semibold",j.color),children:j.label}),a.metadata?.proposalVersion&&(0,b.jsxs)("span",{className:"text-xs text-zinc-500 px-2 py-0.5 bg-zinc-800 rounded",children:["v",a.metadata.proposalVersion]})]}),(0,b.jsx)("p",{className:"text-sm text-zinc-400 mt-1",children:a.parecer?.summary||"Sem descriÃ§Ã£o"})]}),(0,b.jsx)(i.Button,{variant:"ghost",size:"sm",className:"text-zinc-500",children:e?(0,b.jsx)(I.ChevronUp,{className:"h-4 w-4"}):(0,b.jsx)(H.ChevronDown,{className:"h-4 w-4"})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 mt-3 text-xs text-zinc-500",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(G.User,{className:"h-3.5 w-3.5"}),a.metadata?.userName||"UsuÃ¡rio"]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(r.Clock,{className:"h-3.5 w-3.5"}),l]}),a.metadata?.proposalName&&(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(J.FileText,{className:"h-3.5 w-3.5"}),a.metadata.proposalName]})]}),(0,b.jsx)(g.AnimatePresence,{children:e&&(0,b.jsxs)(f.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 pt-4 border-t border-white/[0.06]",children:[a.parecer?.nextSteps&&a.parecer.nextSteps.length>0&&(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-zinc-300 mb-2",children:"PrÃ³ximos Passos"}),(0,b.jsx)("ul",{className:"space-y-1",children:a.parecer.nextSteps.map((a,c)=>(0,b.jsxs)("li",{className:"flex items-center gap-2 text-sm text-zinc-400",children:[(0,b.jsx)("span",{className:"h-1.5 w-1.5 rounded-full bg-zinc-600"}),a]},c))})]}),"AJUSTAR"===a.type&&a.adjustments&&a.adjustments.length>0&&(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-amber-400 mb-2",children:"Ajustes Solicitados"}),(0,b.jsx)("ul",{className:"space-y-1",children:a.adjustments.map((a,c)=>(0,b.jsxs)("li",{className:"flex items-center gap-2 text-sm text-zinc-400",children:[(0,b.jsx)(F.RefreshCw,{className:"h-3 w-3 text-amber-400"}),a]},c))})]}),a.parecer?.consolidated?.totalScore&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)(t.Sparkles,{className:"h-4 w-4 text-emerald-400"}),(0,b.jsx)("span",{className:"text-zinc-400",children:"Score do Conselho:"}),(0,b.jsx)("span",{className:"font-semibold text-white",children:"number"==typeof a.parecer.consolidated.totalScore?a.parecer.consolidated.totalScore.toFixed(1):a.parecer.consolidated.totalScore})]})]})})]})})]})}function M({funnelId:a,className:d}){let[e,f]=(0,c.useState)([]),[g,h]=(0,c.useState)(!0);(0,c.useEffect)(()=>{i()},[a]);let i=async()=>{try{h(!0);let b=await fetch(`/api/decisions?funnelId=${a}`),c=await b.json();f(c.decisions||[])}catch(a){console.error("Error loading decisions:",a)}finally{h(!1)}};return g?(0,b.jsx)("div",{className:(0,E.cn)("space-y-4",d),children:[1,2].map(a=>(0,b.jsxs)("div",{className:"flex gap-4 animate-pulse",children:[(0,b.jsx)("div",{className:"h-10 w-10 rounded-xl bg-zinc-800"}),(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsx)("div",{className:"h-24 rounded-xl bg-zinc-800"})})]},a))}):0===e.length?(0,b.jsxs)("div",{className:(0,E.cn)("text-center py-8",d),children:[(0,b.jsx)("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-xl bg-zinc-800/50 mb-3",children:(0,b.jsx)(r.Clock,{className:"h-6 w-6 text-zinc-600"})}),(0,b.jsx)("p",{className:"text-sm text-zinc-500",children:"Nenhuma decisÃ£o registrada"}),(0,b.jsx)("p",{className:"text-xs text-zinc-600 mt-1",children:"Avalie uma proposta para registrar a primeira decisÃ£o"})]}):(0,b.jsx)("div",{className:d,children:(0,b.jsx)("div",{className:"space-y-0",children:e.map((a,c)=>(0,b.jsx)(L,{decision:a,isLast:c===e.length-1},a.id))})})}var N=a.i(688865),O=a.i(26e3);function P({proposal:a,isOriginal:c,isLatest:d,onSelect:e}){let g=a.scorecard,h=g?.overall||0;return(0,b.jsxs)(f.motion.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:(0,E.cn)("flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all","hover:bg-white/[0.04]",d?"bg-emerald-500/10 border border-emerald-500/30":"bg-white/[0.02]"),onClick:e,children:[(0,b.jsxs)("div",{className:(0,E.cn)("flex h-8 w-8 items-center justify-center rounded-lg text-xs font-bold",d?"bg-emerald-500 text-white":"bg-zinc-700 text-zinc-300"),children:["v",a.version||1]}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-white truncate",children:a.name}),d&&(0,b.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 bg-emerald-500/20 text-emerald-400 rounded",children:"ATUAL"}),c&&!d&&(0,b.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 bg-zinc-700 text-zinc-400 rounded",children:"ORIGINAL"})]}),a.appliedAdjustments&&a.appliedAdjustments.length>0&&(0,b.jsxs)("p",{className:"text-xs text-zinc-500 mt-0.5 truncate",children:["Ajustes: ",a.appliedAdjustments.slice(0,2).join(", "),a.appliedAdjustments.length>2&&"..."]})]}),(0,b.jsx)("div",{className:(0,E.cn)("text-sm font-semibold",h>=7.5?"text-emerald-400":h>=6?"text-amber-400":"text-red-400"),children:h.toFixed(1)})]})}function Q({group:a,onSelectProposal:d}){let[e,h]=(0,c.useState)(a.versions.length>0),j=a.versions.length>0,k=j?a.versions[0]:a.original,l=[a.original,...a.versions],m=k.scorecard,n=m?.overall||0;return(0,b.jsxs)("div",{className:"card-premium overflow-hidden",children:[(0,b.jsx)("div",{className:(0,E.cn)("p-4 cursor-pointer transition-colors",j&&"hover:bg-white/[0.02]"),onClick:()=>j?h(!e):d(a.original.id),children:(0,b.jsxs)("div",{className:"flex items-start gap-4",children:[(0,b.jsx)("div",{className:(0,E.cn)("flex h-14 w-14 flex-shrink-0 items-center justify-center rounded-xl",n>=7.5?"bg-emerald-500/10":n>=6?"bg-amber-500/10":"bg-red-500/10"),children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:(0,E.cn)("text-xl font-bold",n>=7.5?"text-emerald-400":n>=6?"text-amber-400":"text-red-400"),children:n.toFixed(1)}),(0,b.jsx)("div",{className:"text-[10px] text-zinc-500",children:"SCORE"})]})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("h4",{className:"font-semibold text-white truncate",children:k.name}),j&&(0,b.jsxs)("span",{className:"flex items-center gap-1 text-xs text-zinc-500",children:[(0,b.jsx)(N.GitBranch,{className:"h-3 w-3"}),l.length," versÃµes"]})]}),(0,b.jsx)("p",{className:"text-sm text-zinc-400 mt-1 line-clamp-2",children:k.summary}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:["selected"===k.status&&(0,b.jsxs)("span",{className:"flex items-center gap-1 text-xs text-emerald-400 bg-emerald-500/10 px-2 py-0.5 rounded",children:[(0,b.jsx)(o.CheckCircle2,{className:"h-3 w-3"}),"Selecionada"]}),j&&(0,b.jsxs)("span",{className:"flex items-center gap-1 text-xs text-blue-400 bg-blue-500/10 px-2 py-0.5 rounded",children:[(0,b.jsx)(F.RefreshCw,{className:"h-3 w-3"}),"Iterada"]})]})]}),j?(0,b.jsx)(i.Button,{variant:"ghost",size:"sm",className:"text-zinc-500",onClick:a=>{a.stopPropagation(),h(!e)},children:e?(0,b.jsx)(H.ChevronDown,{className:"h-4 w-4"}):(0,b.jsx)(O.ChevronRight,{className:"h-4 w-4"})}):(0,b.jsx)(i.Button,{size:"sm",className:"btn-accent",onClick:()=>d(a.original.id),children:"Ver Detalhes"})]})}),(0,b.jsx)(g.AnimatePresence,{children:e&&j&&(0,b.jsx)(f.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-white/[0.06]",children:(0,b.jsxs)("div",{className:"p-4 bg-white/[0.01]",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,b.jsx)(r.Clock,{className:"h-4 w-4 text-zinc-500"}),(0,b.jsx)("span",{className:"text-sm font-medium text-zinc-400",children:"HistÃ³rico de VersÃµes"})]}),(0,b.jsx)("div",{className:"space-y-2 pl-2 border-l-2 border-zinc-800",children:l.map((a,c)=>(0,b.jsx)(P,{proposal:a,isOriginal:c===l.length-1,isLatest:0===c,onSelect:()=>d(a.id)},a.id))})]})})})]})}function R({proposals:a,onSelectProposal:c,className:d}){let e,f=(e=new Map,a.forEach(a=>{a.parentProposalId||e.set(a.id,{original:a,versions:[]})}),a.forEach(a=>{a.parentProposalId&&e.has(a.parentProposalId)?e.get(a.parentProposalId).versions.push(a):a.parentProposalId&&e.set(a.id,{original:a,versions:[]})}),e.forEach(a=>{a.versions.sort((a,b)=>(b.version||0)-(a.version||0))}),Array.from(e.values()));return 0===a.length?null:(0,b.jsx)("div",{className:(0,E.cn)("space-y-4",d),children:f.map(a=>(0,b.jsx)(Q,{group:a,onSelectProposal:c},a.original.id))})}var S=a.i(169405),T=a.i(174192);let U=(0,w.default)("link-2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);var V=a.i(428485);function W({isOpen:a,onClose:d,funnelId:e,funnelName:f,currentShareUrl:g}){let[h,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(g||null),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(0),s=async()=>{j(!0);try{let a=await fetch("/api/funnels/share",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({funnelId:e,expiresIn:o})}),b=await a.json();b.success?(l(b.shareUrl),S.notify.success("Link criado!","Compartilhe o link com quem quiser")):S.notify.error("Erro",b.error)}catch(a){S.notify.error("Erro","NÃ£o foi possÃ­vel criar o link")}finally{j(!1)}},t=async()=>{j(!0);try{let a=await fetch(`/api/funnels/share?funnelId=${e}`,{method:"DELETE"});(await a.json()).success&&(l(null),S.notify.info("Link removido","O compartilhamento foi desativado"))}catch(a){S.notify.error("Erro","NÃ£o foi possÃ­vel remover o link")}finally{j(!1)}},u=async()=>{if(k)try{await navigator.clipboard.writeText(k),n(!0),setTimeout(()=>n(!1),2e3),S.notify.success("Copiado!")}catch{S.notify.error("Erro ao copiar")}};return(0,b.jsx)(V.Dialog,{open:a,onOpenChange:a=>!a&&d(),children:(0,b.jsxs)(V.DialogContent,{className:"bg-zinc-900 border-zinc-800 max-w-md",children:[(0,b.jsx)(V.DialogHeader,{children:(0,b.jsxs)(V.DialogTitle,{className:"flex items-center gap-2 text-white",children:[(0,b.jsx)(A.Share2,{className:"h-5 w-5 text-emerald-400"}),"Compartilhar Funil"]})}),(0,b.jsxs)("div",{className:"space-y-4 pt-2",children:[(0,b.jsxs)("p",{className:"text-sm text-zinc-400",children:["Crie um link pÃºblico para compartilhar ",(0,b.jsxs)("strong",{className:"text-white",children:['"',f,'"']})," com qualquer pessoa."]}),k?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm text-zinc-400",children:"Link pÃºblico"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("div",{className:"flex-1 flex items-center gap-2 bg-zinc-800 rounded-lg px-3 py-2 border border-zinc-700",children:[(0,b.jsx)(U,{className:"h-4 w-4 text-zinc-500 flex-shrink-0"}),(0,b.jsx)("span",{className:"text-sm text-white truncate",children:k})]}),(0,b.jsx)(i.Button,{onClick:u,variant:"outline",size:"sm",className:"flex-shrink-0",children:m?(0,b.jsx)(y.Check,{className:"h-4 w-4 text-emerald-400"}):(0,b.jsx)(T.Copy,{className:"h-4 w-4"})})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(i.Button,{onClick:u,className:"flex-1 btn-accent",children:m?"Copiado!":"Copiar Link"}),(0,b.jsx)(i.Button,{onClick:t,variant:"outline",className:"text-red-400 hover:text-red-300",disabled:h,children:(0,b.jsx)(q.Trash2,{className:"h-4 w-4"})})]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"text-sm text-zinc-400 flex items-center gap-2",children:[(0,b.jsx)(r.Clock,{className:"h-4 w-4"}),"ExpiraÃ§Ã£o do link"]}),(0,b.jsx)("div",{className:"flex gap-2",children:[{label:"Nunca",value:0},{label:"7 dias",value:7},{label:"30 dias",value:30}].map(a=>(0,b.jsx)("button",{onClick:()=>p(a.value),className:(0,E.cn)("flex-1 py-2 px-3 rounded-lg text-sm transition-all",o===a.value?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"bg-zinc-800 text-zinc-400 border border-zinc-700 hover:border-zinc-600"),children:a.label},a.value))})]}),(0,b.jsx)(i.Button,{onClick:s,disabled:h,className:"w-full btn-accent",children:h?"Criando...":"Criar Link de Compartilhamento"})]}),(0,b.jsx)("p",{className:"text-xs text-zinc-500 text-center",children:"Qualquer pessoa com o link poderÃ¡ ver as propostas do funil."})]})]})})}let X=(0,w.default)("file-braces",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]),Y=(0,w.default)("file-code",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}]]),Z=(0,w.default)("clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]),$=[{format:"markdown",label:"Markdown",icon:J.FileText,description:"Para documentaÃ§Ã£o e README"},{format:"html",label:"HTML",icon:Y,description:"Para Google Docs ou email"},{format:"json",label:"JSON",icon:X,description:"Para integraÃ§Ã£o com APIs"},{format:"notion",label:"Notion",icon:Z,description:"Copiar como blocos Notion"}];function _({isOpen:a,onClose:d,funnel:e,proposals:f}){let[g,h]=(0,c.useState)("markdown"),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(!1),n=async()=>{m(!0);try{let a,b,c,d,h,i;switch(g){case"markdown":d=`# ${e.name}

> ${e.context?.objective?`Objetivo: ${e.context.objective}`:"Funil criado com Conselho de Funil"}

## ðŸ“‹ Contexto

| Campo | Valor |
|-------|-------|
| **Empresa** | ${e.context.company} |
| **Mercado** | ${e.context.market} |
| **Objetivo** | ${e.context.objective} |
| **Audi\xeancia** | ${e.context.audience.who} |
| **Dor** | ${e.context.audience.pain} |
| **Awareness** | ${e.context.audience.awareness} |
| **Oferta** | ${e.context.offer.what} |
| **Ticket** | ${e.context.offer.ticket} |
| **Canal Principal** | ${e.context.channel?.main||"N/A"} |

`,f.length>0&&(d+=`## ðŸŽ¯ Propostas do Conselho

`,f.forEach((a,b)=>{d+=`### Proposta ${b+1}: ${a.name}

**Score:** ${a.scorecard?.overall?.toFixed(1)||"N/A"}/10

${a.summary}

`,a.architecture?.stages&&a.architecture.stages.length>0&&(d+=`#### Etapas do Funil

`,a.architecture.stages.forEach((a,b)=>{d+=`${b+1}. **${a.name}**
`,a.objective&&(d+=`   - Objetivo: ${a.objective}
`),d+="\n"})),a.strategy?.rationale&&(d+=`#### Racioc\xednio

${a.strategy.rationale}

`),d+="---\n\n"})),a=d+=`
*Gerado por [Conselho de Funil](https://conselho-de-funil.vercel.app) em ${new Date().toLocaleDateString("pt-BR")}*
`,b="text/markdown",c="md";break;case"html":h=`<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>${e.name}</title>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; max-width: 800px; margin: 0 auto; padding: 40px 20px; color: #1a1a1a; }
    h1 { color: #059669; border-bottom: 3px solid #059669; padding-bottom: 10px; }
    h2 { color: #374151; margin-top: 30px; }
    h3 { color: #059669; }
    table { border-collapse: collapse; width: 100%; margin: 15px 0; }
    th, td { border: 1px solid #e5e7eb; padding: 10px; text-align: left; }
    th { background: #f3f4f6; }
    .score { display: inline-block; padding: 4px 12px; border-radius: 20px; font-weight: bold; }
    .score-high { background: #d1fae5; color: #065f46; }
    .score-mid { background: #fef3c7; color: #92400e; }
    .score-low { background: #fee2e2; color: #991b1b; }
    .stage { background: #f9fafb; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 4px solid #059669; }
    blockquote { border-left: 4px solid #d1d5db; margin: 20px 0; padding: 10px 20px; background: #f9fafb; }
    .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #e5e7eb; color: #6b7280; font-size: 14px; }
  </style>
</head>
<body>
  <h1>ðŸŽ¯ ${e.name}</h1>
  <blockquote>${e.context?.objective?`Objetivo: ${e.context.objective}`:"Funil criado com Conselho de Funil"}</blockquote>
  
  <h2>ðŸ“‹ Contexto</h2>
  <table>
    <tr><th>Campo</th><th>Valor</th></tr>
    <tr><td>Empresa</td><td>${e.context.company}</td></tr>
    <tr><td>Mercado</td><td>${e.context.market}</td></tr>
    <tr><td>Objetivo</td><td>${e.context.objective}</td></tr>
    <tr><td>Audi\xeancia</td><td>${e.context.audience.who}</td></tr>
    <tr><td>Dor</td><td>${e.context.audience.pain}</td></tr>
    <tr><td>Awareness</td><td>${e.context.audience.awareness}</td></tr>
    <tr><td>Oferta</td><td>${e.context.offer.what}</td></tr>
    <tr><td>Ticket</td><td>${e.context.offer.ticket}</td></tr>
    <tr><td>Canal Principal</td><td>${e.context.channel?.main||"N/A"}</td></tr>
  </table>`,f.length>0&&(h+=`<h2>ðŸŽ¯ Propostas do Conselho</h2>`,f.forEach((a,b)=>{let c=a.scorecard?.overall||0,d=c>=7.5?"score-high":c>=6?"score-mid":"score-low";h+=`
      <h3>Proposta ${b+1}: ${a.name}</h3>
      <p><span class="score ${d}">${c.toFixed(1)}/10</span></p>
      <p>${a.summary}</p>`,a.architecture?.stages&&a.architecture.stages.length>0&&(h+="<h4>Etapas do Funil</h4>",a.architecture.stages.forEach((a,b)=>{h+=`
          <div class="stage">
            <strong>${b+1}. ${a.name}</strong>
            ${a.objective?`<br><small>Objetivo: ${a.objective}</small>`:""}
            ${a.metrics?.target?`<br><small>Meta: ${a.metrics.target}</small>`:""}
          </div>`})),a.strategy?.rationale&&(h+=`<h4>Racioc\xednio</h4><p>${a.strategy.rationale}</p>`),h+="<hr>"})),a=h+=`
  <div class="footer">
    <p>Gerado por <strong>Conselho de Funil</strong> em ${new Date().toLocaleDateString("pt-BR")}</p>
  </div>
</body>
</html>`,b="text/html",c="html";break;case"json":a=JSON.stringify({funnel:{id:e.id,name:e.name,status:e.status,context:e.context,createdAt:e.createdAt,updatedAt:e.updatedAt},proposals:f.map(a=>({id:a.id,name:a.name,version:a.version,summary:a.summary,status:a.status,scorecard:a.scorecard,architecture:a.architecture,strategy:a.strategy})),exportedAt:new Date().toISOString(),source:"Conselho de Funil"},null,2),b="application/json",c="json";break;case"notion":i=`# ${e.name}

> Objetivo: ${e.context?.objective||""}

## ðŸ“‹ Contexto
- **Empresa:** ${e.context.company}
- **Objetivo:** ${e.context.objective}
- **Audi\xeancia:** ${e.context.audience.who}
- **Dor:** ${e.context.audience.pain}
- **Oferta:** ${e.context.offer.what}
- **Ticket:** ${e.context.offer.ticket}

`,f.forEach((a,b)=>{let c=a.scorecard?.overall||0;i+=`## ðŸŽ¯ Proposta ${b+1}: ${a.name}
**Score:** ${c.toFixed(1)}/10

${a.summary}

`,a.architecture?.stages&&a.architecture.stages.length>0&&(i+=`### Etapas
`,a.architecture.stages.forEach((a,b)=>{i+=`${b+1}. **${a.name}** - ${a.objective||""}
`}),i+="\n")}),a=i,await navigator.clipboard.writeText(a),k(!0),setTimeout(()=>k(!1),2e3),S.notify.success("Copiado!","Cole no Notion com Ctrl+V"),m(!1);return;default:return}let j=new Blob([a],{type:b}),l=URL.createObjectURL(j),n=document.createElement("a");n.href=l,n.download=`${e.name.toLowerCase().replace(/\s+/g,"-")}.${c}`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(l),S.notify.success("Exportado!",`Arquivo ${c.toUpperCase()} baixado`)}catch(a){S.notify.error("Erro","Falha ao exportar")}finally{m(!1)}};return(0,b.jsx)(V.Dialog,{open:a,onOpenChange:a=>!a&&d(),children:(0,b.jsxs)(V.DialogContent,{className:"bg-zinc-900 border-zinc-800 max-w-md",children:[(0,b.jsx)(V.DialogHeader,{children:(0,b.jsxs)(V.DialogTitle,{className:"flex items-center gap-2 text-white",children:[(0,b.jsx)(z.Download,{className:"h-5 w-5 text-emerald-400"}),"Exportar Funil"]})}),(0,b.jsxs)("div",{className:"space-y-4 pt-2",children:[(0,b.jsxs)("p",{className:"text-sm text-zinc-400",children:["Escolha o formato para exportar ",(0,b.jsxs)("strong",{className:"text-white",children:['"',e.name,'"']})]}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2",children:$.map(a=>(0,b.jsxs)("button",{onClick:()=>h(a.format),className:(0,E.cn)("flex flex-col items-center gap-2 p-4 rounded-lg border transition-all text-left",g===a.format?"bg-emerald-500/10 border-emerald-500/30 text-white":"bg-zinc-800/50 border-zinc-700 text-zinc-400 hover:border-zinc-600"),children:[(0,b.jsx)(a.icon,{className:(0,E.cn)("h-6 w-6",g===a.format?"text-emerald-400":"text-zinc-500")}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"font-medium text-sm",children:a.label}),(0,b.jsx)("p",{className:"text-xs text-zinc-500",children:a.description})]})]},a.format))}),(0,b.jsx)(i.Button,{onClick:n,disabled:l,className:"w-full btn-accent",children:l?"Exportando...":"notion"===g?j?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(y.Check,{className:"mr-2 h-4 w-4"}),"Copiado!"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(T.Copy,{className:"mr-2 h-4 w-4"}),"Copiar para Notion"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(z.Download,{className:"mr-2 h-4 w-4"}),"Baixar ",g.toUpperCase()]})})]})]})})}var aa=a.i(502117),ab=a.i(74552),ac=a.i(356796),ad=a.i(804655),ae=a.i(529238),af=a.i(283303),ag=a.i(285744),ah=a.i(401920);let ai=(0,w.default)("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),aj=({title:a,result:c,icon:d,delay:e})=>{let g={pass:{color:"text-green-400",bg:"bg-green-500/10",icon:o.CheckCircle2},fail:{color:"text-red-400",bg:"bg-red-500/10",icon:p.XCircle},warning:{color:"text-yellow-400",bg:"bg-yellow-500/10",icon:s.AlertCircle}}[c.status];return(0,b.jsxs)(f.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:e},className:"card-premium p-5 border-l-4 border-l-zinc-800 hover:border-l-purple-500 transition-all",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-zinc-800 rounded-lg",children:(0,b.jsx)(d,{className:"w-5 h-5 text-zinc-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-bold text-white",children:a}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,b.jsx)(ac.Progress,{value:10*c.score,className:"h-1 w-20 bg-zinc-800"}),(0,b.jsxs)("span",{className:(0,E.cn)("text-[10px] font-bold",g.color),children:[c.score,"/10"]})]})]})]}),(0,b.jsx)(g.icon,{className:(0,E.cn)("w-5 h-5",g.color)})]}),(0,b.jsx)("ul",{className:"space-y-2",children:c.findings.map((a,c)=>(0,b.jsxs)("li",{className:"flex gap-2 text-xs text-zinc-400 leading-relaxed",children:[(0,b.jsx)("div",{className:(0,E.cn)("w-1.5 h-1.5 rounded-full mt-1.5 shrink-0",g.color.replace("text","bg"))}),a]},c))})]})},ak=({report:a})=>{var c;return(0,b.jsxs)("div",{className:"space-y-8 max-w-6xl mx-auto pb-20",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)(aa.Card,{className:"lg:col-span-2 bg-zinc-900/50 border-zinc-800 backdrop-blur-sm overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:(0,b.jsx)(j.Target,{className:"w-32 h-32"})}),(0,b.jsxs)(aa.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(ab.Badge,{variant:"outline",className:"text-purple-400 border-purple-500/30 bg-purple-500/5",children:"DiagnÃ³stico Forense Ativo"}),(0,b.jsxs)("span",{className:"text-[10px] text-zinc-500 uppercase tracking-widest",children:["ID: ",a.id]})]}),(0,b.jsx)(aa.CardTitle,{className:"text-3xl font-black text-white",children:"Resumo Executivo"})]}),(0,b.jsxs)(aa.CardContent,{children:[(0,b.jsxs)("p",{className:"text-zinc-400 leading-relaxed text-lg italic",children:['"',a.summary,'"']}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-8",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("span",{className:"text-[10px] text-zinc-500 uppercase font-bold",children:"Health Score"}),(0,b.jsxs)("div",{className:(0,E.cn)("text-2xl font-black",(c=a.score)<4?"text-red-500":c<7?"text-yellow-500":"text-green-500"),children:[10*a.score,"%"]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("span",{className:"text-[10px] text-zinc-500 uppercase font-bold",children:"Load Time"}),(0,b.jsxs)("div",{className:"text-2xl font-black text-white",children:[a.metadata.loadTimeMs,"ms"]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("span",{className:"text-[10px] text-zinc-500 uppercase font-bold",children:"Tech Stack"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:a.metadata.techStack.map(a=>(0,b.jsx)(ab.Badge,{variant:"secondary",className:"text-[9px] bg-zinc-800",children:a},a))})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("span",{className:"text-[10px] text-zinc-500 uppercase font-bold",children:"Status"}),(0,b.jsxs)("div",{className:"flex items-center gap-1 text-emerald-400 text-sm font-bold",children:[(0,b.jsx)(o.CheckCircle2,{className:"w-4 h-4"})," COMPLETO"]})]})]})]})]}),(0,b.jsxs)(aa.Card,{className:"bg-zinc-900/50 border-zinc-800 backdrop-blur-sm flex flex-col items-center justify-center p-6 text-center group",children:[(0,b.jsxs)("div",{className:"relative w-full aspect-video rounded-xl border border-zinc-800 overflow-hidden bg-zinc-950",children:[a.metadata.screenshotUrl?(0,b.jsx)("img",{src:a.metadata.screenshotUrl,alt:"Screenshot do Funil",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"}):(0,b.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center text-zinc-700",children:[(0,b.jsx)(ai,{className:"w-12 h-12 mb-2"}),(0,b.jsx)("span",{className:"text-xs",children:"Preview IndisponÃ­vel"})]}),(0,b.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-zinc-950 to-transparent opacity-60"}),(0,b.jsxs)("div",{className:"absolute bottom-3 left-3 flex items-center gap-2",children:[(0,b.jsx)(ah.Globe,{className:"w-3 h-3 text-zinc-400"}),(0,b.jsx)("span",{className:"text-[10px] text-zinc-300 truncate max-w-[150px]",children:a.url})]})]}),(0,b.jsxs)(Button,{variant:"ghost",size:"sm",className:"mt-4 text-zinc-500 hover:text-white text-[10px] uppercase font-bold tracking-widest",children:["Ver Captura Full-Size ",(0,b.jsx)(ag.ArrowRight,{className:"w-3 h-3 ml-2"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[(0,b.jsx)(aj,{title:"Hook",result:a.heuristics.hook,icon:v.Zap,delay:.1}),(0,b.jsx)(aj,{title:"Story",result:a.heuristics.story,icon:ad.Layers,delay:.2}),(0,b.jsx)(aj,{title:"Offer",result:a.heuristics.offer,icon:j.Target,delay:.3}),(0,b.jsx)(aj,{title:"Friction",result:a.heuristics.friction,icon:af.MousePointer2,delay:.4}),(0,b.jsx)(aj,{title:"Trust",result:a.heuristics.trust,icon:ae.ShieldCheck,delay:.5})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[(0,b.jsx)(s.AlertCircle,{className:"w-5 h-5 text-purple-400"}),"Plano de AÃ§Ã£o Corretiva"]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.recommendations.sort((a,b)=>{let c={high:3,medium:2,low:1};return c[b.priority]-c[a.priority]}).map((a,c)=>(0,b.jsxs)(f.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.6+.1*c},className:"p-5 bg-zinc-900/30 border border-zinc-800 rounded-2xl flex gap-4 hover:bg-zinc-900/50 transition-colors group",children:[(0,b.jsx)("div",{className:(0,E.cn)("w-10 h-10 rounded-xl flex items-center justify-center shrink-0","high"===a.priority?"bg-red-500/10 text-red-400":"medium"===a.priority?"bg-yellow-500/10 text-yellow-400":"bg-blue-500/10 text-blue-400"),children:(0,b.jsx)(v.Zap,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(ab.Badge,{variant:"outline",className:(0,E.cn)("text-[9px] uppercase font-black","high"===a.priority?"border-red-500/30 text-red-400":"medium"===a.priority?"border-yellow-500/30 text-yellow-400":"border-blue-500/30 text-blue-400"),children:[a.priority," Priority"]}),(0,b.jsx)(ab.Badge,{variant:"secondary",className:"text-[9px] uppercase bg-zinc-800",children:a.type})]}),(0,b.jsx)("h5",{className:"font-bold text-white group-hover:text-purple-400 transition-colors",children:a.action}),(0,b.jsx)("p",{className:"text-xs text-zinc-500 leading-relaxed",children:a.impact})]})]},c))})]})]})},al={draft:{label:"Rascunho",color:"text-zinc-400",bg:"bg-zinc-500/10",description:"Aguardando geraÃ§Ã£o pelo Conselho",glow:"from-zinc-500/5 to-transparent"},generating:{label:"Gerando Propostas",color:"text-blue-400",bg:"bg-blue-500/10",description:"O Conselho estÃ¡ analisando e criando propostas...",glow:"from-blue-500/5 to-transparent"},review:{label:"Propostas Prontas",color:"text-amber-400",bg:"bg-amber-500/10",description:"Avalie as propostas e decida: EXECUTAR, AJUSTAR ou MATAR",glow:"from-amber-500/5 to-transparent"},approved:{label:"Aprovado",color:"text-emerald-400",bg:"bg-emerald-500/10",description:"Pronto para execuÃ§Ã£o estratÃ©gica",glow:"from-emerald-500/5 to-transparent"},adjusting:{label:"Ajustando",color:"text-violet-400",bg:"bg-violet-500/10",description:"Aplicando ajustes solicitados pelo Conselho",glow:"from-violet-500/5 to-transparent"},executing:{label:"Executando",color:"text-blue-400",bg:"bg-blue-500/10",description:"Funil em operaÃ§Ã£o e monitoramento ativado",glow:"from-blue-500/5 to-transparent"},completed:{label:"ConcluÃ­do",color:"text-emerald-400",bg:"bg-emerald-500/10",description:"Ciclo estratÃ©gico finalizado com sucesso",glow:"from-emerald-500/5 to-transparent"},killed:{label:"Cancelado",color:"text-red-400",bg:"bg-red-500/10",description:"Funil descontinuado apÃ³s anÃ¡lise de viabilidade",glow:"from-red-500/5 to-transparent"}},am={fria:"AudiÃªncia Fria",morna:"AudiÃªncia Morna",quente:"AudiÃªncia Quente",unaware:"Inconsciente",problem:"Consciente do Problema",solution:"Consciente da SoluÃ§Ã£o",product:"Consciente do Produto"},an=()=>(0,b.jsxs)(f.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"card-premium p-12 text-center relative overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-zinc-950/50 backdrop-blur-sm z-0"}),(0,b.jsxs)("div",{className:"relative z-10",children:[(0,b.jsxs)("div",{className:"relative mx-auto mb-8 w-24 h-24",children:[(0,b.jsx)(f.motion.div,{animate:{rotate:360},transition:{duration:3,repeat:1/0,ease:"linear"},className:"absolute inset-0 rounded-full border-2 border-purple-500/20 border-t-purple-500"}),(0,b.jsx)("div",{className:"absolute inset-3 rounded-full bg-gradient-to-br from-purple-500/20 to-transparent flex items-center justify-center",children:(0,b.jsx)(v.Zap,{className:"h-8 w-8 text-purple-400 animate-pulse"})})]}),(0,b.jsx)("h3",{className:"text-xl font-black text-white mb-3 uppercase tracking-widest",children:"Iniciando AutÃ³psia Forense..."}),(0,b.jsx)("p",{className:"text-zinc-400 mb-6 max-w-md mx-auto text-sm italic",children:'"O Agente Monara estÃ¡ escaneando a estrutura do funil enquanto o Conselho de Estrategistas prepara o diagnÃ³stico."'}),(0,b.jsxs)("div",{className:"flex flex-col items-center gap-4 text-xs font-mono text-zinc-500",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"h-1 w-1 rounded-full bg-purple-500 animate-ping"}),(0,b.jsx)("span",{children:"[SCRAPING_ENGINE]: ACTIVE"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"h-1 w-1 rounded-full bg-purple-500 animate-ping delay-75"}),(0,b.jsx)("span",{children:"[HEURISTIC_ANALYSIS]: GEMINI_1.5_PRO_READY"})]})]})]})]});function ao(){let a=(0,d.useParams)(),w=(0,d.useRouter)(),{remove:F,update:G}=(0,D.useFunnels)(),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)([]),[L,N]=(0,c.useState)(null),[O,P]=(0,c.useState)(!0),[Q,T]=(0,c.useState)(!1),[U,V]=(0,c.useState)(!1),[X,Y]=(0,c.useState)(!1),[Z,$]=(0,c.useState)(!1),[aa,ab]=(0,c.useState)(null),[ac,ad]=(0,c.useState)(!1),[ae,af]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(!a.id)return;let b=(0,B.onSnapshot)((0,B.doc)(C.db,"funnels",a.id),b=>{if(b.exists()){let c={id:b.id,...b.data()};I(c),H?.status==="generating"&&"review"===c.status&&S.notify.success("ðŸŽ¯ Propostas Prontas!",`O Conselho terminou de analisar "${c.name}"`),"draft"!==c.status&&"generating"!==c.status&&ag(a.id)}else I(null);P(!1)});return()=>b()},[a.id]);let ag=async a=>{try{let b=(0,B.query)((0,B.collection)(C.db,"funnels",a,"proposals"),(0,B.orderBy)("version","asc")),c=(await (0,B.getDocs)(b)).docs.map(a=>({id:a.id,...a.data()}));K(c)}catch(a){console.error("Error loading proposals:",a)}},ah=async()=>{if(!H||!H.context.url)return void S.notify.error("Erro","URL do funil nÃ£o encontrada no contexto.");V(!0);try{let a=await fetch("/api/intelligence/autopsy/run",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({brandId:H.brandId||"default",url:H.context.url,depth:"deep",context:{targetAudience:H.context.audience?.who,mainOffer:H.context.offer?.what}})});if(!a.ok)throw Error("Falha na autÃ³psia");let b=await a.json();N(b),S.notify.success("AutÃ³psia Completa!","O diagnÃ³stico forense estÃ¡ pronto.")}catch(a){console.error("Autopsy error:",a),S.notify.error("Erro na AutÃ³psia","NÃ£o foi possÃ­vel completar o diagnÃ³stico.")}finally{V(!1)}},ai=async()=>{if(H){T(!0);try{let a=await fetch("/api/funnels/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({funnelId:H.id,context:H.context})});if(!a.ok){let b=await a.json();throw Error(b.error||"Failed to generate proposals")}}catch(a){console.error("Error generating proposals:",a),alert("Erro ao gerar propostas. Tente novamente."),T(!1)}}},aj=async()=>{H&&confirm("Tem certeza que deseja excluir este funil?")&&(await F(H.id),w.push("/funnels"))},ao=async()=>{if(H){P(!0);try{let a=Date.now(),b=Math.random().toString(36).substring(2,7),c=`${H.id}_${a}_${b}`,d=(0,B.doc)(C.db,"campaigns",c),e=J.find(a=>"selected"===a.status)||J[0],f={id:c,funnelId:H.id,brandId:H.brandId||"",userId:H.userId||"",name:H.name,status:"active",funnel:{type:H.context.objective||"Funnel",architecture:e?.strategy?.rationale||"",targetAudience:H.context.audience?.who||"",mainGoal:H.context.objective||"",stages:e?.architecture?.stages?.map(a=>a.name)||[],summary:e?.summary||""},createdAt:B.Timestamp.now(),updatedAt:B.Timestamp.now()};await (0,B.setDoc)(d,f),S.notify.success("Linha de Ouro Ativada!","Seu manifesto estratÃ©gico foi criado."),w.push(`/campaigns/${c}`)}catch(a){console.error("Error activating Golden Thread:",a),S.notify.error("Erro","Falha ao ativar a Linha de Ouro.")}finally{P(!1)}}},ap=async()=>{if(!H||0===J.length)return;let a=J.find(a=>"selected"===a.status)||J[0];Y(!0);try{if(!(await fetch("/api/library",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({funnelId:H.id,proposalId:a.id,name:`Template: ${H.name}`,description:a.summary,tags:[H.context.objective,H.context.channel?.main].filter(Boolean)})})).ok)throw Error("Failed to save template");$(!0)}catch(a){console.error("Error saving to library:",a),alert("Erro ao salvar na biblioteca. Tente novamente.")}finally{Y(!1)}};if(O)return(0,b.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,b.jsx)(h.Header,{title:"Carregando...",showBack:!0}),(0,b.jsx)("div",{className:"flex-1 p-8",children:(0,b.jsxs)("div",{className:"animate-pulse space-y-6 max-w-5xl mx-auto",children:[(0,b.jsx)("div",{className:"h-20 rounded-xl bg-zinc-800/50"}),(0,b.jsx)("div",{className:"grid gap-5 md:grid-cols-2",children:[1,2,3,4].map(a=>(0,b.jsx)("div",{className:"h-40 rounded-xl bg-zinc-800/50"},a))})]})})]});if(!H)return(0,b.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,b.jsx)(h.Header,{title:"Funil nÃ£o encontrado",showBack:!0}),(0,b.jsx)("div",{className:"flex-1 p-8 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-2xl bg-zinc-800/50 mb-4",children:(0,b.jsx)(j.Target,{className:"h-8 w-8 text-zinc-600"})}),(0,b.jsx)("h3",{className:"text-lg font-medium text-white",children:"Funil nÃ£o encontrado"}),(0,b.jsx)("p",{className:"mt-2 text-zinc-500",children:"O funil pode ter sido excluÃ­do ou nÃ£o existe."}),(0,b.jsx)(e.default,{href:"/funnels",children:(0,b.jsx)(i.Button,{className:"mt-6 btn-accent",children:"Voltar para Funis"})})]})})]});let aq=al[H.status]||al.draft,ar="generating"===H.status||Q;return(0,b.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,b.jsx)(h.Header,{title:H.name,showBack:!0,actions:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[H.context.url&&(0,b.jsxs)(i.Button,{onClick:ah,disabled:U,className:"bg-purple-600 hover:bg-purple-700 text-white font-bold",children:[U?(0,b.jsx)(u.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(v.Zap,{className:"mr-2 h-4 w-4"}),"Executar AutÃ³psia"]}),"approved"===H.status&&(0,b.jsxs)(i.Button,{onClick:ao,className:"bg-amber-500 hover:bg-amber-600 text-black font-bold",children:[(0,b.jsx)(v.Zap,{className:"mr-2 h-4 w-4"}),"Ativar Linha de Ouro"]}),"approved"===H.status&&J.length>0&&(0,b.jsx)(i.Button,{variant:"outline",className:(0,E.cn)("btn-ghost",Z&&"text-emerald-400 border-emerald-500/50"),onClick:ap,disabled:X||Z,children:Z?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(y.Check,{className:"mr-2 h-4 w-4"}),"Salvo"]}):X?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(u.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvando..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(x,{className:"mr-2 h-4 w-4"}),"Salvar na Biblioteca"]})}),(0,b.jsxs)(i.Button,{variant:"ghost",className:"btn-ghost",onClick:()=>af(!0),children:[(0,b.jsx)(z.Download,{className:"mr-2 h-4 w-4"}),"Exportar"]}),(0,b.jsxs)(i.Button,{variant:"ghost",className:"btn-ghost",onClick:()=>ad(!0),children:[(0,b.jsx)(A.Share2,{className:"mr-2 h-4 w-4"}),"Compartilhar"]}),(0,b.jsxs)(i.Button,{variant:"ghost",className:"btn-ghost",onClick:aj,children:[(0,b.jsx)(q.Trash2,{className:"mr-2 h-4 w-4"}),"Excluir"]}),(0,b.jsx)(e.default,{href:`/chat?funnelId=${H.id}`,children:(0,b.jsxs)(i.Button,{className:"btn-accent",children:[(0,b.jsx)(n.MessageSquare,{className:"mr-2 h-4 w-4"}),"Consultar Conselho"]})})]})}),(0,b.jsx)("div",{className:"flex-1 p-4 sm:p-8",children:(0,b.jsxs)("div",{className:"max-w-5xl mx-auto",children:[(0,b.jsxs)(f.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:(0,E.cn)("card-premium p-5 sm:p-6 mb-6 sm:mb-8 border-l-4 relative overflow-hidden",aq.color.replace("text","border")),children:[(0,b.jsx)("div",{className:(0,E.cn)("absolute inset-0 bg-gradient-to-r opacity-20 pointer-events-none",aq.glow)}),(0,b.jsxs)("div",{className:"relative flex flex-col md:flex-row md:items-center justify-between gap-6",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3 sm:gap-4",children:[(0,b.jsxs)("div",{className:(0,E.cn)("flex h-10 w-10 sm:h-12 sm:w-12 items-center justify-center rounded-xl sm:rounded-2xl shrink-0",aq.bg),children:["approved"===H.status&&(0,b.jsx)(o.CheckCircle2,{className:(0,E.cn)("h-5 w-5 sm:h-6 sm:w-6",aq.color)}),"review"===H.status&&(0,b.jsx)(s.AlertCircle,{className:(0,E.cn)("h-5 w-5 sm:h-6 sm:w-6",aq.color)}),"killed"===H.status&&(0,b.jsx)(p.XCircle,{className:(0,E.cn)("h-5 w-5 sm:h-6 sm:w-6",aq.color)}),"generating"===H.status&&(0,b.jsx)(u.Loader2,{className:(0,E.cn)("h-5 w-5 sm:h-6 sm:w-6 animate-spin",aq.color)}),["draft","adjusting","executing","completed"].includes(H.status)&&(0,b.jsx)(r.Clock,{className:(0,E.cn)("h-5 w-5 sm:h-6 sm:w-6",aq.color)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:(0,E.cn)("inline-flex items-center gap-2 px-2.5 py-0.5 rounded-full text-[9px] sm:text-[10px] font-bold uppercase tracking-wider mb-1.5 sm:mb-2",aq.color,aq.bg,"border border-white/[0.05]"),children:aq.label}),(0,b.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-white mb-1",children:"Status EstratÃ©gico"}),(0,b.jsx)("p",{className:"text-zinc-400 text-xs sm:text-sm max-w-xl leading-relaxed",children:aq.description})]})]}),"draft"===H.status&&!Q&&(0,b.jsxs)(i.Button,{className:"btn-accent w-full md:w-auto shadow-lg shadow-emerald-500/20",onClick:ai,children:[(0,b.jsx)(t.Sparkles,{className:"mr-2 h-4 w-4"}),"Gerar Propostas"]})]})]}),(0,b.jsx)(g.AnimatePresence,{children:ar&&(0,b.jsx)(an,{})}),(0,b.jsxs)(g.AnimatePresence,{children:[U&&(0,b.jsx)(an,{}),L&&!U&&(0,b.jsxs)(f.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-12",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsxs)("h3",{className:"text-2xl font-black text-white flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:(0,b.jsx)(v.Zap,{className:"h-6 w-6 text-purple-400"})}),"RelatÃ³rio de AutÃ³psia Forense"]}),(0,b.jsx)(i.Button,{variant:"outline",size:"sm",className:"border-zinc-800 text-zinc-500 hover:text-white",onClick:()=>N(null),children:"Fechar RelatÃ³rio"})]}),(0,b.jsx)(ak,{report:L.report})]})]}),J.length>0&&!ar&&(0,b.jsxs)(f.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-5",children:(0,b.jsxs)("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[(0,b.jsx)(v.Zap,{className:"h-5 w-5 text-emerald-400"}),"Propostas do Conselho",(0,b.jsxs)("span",{className:"text-sm font-normal text-zinc-500",children:["(",J.length," ",1===J.length?"proposta":"propostas",")"]})]})}),(0,b.jsx)(R,{proposals:J,onSelectProposal:a=>{w.push(`/funnels/${H?.id}/proposals/${a}`)}})]}),!ar&&(0,b.jsxs)("div",{className:"grid gap-4 sm:gap-5 grid-cols-1 sm:grid-cols-2",children:[(0,b.jsxs)(f.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"card-premium p-5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-emerald-500/10",children:(0,b.jsx)(j.Target,{className:"h-5 w-5 text-emerald-400"})}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Contexto"})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-zinc-500",children:"Objetivo"}),(0,b.jsx)("p",{className:"text-white font-medium capitalize",children:H.context.objective})]}),H.context.company&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-zinc-500",children:"Empresa"}),(0,b.jsx)("p",{className:"text-zinc-300",children:H.context.company})]}),H.context.market&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-zinc-500",children:"Mercado"}),(0,b.jsx)("p",{className:"text-zinc-300",children:H.context.market})]})]})]}),(0,b.jsxs)(f.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},className:"card-premium p-5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-blue-500/10",children:(0,b.jsx)(k.Users,{className:"h-5 w-5 text-blue-400"})}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-white",children:"PÃºblico"})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-zinc-500",children:"Quem Ã©"}),(0,b.jsx)("p",{className:"text-zinc-300",children:H.context.audience?.who})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-zinc-500",children:"Dor principal"}),(0,b.jsx)("p",{className:"text-zinc-300",children:H.context.audience?.pain})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-zinc-500",children:"NÃ­vel de consciÃªncia"}),(0,b.jsx)("p",{className:"text-white font-medium",children:am[H.context.audience?.awareness||""]||H.context.audience?.awareness})]})]})]}),(0,b.jsxs)(f.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"card-premium p-5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-amber-500/10",children:(0,b.jsx)(l.Package,{className:"h-5 w-5 text-amber-400"})}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Oferta"})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-zinc-500",children:"Produto"}),(0,b.jsx)("p",{className:"text-white font-medium",children:H.context.offer?.what})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-zinc-500",children:"Ticket"}),(0,b.jsx)("p",{className:"text-emerald-400 font-semibold text-lg",children:H.context.offer?.ticket})]}),H.context.offer?.type&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-zinc-500",children:"Tipo"}),(0,b.jsx)("p",{className:"text-zinc-300 capitalize",children:H.context.offer.type})]})]})]})]}),(0,b.jsxs)(f.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25},className:"card-premium p-5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-violet-500/10",children:(0,b.jsx)(m.Radio,{className:"h-5 w-5 text-violet-400"})}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Canais"})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-zinc-500",children:"Principal"}),(0,b.jsx)("p",{className:"text-white font-medium capitalize",children:H.context.channel?.main})]}),H.context.channel?.secondary&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-zinc-500",children:"SecundÃ¡rio"}),(0,b.jsx)("p",{className:"text-zinc-300 capitalize",children:H.context.channel.secondary})]})]})]})]}),"draft"===H.status&&!Q&&(0,b.jsxs)(f.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.35},className:"mt-8 card-premium p-8 text-center",children:[(0,b.jsxs)("div",{className:"relative mx-auto mb-6",children:[(0,b.jsx)("div",{className:"absolute inset-0 rounded-2xl bg-emerald-500/20 blur-2xl"}),(0,b.jsx)("div",{className:"relative flex h-16 w-16 items-center justify-center rounded-2xl bg-gradient-to-br from-emerald-500 to-emerald-600 mx-auto",children:(0,b.jsx)(t.Sparkles,{className:"h-8 w-8 text-white"})})]}),(0,b.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"Pronto para criar propostas?"}),(0,b.jsx)("p",{className:"text-zinc-400 mb-6 max-w-md mx-auto",children:"O Conselho vai analisar seu contexto e gerar propostas de funil com arquitetura, copy e mÃ©tricas."}),(0,b.jsxs)(i.Button,{className:"btn-accent",onClick:ai,children:[(0,b.jsx)(t.Sparkles,{className:"mr-2 h-4 w-4"}),"Gerar Propostas com o Conselho"]})]}),!ar&&"draft"!==H.status&&(0,b.jsxs)(f.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"mt-8",children:[(0,b.jsxs)("h3",{className:"text-lg font-semibold text-white mb-5 flex items-center gap-2",children:[(0,b.jsx)(r.Clock,{className:"h-5 w-5 text-zinc-400"}),"HistÃ³rico de DecisÃµes"]}),(0,b.jsx)(M,{funnelId:H.id})]})]})}),(0,b.jsx)(W,{isOpen:ac,onClose:()=>ad(!1),funnelId:H.id,funnelName:H.name}),(0,b.jsx)(_,{isOpen:ae,onClose:()=>af(!1),funnel:H,proposals:J})]})}a.s(["default",()=>ao],202561)}];

//# sourceMappingURL=13466_Desktop_CURSOR_CONSELHO%20DE%20FUNIL_app_src_app_funnels_%5Bid%5D_page_tsx_1df09e83._.js.map