module.exports=[381884,a=>{"use strict";var b=a.i(194327),c=a.i(582583),d=a.i(126236),e=a.i(919550),f=a.i(616396),g=a.i(923776),h=a.i(168283),i=a.i(270509),j=a.i(168565),k=a.i(376517),l=a.i(529238),m=a.i(539514),n=a.i(248842),o=a.i(502117),p=a.i(74552),q=a.i(928360),r=a.i(679109),s=a.i(778117),t=a.i(283303),u=a.i(47916);let v=(0,u.default)("circle-play",[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),w=(0,u.default)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);var x=a.i(599959),y=a.i(176173),z=a.i(749172),A=a.i(791026),B=a.i(925981),C=a.i(862783),D="horizontal",E=["horizontal","vertical"],F=c.forwardRef((a,c)=>{var d;let{decorative:e,orientation:f=D,...g}=a,h=(d=f,E.includes(d))?f:D;return(0,b.jsx)(C.Primitive.div,{"data-orientation":h,...e?{role:"none"}:{"aria-orientation":"vertical"===h?h:void 0,role:"separator"},...g,ref:c})});F.displayName="Separator";var G=a.i(810045);function H({className:a,orientation:c="horizontal",decorative:d=!0,...e}){return(0,b.jsx)(F,{"data-slot":"separator",decorative:d,orientation:c,className:(0,G.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",a),...e})}let I=({events:a})=>a&&0!==a.length?(0,b.jsxs)(o.Card,{className:"w-full border-none shadow-none bg-transparent",children:[(0,b.jsx)(o.CardHeader,{className:"px-0",children:(0,b.jsxs)(o.CardTitle,{className:"text-lg font-semibold flex items-center gap-2",children:[(0,b.jsx)(z.Clock,{className:"w-5 h-5 text-primary"}),"Rastro do Lead (Timeline)"]})}),(0,b.jsx)(o.CardContent,{className:"px-0",children:(0,b.jsx)(B.ScrollArea,{className:"h-[600px] pr-4",children:(0,b.jsx)("div",{className:"relative space-y-8 before:absolute before:inset-0 before:ml-5 before:-translate-x-px before:h-full before:w-0.5 before:bg-gradient-to-b before:from-primary/20 before:via-primary/10 before:to-transparent",children:a.map((a,c)=>(0,b.jsxs)("div",{className:"relative flex items-start gap-6 group",children:[(0,b.jsx)("div",{className:"absolute left-0 flex items-center justify-center w-10 h-10 rounded-full bg-background border-2 border-primary/20 group-hover:border-primary transition-colors z-10 shadow-sm",children:(a=>{switch(a){case"page_view":return(0,b.jsx)(t.MousePointer2,{className:"w-4 h-4 text-blue-500"});case"vsl_watch":return(0,b.jsx)(v,{className:"w-4 h-4 text-red-500"});case"checkout_init":return(0,b.jsx)(w,{className:"w-4 h-4 text-amber-500"});case"lead_capture":return(0,b.jsx)(x.UserPlus,{className:"w-4 h-4 text-green-500"});default:return(0,b.jsx)(y.Activity,{className:"w-4 h-4 text-slate-500"})}})(a.type)}),(0,b.jsxs)("div",{className:"flex-1 ml-12 pt-1",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-bold text-slate-900 dark:text-slate-100",children:(a=>{switch(a){case"page_view":return"Visualizou PÃ¡gina";case"vsl_watch":return"Assistiu VSL";case"checkout_init":return"Iniciou Checkout";case"lead_capture":return"Captura de Lead";default:return"Evento Customizado"}})(a.type)}),(0,b.jsx)(p.Badge,{variant:"outline",className:"text-[10px] uppercase tracking-wider py-0 px-1.5 h-4",children:a.source})]}),(0,b.jsx)("time",{className:"text-xs text-muted-foreground font-medium",children:(0,r.format)(a.timestamp.toDate(),"dd 'de' MMM 'Ã s' HH:mm",{locale:s.ptBR})})]}),(0,b.jsxs)("div",{className:"bg-slate-50 dark:bg-slate-900/50 rounded-lg p-3 border border-slate-100 dark:border-slate-800",children:[(a.session?.utmSource||a.session?.utmMedium)&&(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1 mb-2 text-[11px]",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1 text-blue-600 dark:text-blue-400",children:[(0,b.jsx)("span",{className:"font-semibold uppercase",children:"Source:"}),(0,b.jsx)("span",{children:a.session.utmSource||"direct"})]}),(0,b.jsx)(H,{orientation:"vertical",className:"h-3 hidden sm:block"}),(0,b.jsxs)("div",{className:"flex items-center gap-1 text-purple-600 dark:text-purple-400",children:[(0,b.jsx)("span",{className:"font-semibold uppercase",children:"Medium:"}),(0,b.jsx)("span",{children:a.session.utmMedium||"none"})]}),a.session.utmCampaign&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(H,{orientation:"vertical",className:"h-3 hidden sm:block"}),(0,b.jsxs)("div",{className:"flex items-center gap-1 text-emerald-600 dark:text-emerald-400",children:[(0,b.jsx)("span",{className:"font-semibold uppercase",children:"Campaign:"}),(0,b.jsx)("span",{children:a.session.utmCampaign})]})]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[a.payload?.url&&(0,b.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground group/link",children:[(0,b.jsx)(A.ExternalLink,{className:"w-3 h-3"}),(0,b.jsx)("span",{className:"truncate max-w-[300px]",children:a.payload.url})]}),"vsl_watch"===a.type&&a.payload?.duration&&(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,b.jsx)("div",{className:"flex-1 h-1.5 bg-slate-200 dark:bg-slate-800 rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:"h-full bg-red-500 rounded-full",style:{width:`${Math.min(a.payload.duration/1800*100,100)}%`}})}),(0,b.jsxs)("span",{className:"text-[10px] font-mono text-muted-foreground",children:[Math.floor(a.payload.duration/60),"min assistidos"]})]})]})]})]})]},a.id||c))})})})]}):(0,b.jsx)(o.Card,{className:"w-full",children:(0,b.jsx)(o.CardContent,{className:"py-10 text-center text-muted-foreground",children:"Nenhum evento registrado para este lead."})});function J(){let a=(0,d.useParams)().leadId,[q,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(null);if((0,c.useEffect)(()=>{async function b(){try{let b=await fetch(`/api/intelligence/journey/${a}`);if(!b.ok)throw Error("Falha ao carregar jornada do lead");let c=await b.json();t(c)}catch(a){v(a.message)}finally{r(!1)}}a&&b()},[a]),q)return(0,b.jsx)(K,{});if(u||!s)return(0,b.jsx)(L,{message:u||"Lead nÃ£o encontrado"});let{lead:w,events:x}=s;return(0,b.jsxs)("div",{className:"container mx-auto py-8 space-y-8",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(m.default,{href:"/intelligence",children:(0,b.jsx)(n.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(k.ChevronLeft,{className:"w-5 h-5"})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"Perfil do Lead"}),(0,b.jsx)("p",{className:"text-muted-foreground text-sm",children:"Rastreamento individual e inteligÃªncia de LTV"})]})]}),(0,b.jsx)(p.Badge,{variant:"customer"===w.status?"default":"secondary",className:"px-4 py-1 text-sm font-semibold",children:"customer"===w.status?"ðŸ’Ž Cliente VIP":"ðŸŽ¯ Lead Qualificado"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(o.Card,{className:"overflow-hidden border-primary/10",children:[(0,b.jsx)("div",{className:"h-2 bg-primary"}),(0,b.jsx)(o.CardHeader,{className:"pb-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:(0,b.jsx)(e.User,{className:"w-6 h-6 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(o.CardTitle,{className:"text-lg",children:w.pii.firstName?`${w.pii.firstName} ${w.pii.lastName||""}`:"Lead AnÃ´nimo"}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground mt-1",children:[(0,b.jsx)(l.ShieldCheck,{className:"w-3 h-3 text-green-500"}),(0,b.jsx)("span",{children:"Dados Protegidos (PII)"})]})]})]})}),(0,b.jsxs)(o.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,b.jsx)(f.Mail,{className:"w-4 h-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"truncate",children:w.pii.email})]}),w.pii.phone&&(0,b.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,b.jsx)(g.Phone,{className:"w-4 h-4 text-muted-foreground"}),(0,b.jsx)("span",{children:w.pii.phone})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,b.jsx)(h.Calendar,{className:"w-4 h-4 text-muted-foreground"}),(0,b.jsxs)("span",{children:["Entrou em: ",new Date(1e3*w.createdAt.seconds).toLocaleDateString("pt-BR")]})]})]}),(0,b.jsx)("div",{className:"pt-4",children:(0,b.jsxs)(p.Badge,{variant:"outline",className:"w-full justify-center py-1 bg-slate-50 dark:bg-slate-900 border-dashed",children:["Safra: ",w.metrics.cohort||"N/A"]})})]})]}),(0,b.jsxs)(o.Card,{className:"bg-gradient-to-br from-slate-900 to-slate-800 text-white border-none shadow-xl",children:[(0,b.jsx)(o.CardHeader,{children:(0,b.jsxs)(o.CardTitle,{className:"text-sm font-medium flex items-center gap-2 opacity-80",children:[(0,b.jsx)(i.TrendingUp,{className:"w-4 h-4"}),"LTV Intelligence"]})}),(0,b.jsxs)(o.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-3xl font-bold",children:(w.metrics.totalLtv/100).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}),(0,b.jsx)("p",{className:"text-[10px] uppercase tracking-widest opacity-50 mt-1",children:"Valor VitalÃ­cio Acumulado"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xl font-semibold",children:w.metrics.transactionCount}),(0,b.jsx)("p",{className:"text-[10px] uppercase opacity-50",children:"TransaÃ§Ãµes"})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xl font-semibold",children:(w.metrics.averageTicket/100).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}),(0,b.jsx)("p",{className:"text-[10px] uppercase opacity-50",children:"Ticket MÃ©dio"})]})]})]})]}),(0,b.jsxs)(o.Card,{children:[(0,b.jsx)(o.CardHeader,{children:(0,b.jsxs)(o.CardTitle,{className:"text-sm font-medium flex items-center gap-2",children:[(0,b.jsx)(j.Target,{className:"w-4 h-4 text-primary"}),"AtribuiÃ§Ã£o de Origem"]})}),(0,b.jsxs)(o.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-[10px] uppercase text-muted-foreground font-bold",children:"Primeiro Toque (First Touch)"}),(0,b.jsxs)("div",{className:"p-2 bg-slate-50 dark:bg-slate-900 rounded border text-xs font-mono",children:[w.attribution.firstSource," / ",w.attribution.firstMedium]}),(0,b.jsx)("p",{className:"text-[10px] text-muted-foreground italic",children:w.attribution.firstCampaign})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-[10px] uppercase text-muted-foreground font-bold",children:"Ãšltimo Toque (Last Touch)"}),(0,b.jsxs)("div",{className:"p-2 bg-slate-50 dark:bg-slate-900 rounded border text-xs font-mono",children:[w.attribution.lastSource," / ",w.attribution.lastMedium]}),(0,b.jsx)("p",{className:"text-[10px] text-muted-foreground italic",children:w.attribution.lastCampaign})]})]})]})]}),(0,b.jsx)("div",{className:"lg:col-span-2",children:(0,b.jsx)(I,{events:x})})]})]})}function K(){return(0,b.jsxs)("div",{className:"container mx-auto py-8 space-y-8",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)(q.Skeleton,{className:"h-10 w-48"}),(0,b.jsx)(q.Skeleton,{className:"h-8 w-24"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(q.Skeleton,{className:"h-64 w-full"}),(0,b.jsx)(q.Skeleton,{className:"h-40 w-full"})]}),(0,b.jsx)("div",{className:"lg:col-span-2",children:(0,b.jsx)(q.Skeleton,{className:"h-[600px] w-full"})})]})]})}function L({message:a}){return(0,b.jsx)("div",{className:"container mx-auto py-20 text-center",children:(0,b.jsxs)("div",{className:"max-w-md mx-auto space-y-4",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-red-100 text-red-600 rounded-full flex items-center justify-center mx-auto",children:(0,b.jsx)(Activity,{className:"w-8 h-8"})}),(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"Ops! Algo deu errado"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:a}),(0,b.jsx)(m.default,{href:"/intelligence",children:(0,b.jsx)(n.Button,{variant:"outline",children:"Voltar para InteligÃªncia"})})]})})}a.s(["default",()=>J],381884)}];

//# sourceMappingURL=6af30_CONSELHO%20DE%20FUNIL_app_src_app_intelligence_journey_%5BleadId%5D_page_tsx_8da76175._.js.map