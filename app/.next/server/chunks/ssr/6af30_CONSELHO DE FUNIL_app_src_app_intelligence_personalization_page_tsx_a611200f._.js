module.exports=[137201,a=>{"use strict";var b=a.i(194327),c=a.i(582583),d=a.i(502117),e=a.i(74552),f=a.i(356796),g=a.i(336050),h=a.i(635870),i=a.i(168565),j=a.i(679109),k=a.i(778117);function l({scan:a,onSelect:c,isSelected:l}){let{persona:m,propensity:n,metadata:o}=a;return(0,b.jsxs)(d.Card,{className:`cursor-pointer transition-all hover:shadow-md ${l?"border-purple-500 ring-1 ring-purple-500":""}`,onClick:()=>c?.(a),children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(d.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(h.Users,{className:"w-5 h-5 text-blue-500"}),a.name]}),(0,b.jsxs)(d.CardDescription,{children:["Gerado em ",(0,j.format)(o.createdAt.toDate(),"dd 'de' MMMM",{locale:k.ptBR})]})]}),(0,b.jsx)(e.Badge,{variant:"hot"===n.segment?"default":"warm"===n.segment?"secondary":"outline",className:"capitalize",children:n.segment})]})}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("span",{className:"text-xs text-muted-foreground uppercase font-bold",children:"Propensão"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.Progress,{value:100*n.score,className:"h-2"}),(0,b.jsxs)("span",{className:"text-sm font-medium",children:[(100*n.score).toFixed(0),"%"]})]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("span",{className:"text-xs text-muted-foreground uppercase font-bold",children:"Sofisticação"}),(0,b.jsx)("div",{className:"flex gap-1",children:[1,2,3,4,5].map(a=>(0,b.jsx)("div",{className:`h-2 w-full rounded-full ${a<=m.sophisticationLevel?"bg-purple-500":"bg-muted"}`},a))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,b.jsx)(i.Target,{className:"w-4 h-4 text-red-500"}),"Dores Principais"]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-1",children:[m.painPoints.slice(0,3).map((a,c)=>(0,b.jsx)(e.Badge,{variant:"secondary",className:"text-[10px] font-normal",children:a},c)),m.painPoints.length>3&&(0,b.jsxs)("span",{className:"text-[10px] text-muted-foreground",children:["+",m.painPoints.length-3]})]})]}),(0,b.jsx)("div",{className:"p-3 bg-muted/30 rounded-lg border border-dashed",children:(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(g.BrainCircuit,{className:"w-4 h-4 text-purple-500 mt-1 shrink-0"}),(0,b.jsxs)("p",{className:"text-xs italic text-muted-foreground leading-relaxed",children:['"',n.reasoning.substring(0,120),'..."']})]})})]})]})}function m(){return(0,b.jsxs)(d.Card,{className:"animate-pulse",children:[(0,b.jsxs)(d.CardHeader,{className:"pb-2",children:[(0,b.jsx)("div",{className:"h-6 w-3/4 bg-muted rounded mb-2"}),(0,b.jsx)("div",{className:"h-4 w-1/2 bg-muted rounded"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)("div",{className:"h-8 bg-muted rounded"}),(0,b.jsx)("div",{className:"h-8 bg-muted rounded"})]}),(0,b.jsx)("div",{className:"h-12 bg-muted rounded"}),(0,b.jsx)("div",{className:"h-16 bg-muted rounded"})]})]})}var n=a.i(248842),o=a.i(675982),p=a.i(250055),q=a.i(880925),r=a.i(124079),s=a.i(393045),t=a.i(688514),u=a.i(821739),v=a.i(223527);function w({scan:a,existingRule:e,onSave:f}){let[g,h]=c.useState(e?.contentVariations.headline||""),[i,j]=c.useState(e?.contentVariations.vslId||""),[k,l]=c.useState(e?.contentVariations.offerId||"");return(0,b.jsxs)(d.Card,{className:"border-2 border-purple-100 bg-purple-50/10",children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(q.Zap,{className:"w-5 h-5 text-yellow-500 fill-yellow-500"}),(0,b.jsx)(d.CardTitle,{children:"Regra de Personalização Dinâmica"})]}),(0,b.jsxs)(d.CardDescription,{children:["Defina o conteúdo que será exibido para a persona ",(0,b.jsx)("strong",{children:a.name}),"."]})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(p.Label,{className:"flex items-center gap-2",children:[(0,b.jsx)(t.Layout,{className:"w-4 h-4"}),"Headline Personalizada"]}),(0,b.jsx)(o.Input,{placeholder:"Ex: Como mães empreendedoras podem escalar sem perder tempo...",value:g,onChange:a=>h(a.target.value),className:"border-purple-200 focus-visible:ring-purple-500"}),(0,b.jsxs)("p",{className:"text-[10px] text-muted-foreground",children:['Dica da IA: Use a dor "',a.persona.painPoints[0],'" para maior conversão.']})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(p.Label,{className:"flex items-center gap-2",children:[(0,b.jsx)(u.Video,{className:"w-4 h-4"}),"ID do VSL (Opcional)"]}),(0,b.jsx)(o.Input,{placeholder:"vsl_123...",value:i,onChange:a=>j(a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(p.Label,{className:"flex items-center gap-2",children:[(0,b.jsx)(v.Tag,{className:"w-4 h-4"}),"ID da Oferta"]}),(0,b.jsx)(o.Input,{placeholder:"offer_abc...",value:k,onChange:a=>l(a.target.value)})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[(0,b.jsxs)(n.Button,{variant:"outline",size:"sm",className:"gap-2",children:[(0,b.jsx)(s.Trash2,{className:"w-4 h-4"}),"Descartar"]}),(0,b.jsxs)(n.Button,{size:"sm",className:"gap-2 bg-purple-600 hover:bg-purple-700",onClick:()=>{f({targetPersonaId:a.id,contentVariations:{headline:g,vslId:i,offerId:k},isActive:!0})},children:[(0,b.jsx)(r.Save,{className:"w-4 h-4"}),"Salvar Regra"]})]})]})]})}a.i(543317);var x=a.i(134034),y=a.i(860342);async function z(a){let b=(0,x.collection)(y.db,`brands/${a}/audience_scans`),c=(0,x.query)(b,(0,x.orderBy)("metadata.createdAt","desc"),(0,x.limit)(10));return(await (0,x.getDocs)(c)).docs.map(a=>({id:a.id,...a.data()}))}async function A(a){let b=(0,x.collection)(y.db,`brands/${a}/personalization_rules`);return(await (0,x.getDocs)(b)).docs.map(a=>({id:a.id,...a.data()}))}async function B(a,b){let c=(0,x.collection)(y.db,`brands/${a}/personalization_rules`);return await (0,x.addDoc)(c,{...b,updatedAt:x.Timestamp.now()})}var C=a.i(300180),D=a.i(822399);let E=(0,a.i(47916).default)("wand-sparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);var F=a.i(453764);function G(){let[a,e]=c.useState([]),[f,h]=c.useState([]),[i,j]=c.useState(!0),[k,o]=c.useState(null),[p,q]=c.useState(!1),r="brand_default",s=c.useCallback(async()=>{j(!0);try{let[a,b]=await Promise.all([z(r),A(r)]);e(a),h(b)}catch(a){console.error("Erro ao carregar dados de personalização:",a),F.toast.error("Falha ao carregar dados.")}finally{j(!1)}},[r]);c.useEffect(()=>{s()},[s]);let t=async()=>{q(!0),F.toast.info("Iniciando Deep-Scan de audiência com IA...");try{let a=await fetch("/api/intelligence/audience/scan",{method:"POST",body:JSON.stringify({brandId:r})});if(!a.ok)throw Error("Falha na API");let b=await a.json();e(a=>[b,...a]),o(b),F.toast.success("Novo scan de audiência concluído!")}catch(a){F.toast.error("Erro ao executar scan.")}finally{q(!1)}},u=async a=>{try{await B(r,a),F.toast.success("Regra de personalização salva com sucesso!"),s()}catch(a){F.toast.error("Erro ao salvar regra.")}};return(0,b.jsxs)("div",{className:"container mx-auto p-6 space-y-8",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-3",children:[(0,b.jsx)(D.Sparkles,{className:"w-8 h-8 text-purple-500"}),"Personalização Dinâmica"]}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Gerencie como sua audiência interage com seu conteúdo baseado em inteligência psicográfica."})]}),(0,b.jsxs)(n.Button,{onClick:t,disabled:p,className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 gap-2",children:[p?(0,b.jsx)(C.RefreshCw,{className:"w-4 h-4 animate-spin"}):(0,b.jsx)(E,{className:"w-4 h-4"}),"Executar Deep-Scan (IA)"]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[(0,b.jsx)(g.BrainCircuit,{className:"w-5 h-5 text-blue-500"}),"Scans de Audiência"]}),(0,b.jsx)("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto pr-2",children:i?[1,2,3].map(a=>(0,b.jsx)(m,{},a)):a.length>0?a.map(a=>(0,b.jsx)(l,{scan:a,isSelected:k?.id===a.id,onSelect:o},a.id)):(0,b.jsx)("div",{className:"text-center py-12 border-2 border-dashed rounded-xl",children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Nenhum scan realizado ainda."})})})]}),(0,b.jsx)("div",{className:"lg:col-span-2 space-y-6",children:k?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{className:"text-sm uppercase text-muted-foreground",children:"Persona Detalhada"})}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm font-bold",children:"Dores:"}),(0,b.jsx)("ul",{className:"list-disc list-inside text-sm text-muted-foreground mt-1",children:k.persona.painPoints.map((a,c)=>(0,b.jsx)("li",{children:a},c))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm font-bold",children:"Desejos:"}),(0,b.jsx)("ul",{className:"list-disc list-inside text-sm text-muted-foreground mt-1",children:k.persona.desires.map((a,c)=>(0,b.jsx)("li",{children:a},c))})]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{className:"text-sm uppercase text-muted-foreground",children:"Raciocínio da IA"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:k.propensity.reasoning})})]})]}),(0,b.jsx)(w,{scan:k,existingRule:f.find(a=>a.targetPersonaId===k.id),onSave:u})]}):(0,b.jsxs)("div",{className:"h-full flex flex-col items-center justify-center py-20 border-2 border-dashed rounded-xl bg-muted/10",children:[(0,b.jsx)(D.Sparkles,{className:"w-12 h-12 text-muted-foreground/20 mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium",children:"Selecione um Scan"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Escolha um scan ao lado para configurar as regras de conteúdo dinâmico."})]})})]})]})}a.s(["default",()=>G],137201)}];

//# sourceMappingURL=6af30_CONSELHO%20DE%20FUNIL_app_src_app_intelligence_personalization_page_tsx_a611200f._.js.map