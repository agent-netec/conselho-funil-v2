{"version":3,"sources":["../../../../../../../../OneDrive/Desktop/CURSOR/CONSELHO%20DE%20FUNIL/app/src/lib/firebase/config.ts"],"sourcesContent":["// US-28.01: Mocks robustos para evitar crashes durante o build estÃ¡tico da Next.js\r\nconst mockInternal = {\r\n  container: {\r\n    get: () => ({}),\r\n  }\r\n};\r\n\r\nconst mockService = {\r\n  currentUser: null,\r\n  onAuthStateChanged: () => () => {},\r\n  signOut: async () => {},\r\n  getApp: () => ({ container: mockInternal.container }),\r\n  app: { container: mockInternal.container },\r\n  INTERNAL: mockInternal,\r\n  container: mockInternal.container,\r\n  collection: () => ({ doc: () => ({ get: async () => ({ exists: () => false }) }) }),\r\n  doc: () => ({ get: async () => ({ exists: () => false }) }),\r\n  ref: () => ({ put: async () => ({}) }),\r\n};\r\n\r\n// Global mocks for Firebase SDK internal access\r\nif (typeof global !== 'undefined') {\r\n  (global as any).firebase = (global as any).firebase || { INTERNAL: mockInternal };\r\n  (global as any).firebaseApp = (global as any).firebaseApp || mockService;\r\n  (global as any)._firebaseApp = (global as any)._firebaseApp || mockService;\r\n  (global as any).firebaseInternalContainer = mockInternal.container;\r\n}\r\n\r\n// US-28.01: Detect build phase more reliably\r\nconst isBuild = typeof window === 'undefined' && \r\n  (process.env.NEXT_PHASE === 'phase-production-build' || process.env.NODE_ENV === 'production');\r\n\r\nlet appInstance: any = null;\r\nlet authInstance: any = null;\r\nlet dbInstance: any = null;\r\nlet storageInstance: any = null;\r\n\r\nfunction initialize() {\r\n  if (isBuild) return;\r\n  if (appInstance) return;\r\n\r\n  try {\r\n    const { initializeApp, getApps } = require('firebase/app');\r\n    const { getAuth } = require('firebase/auth');\r\n    const { initializeFirestore, CACHE_SIZE_UNLIMITED } = require('firebase/firestore');\r\n    const { getStorage } = require('firebase/storage');\r\n\r\n    const apiKey = (process.env.NEXT_PUBLIC_FIREBASE_API_KEY ?? '').trim();\r\n    const firebaseConfig = {\r\n      apiKey,\r\n      authDomain: (process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN ?? '').trim(),\r\n      projectId: (process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID ?? '').trim(),\r\n      storageBucket: (process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET ?? '').trim(),\r\n      messagingSenderId: (process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID ?? '').trim(),\r\n      appId: (process.env.NEXT_PUBLIC_FIREBASE_APP_ID ?? '').trim(),\r\n    };\r\n\r\n    if (apiKey) {\r\n      appInstance = getApps().length === 0 ? initializeApp(firebaseConfig) : getApps()[0];\r\n      if (appInstance && process.env.SKIP_AUTH !== '1') {\r\n        authInstance = getAuth(appInstance);\r\n        dbInstance = initializeFirestore(appInstance, {\r\n          experimentalForceLongPolling: true,\r\n          cacheSizeBytes: CACHE_SIZE_UNLIMITED,\r\n        });\r\n        storageInstance = getStorage(appInstance);\r\n      }\r\n    }\r\n  } catch (e) {\r\n    // Silently fail during build\r\n  }\r\n}\r\n\r\n// Export as getters to ensure they are not evaluated too early and can be mocked\r\nexport const auth = isBuild ? mockService : (initialize(), authInstance || mockService);\r\nexport const db = isBuild ? mockService : (initialize(), dbInstance || mockService);\r\nexport const storage = isBuild ? mockService : (initialize(), storageInstance || mockService);\r\nexport default isBuild ? null : (initialize(), appInstance);\r\n"],"names":[],"mappings":"45CACA,IAAM,EAAe,CACnB,UAAW,CACT,IAAK,IAAM,CAAC,EAAC,CAAC,AAChB,CACF,EAEM,EAAc,CAClB,YAAa,KACb,mBAAoB,IAAM,KAAO,EACjC,QAAS,UAAa,EACtB,OAAQ,IAAM,CAAC,CAAE,UAAW,EAAa,SAAS,CAAC,CAAC,CACpD,IAAK,CAAE,UAAW,EAAa,SAAS,AAAC,EACzC,SAAU,EACV,UAAW,EAAa,SAAS,CACjC,WAAY,IAAM,AAAC,EAAE,IAAK,IAAM,CAAC,CAAE,IAAK,UAAY,AAAC,CAAE,OAAQ,KAAM,EAAM,CAAC,CAAE,CAAC,CAAE,CAAC,CAClF,IAAK,IAAM,CAAC,CAAE,IAAK,UAAY,AAAC,CAAE,OAAQ,KAAM,EAAM,CAAC,CAAE,CAAC,CAC1D,IAAK,IAAM,CAAC,CAAE,IAAK,UAAY,AAAC,EAAC,CAAC,AAAE,CAAC,CACvC,CAIE,CAAA,EAAA,CAAA,CAAgB,QAAQ,CAAG,EAAA,CAAA,CAAgB,QAAQ,EAAI,CAAE,SAAU,CAAa,EAChF,EAAA,CAAA,CAAgB,WAAW,CAAG,EAAA,CAAA,CAAgB,WAAW,EAAI,EAC7D,EAAA,CAAA,CAAgB,YAAY,CAAG,EAAA,CAAA,CAAgB,YAAY,EAAI,EAC/D,EAAA,CAAA,CAAgB,yBAAyB,CAAG,EAAa,SAAS,CAKjE,QAAQ,GAAG,CAAC,UAAU,KAAK,QA6CF,cAAc,AACT,MA9CyB,QA8CX,2CA9CoC,YAAY"}