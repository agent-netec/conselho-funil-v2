module.exports=[193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},814747,(e,t,r)=>{t.exports=e.x("path",()=>require("path"))},224361,(e,t,r)=>{t.exports=e.x("util",()=>require("util"))},605365,(e,t,r)=>{t.exports=e.x("process",()=>require("process"))},446786,(e,t,r)=>{t.exports=e.x("os",()=>require("os"))},254799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},921517,(e,t,r)=>{t.exports=e.x("http",()=>require("http"))},688947,(e,t,r)=>{t.exports=e.x("stream",()=>require("stream"))},522734,(e,t,r)=>{t.exports=e.x("fs",()=>require("fs"))},792509,(e,t,r)=>{t.exports=e.x("url",()=>require("url"))},653137,e=>{"use strict";e.i(564153);var t=e.i(918042);let r={maxRetries:3,initialDelay:1e3,maxDelay:1e4,factor:2},a=["aborted","deadline-exceeded","resource-exhausted","unavailable","internal"];async function s(e,n={}){let i,{maxRetries:o,initialDelay:d,maxDelay:c,factor:u}={...r,...n},l=d;for(let r=0;r<=o;r++)try{return await e()}catch(e){if(i=e,!(e instanceof t.FirestoreError&&a.includes(e.code))||r===o)break;console.warn(`[Resilience] Falha na opera\xe7\xe3o (tentativa ${r+1}/${o+1}). Erro: ${e.code}. Tentando novamente em ${l}ms...`),await new Promise(e=>setTimeout(e,l)),l=Math.min(l*u,c)}throw console.error("[Resilience] Operação falhou permanentemente após retries.",i),i}e.s(["withResilience",()=>s])},813106,e=>{"use strict";e.i(564153);var t=e.i(918042),r=e.i(474065),a=e.i(653137);async function s(e){let a=(0,t.doc)(r.db,"users",e),s=await (0,t.getDoc)(a);return s.exists()?s.data().credits??0:0}async function n(e,a=-1){let s=(0,t.doc)(r.db,"users",e);await (0,t.updateDoc)(s,{credits:(0,t.increment)(a),usage:(0,t.increment)(Math.abs(a))})}async function i(e){let a=(0,t.doc)(r.db,"users",e),s=await (0,t.getDoc)(a);return s.exists()?{id:s.id,...s.data()}:null}async function o(e){let a=(0,t.doc)(r.db,"funnels",e),s=await (0,t.getDoc)(a);return s.exists()?{id:s.id,...s.data()}:null}async function d(e){let a=(0,t.query)((0,t.collection)(r.db,"funnels"),(0,t.where)("userId","==",e));return(await (0,t.getDocs)(a)).docs.map(e=>({id:e.id,...e.data()})).sort((e,t)=>{let r=e.updatedAt?.seconds||0;return(t.updatedAt?.seconds||0)-r})}async function c(e,s){let n=(0,t.doc)(r.db,"funnels",e);await (0,a.withResilience)(async()=>{await (0,t.updateDoc)(n,{...s,updatedAt:t.Timestamp.now()})})}async function u(e,a){return(await (0,t.addDoc)((0,t.collection)(r.db,"funnels",e,"proposals"),{...a,funnelId:e,createdAt:t.Timestamp.now()})).id}async function l(e){let a=(0,t.query)((0,t.collection)(r.db,"funnels",e,"proposals"),(0,t.orderBy)("version","desc"));return(await (0,t.getDocs)(a)).docs.map(e=>({id:e.id,...e.data()}))}async function p(e){let a=(0,t.doc)(r.db,"conversations",e),s=await (0,t.getDoc)(a);return s.exists()?{id:s.id,...s.data()}:null}async function x(e,s){let n=(0,t.doc)(r.db,"conversations",e);await (0,a.withResilience)(async()=>{await (0,t.updateDoc)(n,{...s,updatedAt:t.Timestamp.now()})})}async function m(e,a){let s=await (0,t.addDoc)((0,t.collection)(r.db,"conversations",e,"messages"),{...a,conversationId:e,createdAt:t.Timestamp.now()});return await x(e,{}),s.id}async function w(e){let a=(0,t.doc)(r.db,"brands",e),s=await (0,t.getDoc)(a);return s.exists()?{id:s.id,...s.data()}:null}async function f(e){let a=(0,t.doc)(r.db,"campaigns",e),s=await (0,t.getDoc)(a);return s.exists()?{id:s.id,...s.data()}:null}async function g(e,s){let n=(0,t.doc)(r.db,"campaigns",e);return await (0,a.withResilience)(async()=>{await (0,t.setDoc)(n,{...s,updatedAt:t.Timestamp.now()},{merge:!0})})}e.i(317036),e.s(["addMessage",()=>m,"createProposal",()=>u,"getBrand",()=>w,"getCampaign",()=>f,"getConversation",()=>p,"getFunnel",()=>o,"getFunnelProposals",()=>l,"getUser",()=>i,"getUserCredits",()=>s,"getUserFunnels",()=>d,"updateCampaignManifesto",()=>g,"updateConversation",()=>x,"updateFunnel",()=>c,"updateUserUsage",()=>n])},465660,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__a13a3d25._.js","server/chunks/5c86f_@pinecone-database_pinecone_dist_b1d5c4a9._.js"].map(t=>e.l(t))).then(()=>t(432229)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__de73bfbe._.js.map