(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,661326,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getDefaultsFromPostinstall=()=>void 0},650043,(e,t,r)=>{"use strict";var n=e.i(151495);Object.defineProperty(r,"__esModule",{value:!0});var i=e.r(661326);let s={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},a=function(e,t){if(!e)throw o(t)},o=function(e){return Error("Firebase Database ("+s.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},l=function(e){let t=[],r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:((64512&i)==55296&&n+1<e.length&&(64512&e.charCodeAt(n+1))==56320?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++n)),t[r++]=i>>18|240,t[r++]=i>>12&63|128):t[r++]=i>>12|224,t[r++]=i>>6&63|128),t[r++]=63&i|128)}return t},u=function(e){let t=[],r=0,n=0;for(;r<e.length;){let i=e[r++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){let s=e[r++];t[n++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){let s=((7&i)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536;t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))}else{let s=e[r++],a=e[r++];t[n++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")},c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let t=0;t<e.length;t+=3){let i=e[t],s=t+1<e.length,a=s?e[t+1]:0,o=t+2<e.length,l=o?e[t+2]:0,u=i>>2,c=(3&i)<<4|a>>4,h=(15&a)<<2|l>>6,d=63&l;!o&&(d=64,s||(h=64)),n.push(r[u],r[c],r[h],r[d])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(l(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):u(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let t=0;t<e.length;){let i=r[e.charAt(t++)],s=t<e.length?r[e.charAt(t)]:0,a=++t<e.length?r[e.charAt(t)]:64,o=++t<e.length?r[e.charAt(t)]:64;if(++t,null==i||null==s||null==a||null==o)throw new h;let l=i<<2|s>>4;if(n.push(l),64!==a){let e=s<<4&240|a>>2;if(n.push(e),64!==o){let e=a<<6&192|o;n.push(e)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class h extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let d=function(e){let t=l(e);return c.encodeByteArray(t,!0)},f=function(e){return d(e).replace(/\./g,"")},p=function(e){try{return c.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function m(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(let r in t)t.hasOwnProperty(r)&&"__proto__"!==r&&(e[r]=m(e[r],t[r]));return e}function g(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:e.g}let y=()=>{try{return i.getDefaultsFromPostinstall()||g().__FIREBASE_DEFAULTS__||(()=>{if(void 0===n.default||void 0===n.default.env)return;let e=n.default.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)})()||(()=>{let e;if("undefined"==typeof document)return;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}let t=e&&p(e[1]);return t&&JSON.parse(t)})()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},_=e=>y()?.emulatorHosts?.[e];class v{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,r))}}}function w(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function I(e){return(await fetch(e,{credentials:"include"})).ok}let E={},T=!1;function b(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function A(){let t=y()?.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(e.g.process)}catch(e){return!1}}function S(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}class C extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,C.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,R.prototype.create)}}class R{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){var r,n;let i=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],o=a?(r=a,n=i,r.replace(P,(e,t)=>{let r=n[t];return null!=r?String(r):`<${t}?>`})):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new C(s,l,i)}}let P=/\{\$([^}]+)}/g;function k(e){return JSON.parse(e)}let N=function(e){let t={},r={},n={},i="";try{let s=e.split(".");t=k(p(s[0])||""),r=k(p(s[1])||""),i=s[2],n=r.d||{},delete r.d}catch(e){}return{header:t,claims:r,data:n,signature:i}};function D(e){return null!==e&&"object"==typeof e}class x{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let n;if(void 0===e&&void 0===t&&void 0===r)throw Error("Missing Observer.");void 0===(n=!function(e,t){if("object"!=typeof e||null===e)return!1;for(let r of t)if(r in e&&"function"==typeof e[r])return!0;return!1}(e,["next","error","complete"])?{next:e,error:t,complete:r}:e).next&&(n.next=O),void 0===n.error&&(n.error=O),void 0===n.complete&&(n.complete=O);let i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?n.error(this.finalError):n.complete()}catch(e){}}),this.observers.push(n),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function O(){}function L(e,t){return`${e} failed: ${t} argument `}r.CONSTANTS=s,r.DecodeBase64StringError=h,r.Deferred=v,r.ErrorFactory=R,r.FirebaseError=C,r.MAX_VALUE_MILLIS=144e5,r.RANDOM_FACTOR=.5,r.Sha1=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=0x67452301,this.chain_[1]=0xefcdab89,this.chain_[2]=0x98badcfe,this.chain_[3]=0x10325476,this.chain_[4]=0xc3d2e1f0,this.inbuf_=0,this.total_=0}compress_(e,t){let r,n;t||(t=0);let i=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)i[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)i[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){let t=i[e-3]^i[e-8]^i[e-14]^i[e-16];i[e]=(t<<1|t>>>31)&0xffffffff}let s=this.chain_[0],a=this.chain_[1],o=this.chain_[2],l=this.chain_[3],u=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=l^a&(o^l),n=0x5a827999):(r=a^o^l,n=0x6ed9eba1):e<60?(r=a&o|l&(a|o),n=0x8f1bbcdc):(r=a^o^l,n=0xca62c1d6);let t=(s<<5|s>>>27)+r+u+n+i[e]|0;u=l,l=o,o=(a<<30|a>>>2)&0xffffffff,a=s,s=t}this.chain_[0]=this.chain_[0]+s|0,this.chain_[1]=this.chain_[1]+a|0,this.chain_[2]=this.chain_[2]+o|0,this.chain_[3]=this.chain_[3]+l|0,this.chain_[4]=this.chain_[4]+u|0}update(e,t){if(null==e)return;void 0===t&&(t=e.length);let r=t-this.blockSize,n=0,i=this.buf_,s=this.inbuf_;for(;n<t;){if(0===s)for(;n<=r;)this.compress_(e,n),n+=this.blockSize;if("string"==typeof e){for(;n<t;)if(i[s]=e.charCodeAt(n),++s,++n,s===this.blockSize){this.compress_(i),s=0;break}}else for(;n<t;)if(i[s]=e[n],++s,++n,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){let e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let r=0;for(let t=0;t<5;t++)for(let n=24;n>=0;n-=8)e[r]=this.chain_[t]>>n&255,++r;return e}},r.areCookiesEnabled=function(){return"undefined"!=typeof navigator&&!!navigator.cookieEnabled},r.assert=a,r.assertionError=o,r.async=function(e,t){return(...r)=>{Promise.resolve(!0).then(()=>{e(...r)}).catch(e=>{t&&t(e)})}},r.base64=c,r.base64Decode=p,r.base64Encode=d,r.base64urlEncodeWithoutPadding=f,r.calculateBackoffMillis=function(e,t=1e3,r=2){let n=t*Math.pow(r,e),i=Math.round(.5*n*(Math.random()-.5)*2);return Math.min(144e5,n+i)},r.contains=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.createMockUserToken=function(e,t){if(e.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let r=t||"demo-project",n=e.iat||0,i=e.sub||e.user_id;if(!i)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let s={iss:`https://securetoken.google.com/${r}`,aud:r,iat:n,exp:n+3600,auth_time:n,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...e};return[f(JSON.stringify({alg:"none",type:"JWT"})),f(JSON.stringify(s)),""].join(".")},r.createSubscribe=function(e,t){let r=new x(e,t);return r.subscribe.bind(r)},r.decode=N,r.deepCopy=function(e){return m(void 0,e)},r.deepEqual=function e(t,r){if(t===r)return!0;let n=Object.keys(t),i=Object.keys(r);for(let s of n){if(!i.includes(s))return!1;let n=t[s],a=r[s];if(D(n)&&D(a)){if(!e(n,a))return!1}else if(n!==a)return!1}for(let e of i)if(!n.includes(e))return!1;return!0},r.deepExtend=m,r.errorPrefix=L,r.extractQuerystring=function(e){let t=e.indexOf("?");if(!t)return"";let r=e.indexOf("#",t);return e.substring(t,r>0?r:void 0)},r.getDefaultAppConfig=()=>y()?.config,r.getDefaultEmulatorHost=_,r.getDefaultEmulatorHostnameAndPort=e=>{let t=_(e);if(!t)return;let r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let n=parseInt(t.substring(r+1),10);return"["===t[0]?[t.substring(1,r-1),n]:[t.substring(0,r),n]},r.getDefaults=y,r.getExperimentalSetting=e=>y()?.[`_${e}`],r.getGlobal=g,r.getModularInstance=function(e){return e&&e._delegate?e._delegate:e},r.getUA=b,r.isAdmin=function(e){let t=N(e).claims;return"object"==typeof t&&!0===t.admin},r.isBrowser=function(){return"undefined"!=typeof window||S()},r.isBrowserExtension=function(){let e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id},r.isCloudWorkstation=w,r.isCloudflareWorker=function(){return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent},r.isElectron=function(){return b().indexOf("Electron/")>=0},r.isEmpty=function(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},r.isIE=function(){let e=b();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0},r.isIndexedDBAvailable=function(){try{return"object"==typeof indexedDB}catch(e){return!1}},r.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(b())},r.isNode=A,r.isNodeSdk=function(){return!0===s.NODE_CLIENT||!0===s.NODE_ADMIN},r.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},r.isSafari=function(){return!A()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")},r.isSafariOrWebkit=function(){return!A()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")},r.isUWP=function(){return b().indexOf("MSAppHost/")>=0},r.isValidFormat=function(e){let t=N(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},r.isValidTimestamp=function(e){let t=N(e).claims,r=Math.floor(new Date().getTime()/1e3),n=0,i=0;return"object"==typeof t&&(t.hasOwnProperty("nbf")?n=t.nbf:t.hasOwnProperty("iat")&&(n=t.iat),i=t.hasOwnProperty("exp")?t.exp:n+86400),!!r&&!!n&&!!i&&r>=n&&r<=i},r.isWebWorker=S,r.issuedAtTime=function(e){let t=N(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null},r.jsonEval=k,r.map=function(e,t,r){let n={};for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=t.call(r,e[i],i,e));return n},r.ordinal=function(e){return Number.isFinite(e)?e+function(e){let t=(e=Math.abs(e))%100;if(t>=10&&t<=20)return"th";let r=e%10;return 1===r?"st":2===r?"nd":3===r?"rd":"th"}(e):`${e}`},r.pingServer=I,r.promiseWithTimeout=function(e,t=2e3){let r=new v;return setTimeout(()=>r.reject("timeout!"),t),e.then(r.resolve,r.reject),r.promise},r.querystring=function(e){let t=[];for(let[r,n]of Object.entries(e))Array.isArray(n)?n.forEach(e=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""},r.querystringDecode=function(e){let t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){let[r,n]=e.split("=");t[decodeURIComponent(r)]=decodeURIComponent(n)}}),t},r.safeGet=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},r.stringLength=function(e){let t=0;for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);n<128?t++:n<2048?t+=2:n>=55296&&n<=56319?(t+=4,r++):t+=3}return t},r.stringToByteArray=function(e){let t=[],r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);if(i>=55296&&i<=56319){let t=i-55296;a(++n<e.length,"Surrogate pair missing trail surrogate."),i=65536+(t<<10)+(e.charCodeAt(n)-56320)}i<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:(i<65536?t[r++]=i>>12|224:(t[r++]=i>>18|240,t[r++]=i>>12&63|128),t[r++]=i>>6&63|128),t[r++]=63&i|128)}return t},r.stringify=function(e){return JSON.stringify(e)},r.updateEmulatorBanner=function(e,t){if("undefined"==typeof window||"undefined"==typeof document||!w(window.location.host)||E[e]===t||E[e]||T)return;function r(e){return`__firebase__banner__${e}`}E[e]=t;let n="__firebase__banner",i=function(){let e={prod:[],emulator:[]};for(let t of Object.keys(E))E[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){let e,t,s=(e=document.getElementById(n),t=!1,e||((e=document.createElement("div")).setAttribute("id",n),t=!0),{created:t,element:e}),a=r("text"),o=document.getElementById(a)||document.createElement("span"),l=r("learnmore"),u=document.getElementById(l)||document.createElement("a"),c=r("preprendIcon"),h=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(s.created){let e,t=s.element;t.style.display="flex",t.style.background="#7faaf0",t.style.position="fixed",t.style.bottom="5px",t.style.left="5px",t.style.padding=".5em",t.style.borderRadius="5px",t.style.alignItems="center",u.setAttribute("id",l),u.innerText="Learn more",u.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",u.setAttribute("target","__blank"),u.style.paddingLeft="5px",u.style.textDecoration="underline";let r=((e=document.createElement("span")).style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{let e;T=!0,(e=document.getElementById(n))&&e.remove()},e);h.setAttribute("width","24"),h.setAttribute("id",c),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px",t.append(h,o,u,r),document.body.appendChild(t)}i?(o.innerText="Preview backend disconnected.",h.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(h.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,o.innerText="Preview backend running in this workspace."),o.setAttribute("id",a)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",s):s()},r.validateArgCount=function(e,t,r,n){let i;if(n<t?i="at least "+t:n>r&&(i=0===r?"none":"no more than "+r),i)throw Error(e+" failed: Was called with "+n+(1===n?" argument.":" arguments.")+" Expects "+i+".")},r.validateCallback=function(e,t,r,n){if((!n||r)&&"function"!=typeof r)throw Error(L(e,t)+"must be a valid function.")},r.validateContextObject=function(e,t,r,n){if((!n||r)&&("object"!=typeof r||null===r))throw Error(L(e,t)+"must be a valid context object.")},r.validateIndexedDBOpenable=function(){return new Promise((e,t)=>{try{let r=!0,n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{t(i.error?.message||"")}}catch(e){t(e)}})},r.validateNamespace=function(e,t,r){if((!r||t)&&"string"!=typeof t)throw Error(L(e,"namespace")+"must be a valid firebase namespace.")}},140952,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e.r(650043);let i="[DEFAULT]";class s{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let e=new n.Deferred;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&e.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(e){if(r)return null;throw e}if(r)return null;throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:i})}catch(e){}for(let[e,t]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:r});t.resolve(e)}catch(e){}}}}clearInstance(e=i){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=i){return this.instances.has(e)}getOptions(e=i){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let n=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[e,t]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(e)&&t.resolve(n);return n}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),n=this.onInitCallbacks.get(r)??new Set;n.add(e),this.onInitCallbacks.set(r,n);let i=this.instances.get(r);return i&&e(i,r),()=>{n.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let n of r)try{n(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){var r;let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e)===i?void 0:r,options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=i){return this.component?this.component.multipleInstances?e:i:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}r.Component=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}},r.ComponentContainer=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new s(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}},r.Provider=s},601402,(e,t,r)=>{"use strict";var n;Object.defineProperty(r,"__esModule",{value:!0});let i=[];r.LogLevel=void 0,(n=r.LogLevel||(r.LogLevel={}))[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT";let s={debug:r.LogLevel.DEBUG,verbose:r.LogLevel.VERBOSE,info:r.LogLevel.INFO,warn:r.LogLevel.WARN,error:r.LogLevel.ERROR,silent:r.LogLevel.SILENT},a=r.LogLevel.INFO,o={[r.LogLevel.DEBUG]:"log",[r.LogLevel.VERBOSE]:"log",[r.LogLevel.INFO]:"info",[r.LogLevel.WARN]:"warn",[r.LogLevel.ERROR]:"error"},l=(e,t,...r)=>{if(t<e.logLevel)return;let n=new Date().toISOString(),i=o[t];if(i)console[i](`[${n}]  ${e.name}:`,...r);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)};r.Logger=class{constructor(e){this.name=e,this._logLevel=a,this._logHandler=l,this._userLogHandler=null,i.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in r.LogLevel))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?s[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,r.LogLevel.DEBUG,...e),this._logHandler(this,r.LogLevel.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,r.LogLevel.VERBOSE,...e),this._logHandler(this,r.LogLevel.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,r.LogLevel.INFO,...e),this._logHandler(this,r.LogLevel.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,r.LogLevel.WARN,...e),this._logHandler(this,r.LogLevel.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,r.LogLevel.ERROR,...e),this._logHandler(this,r.LogLevel.ERROR,...e)}},r.setLogLevel=function(e){i.forEach(t=>{t.setLogLevel(e)})},r.setUserLogHandler=function(e,t){for(let n of i){let i=null;t&&t.level&&(i=s[t.level]),null===e?n.userLogHandler=null:n.userLogHandler=(t,n,...s)=>{let a=s.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}}).filter(e=>e).join(" ");n>=(i??t.logLevel)&&e({level:r.LogLevel[n].toLowerCase(),message:a,args:s,type:t.name})}}}},795800,e=>{"use strict";var t=e.i(953945),r=e.i(690593);e.s(["deleteDB",()=>t.deleteDB,"openDB",()=>t.openDB,"unwrap",()=>r.u,"wrap",()=>r.w])},336952,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e.r(140952),i=e.r(601402),s=e.r(650043),a=e.r(795800);class o{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{let t;if(t=e.getComponent(),t?.type!=="VERSION")return null;{let t=e.getImmediate();return`${t.library}/${t.version}`}}).filter(e=>e).join(" ")}}let l="@firebase/app",u="0.14.7",c=new i.Logger("@firebase/app"),h="[DEFAULT]",d={[l]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/ai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},f=new Map,p=new Map,m=new Map;function g(e,t){try{e.container.addComponent(t)}catch(r){c.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function y(e){let t=e.name;if(m.has(t))return c.debug(`There were multiple attempts to register component ${t}.`),!1;for(let r of(m.set(t,e),f.values()))g(r,e);for(let t of p.values())g(t,e);return!0}function _(e,t){let r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function v(e){return void 0!==e.options}function w(e){return!v(e)&&("authIdToken"in e||"appCheckToken"in e||"releaseOnDeref"in e||"automaticDataCollectionEnabled"in e)}let I=new s.ErrorFactory("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class E{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new n.Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw I.create("app-deleted",{appName:this._name})}}function T(e,t){let r=s.base64Decode(e.split(".")[1]);null===r?console.error(`FirebaseServerApp ${t} is invalid: second part could not be parsed.`):void 0===JSON.parse(r).exp?console.error(`FirebaseServerApp ${t} is invalid: expiration claim could not be parsed`):1e3*JSON.parse(r).exp-new Date().getTime()<=0&&console.error(`FirebaseServerApp ${t} is invalid: the token has expired.`)}class b extends E{constructor(e,t,r,n){const i=void 0===t.automaticDataCollectionEnabled||t.automaticDataCollectionEnabled,s={name:r,automaticDataCollectionEnabled:i};void 0!==e.apiKey?super(e,s,n):super(e.options,s,n),this._serverConfig={automaticDataCollectionEnabled:i,...t},this._serverConfig.authIdToken&&T(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&T(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,"undefined"!=typeof FinalizationRegistry&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,C(l,u,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,void 0!==e&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){S(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw I.create("server-app-deleted")}}function A(e,t={}){let r=e;"object"!=typeof t&&(t={name:t});let i={name:h,automaticDataCollectionEnabled:!0,...t},a=i.name;if("string"!=typeof a||!a)throw I.create("bad-app-name",{appName:String(a)});if(r||(r=s.getDefaultAppConfig()),!r)throw I.create("no-options");let o=f.get(a);if(o)if(s.deepEqual(r,o.options)&&s.deepEqual(i,o.config))return o;else throw I.create("duplicate-app",{appName:a});let l=new n.ComponentContainer(a);for(let e of m.values())l.addComponent(e);let u=new E(r,i,l);return f.set(a,u),u}async function S(e){let t=!1,r=e.name;f.has(r)?(t=!0,f.delete(r)):p.has(r)&&0>=e.decRefCount()&&(p.delete(r),t=!0),t&&(await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function C(e,t,r){let i=d[e]??e;r&&(i+=`-${r}`);let s=i.match(/\s|\//),a=t.match(/\s|\//);if(s||a){let e=[`Unable to register library "${i}" with version "${t}":`];s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),c.warn(e.join(" "));return}y(new n.Component(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}let R="firebase-heartbeat-store",P=null;function k(){return P||(P=a.openDB("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(R)}catch(e){console.warn(e)}}}).catch(e=>{throw I.create("idb-open",{originalErrorMessage:e.message})})),P}async function N(e){try{let t=(await k()).transaction(R),r=await t.objectStore(R).get(x(e));return await t.done,r}catch(e){if(e instanceof s.FirebaseError)c.warn(e.message);else{let t=I.create("idb-get",{originalErrorMessage:e?.message});c.warn(t.message)}}}async function D(e,t){try{let r=(await k()).transaction(R,"readwrite"),n=r.objectStore(R);await n.put(t,x(e)),await r.done}catch(e){if(e instanceof s.FirebaseError)c.warn(e.message);else{let t=I.create("idb-set",{originalErrorMessage:e?.message});c.warn(t.message)}}}function x(e){return`${e.name}!${e.options.appId}`}class O{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new M(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{let e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=L();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some(e=>e.date===t))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>30){let e=function(e){if(0===e.length)return -1;let t=0,r=e[0].date;for(let n=1;n<e.length;n++)e[n].date<r&&(r=e[n].date,t=n);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){c.warn(e)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||0===this._heartbeatsCache.heartbeats.length)return"";let e=L(),{heartbeatsToSend:t,unsentEntries:r}=function(e,t=1024){let r=[],n=e.slice();for(let i of e){let e=r.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),V(r)>t){e.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),V(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}(this._heartbeatsCache.heartbeats),n=s.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),n}catch(e){return c.warn(e),""}}}function L(){return new Date().toISOString().substring(0,10)}class M{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!s.isIndexedDBAvailable()&&s.validateIndexedDBOpenable().then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let e=await N(this.app);return e?.heartbeats?e:{heartbeats:[]}}}async overwrite(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return D(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return D(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}}}function V(e){return s.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:e})).length}y(new n.Component("platform-logger",e=>new o(e),"PRIVATE")),y(new n.Component("heartbeat",e=>new O(e),"PRIVATE")),C(l,u,"node"),C(l,u,"cjs2020"),C("fire-js",""),Object.defineProperty(r,"FirebaseError",{enumerable:!0,get:function(){return s.FirebaseError}}),r.SDK_VERSION="12.8.0",r._DEFAULT_ENTRY_NAME=h,r._addComponent=g,r._addOrOverwriteComponent=function(e,t){e.container.addOrOverwriteComponent(t)},r._apps=f,r._clearComponents=function(){m.clear()},r._components=m,r._getProvider=_,r._isFirebaseApp=v,r._isFirebaseServerApp=function(e){return null!=e&&void 0!==e.settings},r._isFirebaseServerAppSettings=w,r._registerComponent=y,r._removeServiceInstance=function(e,t,r=h){_(e,t).clearInstance(r)},r._serverApps=p,r.deleteApp=S,r.getApp=function(e=h){let t=f.get(e);if(!t&&e===h&&s.getDefaultAppConfig())return A();if(!t)throw I.create("no-app",{appName:e});return t},r.getApps=function(){return Array.from(f.values())},r.initializeApp=A,r.initializeServerApp=function(e,t={}){let r;if(s.isBrowser()&&!s.isWebWorker())throw I.create("invalid-server-app-environment");let i=t||{};if(e&&(v(e)?r=e.options:w(e)?i=e:r=e),void 0===i.automaticDataCollectionEnabled&&(i.automaticDataCollectionEnabled=!0),r||(r=s.getDefaultAppConfig()),!r)throw I.create("no-options");let a={...i,...r};if(void 0!==a.releaseOnDeref&&delete a.releaseOnDeref,void 0!==i.releaseOnDeref&&"undefined"==typeof FinalizationRegistry)throw I.create("finalization-registry-not-supported",{});let o=""+[...JSON.stringify(a)].reduce((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0,0),l=p.get(o);if(l)return l.incRefCount(i.releaseOnDeref),l;let u=new n.ComponentContainer(o);for(let e of m.values())u.addComponent(e);let c=new b(r,i,o,u);return p.set(o,c),c},r.onLog=function(e,t){if(null!==e&&"function"!=typeof e)throw I.create("invalid-log-argument");i.setUserLogHandler(e,t)},r.registerVersion=C,r.setLogLevel=function(e){i.setLogLevel(e)}},934168,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e.r(336952);n.registerVersion("firebase","12.8.0","app"),Object.keys(n).forEach(function(e){"default"===e||r.hasOwnProperty(e)||Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}})})},62328,(e,t,r)=>{"use strict";var n,i=e.r(336952),s=e.r(650043),a=e.r(601402),o=e.r(140952);function l(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}let u=new s.ErrorFactory("auth","Firebase",l()),c=new a.Logger("@firebase/auth");function h(e,...t){c.logLevel<=a.LogLevel.ERROR&&c.error(`Auth (${i.SDK_VERSION}): ${e}`,...t)}function d(e,...t){throw y(e,...t)}function f(e,...t){return y(e,...t)}function p(e,t,r){let n={...l(),[t]:r};return new s.ErrorFactory("auth","Firebase",n).create(t,{appName:e.name})}function m(e){return p(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function g(e,t,r){if(!(t instanceof r))throw r.name!==t.constructor.name&&d(e,"argument-error"),p(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function y(e,...t){if("string"!=typeof e){let r=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(r,...n)}return u.create(e,...t)}function _(e,t,...r){if(!e)throw y(t,...r)}function v(e){let t="INTERNAL ASSERTION FAILED: "+e;throw h(t),Error(t)}function w(e,t){e||v(t)}function I(){return"undefined"!=typeof self&&self.location?.href||""}function E(){return"http:"===T()||"https:"===T()}function T(){return"undefined"!=typeof self&&self.location?.protocol||null}class b{constructor(e,t){this.shortDelay=e,this.longDelay=t,w(t>e,"Short delay should be less than long delay!"),this.isMobile=s.isMobileCordova()||s.isReactNative()}get(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(E()||s.isBrowserExtension()||"connection"in navigator))||navigator.onLine?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function A(e,t){w(e.emulator,"Emulator should always be set here");let{url:r}=e.emulator;return t?`${r}${t.startsWith("/")?t.slice(1):t}`:r}class S{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void v("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void v("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void v("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}let C={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},R=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],P=new b(3e4,6e4);function k(e,t){return e.tenantId&&!t.tenantId?{...t,tenantId:e.tenantId}:t}async function N(e,t,r,n,i={}){return D(e,i,async()=>{let i={},a={};n&&("GET"===t?a=n:i={body:JSON.stringify(n)});let o=s.querystring({key:e.config.apiKey,...a}).slice(1),l=await e._getAdditionalHeaders();l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode);let u={method:t,headers:l,...i};return s.isCloudflareWorker()||(u.referrerPolicy="no-referrer"),e.emulatorConfig&&s.isCloudWorkstation(e.emulatorConfig.host)&&(u.credentials="include"),S.fetch()(await O(e,e.config.apiHost,r,o),u)})}async function D(e,t,r){e._canInitEmulator=!1;let n={...C,...t};try{let t=new L(e),i=await Promise.race([r(),t.promise]);t.clearNetworkTimeout();let s=await i.json();if("needConfirmation"in s)throw M(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{let[t,r]=(i.ok?s.errorMessage:s.error.message).split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===t)throw M(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===t)throw M(e,"email-already-in-use",s);if("USER_DISABLED"===t)throw M(e,"user-disabled",s);let a=n[t]||t.toLowerCase().replace(/[_\s]+/g,"-");if(r)throw p(e,a,r);d(e,a)}}catch(t){if(t instanceof s.FirebaseError)throw t;d(e,"network-request-failed",{message:String(t)})}}async function x(e,t,r,n,i={}){let s=await N(e,t,r,n,i);return"mfaPendingCredential"in s&&d(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function O(e,t,r,n){let i=`${t}${r}?${n}`,s=e.config.emulator?A(e.config,i):`${e.config.apiScheme}://${i}`;return R.includes(r)&&(await e._persistenceManagerAvailable,"COOKIE"===e._getPersistenceType())?e._getPersistence()._getFinalTarget(s).toString():s}class L{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(f(this.auth,"network-request-failed")),P.get())})}}function M(e,t,r){let n={appName:e.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);let i=f(e,t,n);return i.customData._tokenResponse=r,i}function V(e){return void 0!==e&&void 0!==e.getResponse}function F(e){return void 0!==e&&void 0!==e.enterprise}class U{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)switch(t.enforcementState){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function q(e){return(await N(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function B(e,t){return N(e,"GET","/v2/recaptchaConfig",k(e,t))}async function j(e,t){return N(e,"POST","/v1/accounts:delete",t)}async function z(e,t){return N(e,"POST","/v1/accounts:update",t)}async function G(e,t){return N(e,"POST","/v1/accounts:lookup",t)}function $(e){if(e)try{let t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}async function H(e,t=!1){let r=s.getModularInstance(e),n=await r.getIdToken(t),i=W(n);_(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");let a="object"==typeof i.firebase?i.firebase:void 0,o=a?.sign_in_provider;return{claims:i,token:n,authTime:$(K(i.auth_time)),issuedAtTime:$(K(i.iat)),expirationTime:$(K(i.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function K(e){return 1e3*Number(e)}function W(e){let[t,r,n]=e.split(".");if(void 0===t||void 0===r||void 0===n)return h("JWT malformed, contained fewer than 3 sections"),null;try{let e=s.base64Decode(r);if(!e)return h("Failed to decode base64 JWT payload"),null;return JSON.parse(e)}catch(e){return h("Caught error parsing JWT payload as JSON",e?.toString()),null}}function Q(e){let t=W(e);return _(t,"internal-error"),_(void 0!==t.exp,"internal-error"),_(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function J(e,t,r=!1){if(r)return t;try{return await t}catch(t){throw t instanceof s.FirebaseError&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class Y{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(!e)return this.errorBackoff=3e4,Math.max(0,(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5);{let e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class X{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=$(this.lastLoginAt),this.creationTime=$(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Z(e){var t,r;let n=e.auth,i=await e.getIdToken(),s=await J(e,G(n,{idToken:i}));_(s?.users.length,n,"internal-error");let a=s.users[0];e._notifyReloadListener(a);let o=a.providerUserInfo?.length?et(a.providerUserInfo):[],l=(t=e.providerData,r=o,[...t.filter(e=>!r.some(t=>t.providerId===e.providerId)),...r]),u=e.isAnonymous,c=!(e.email&&a.passwordHash)&&!l?.length;Object.assign(e,{uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new X(a.createdAt,a.lastLoginAt),isAnonymous:!!u&&c})}async function ee(e){let t=s.getModularInstance(e);await Z(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function et(e){return e.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function er(e,t){let r=await D(e,{},async()=>{let r=s.querystring({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:n,apiKey:i}=e.config,a=await O(e,n,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";let l={method:"POST",headers:o,body:r};return e.emulatorConfig&&s.isCloudWorkstation(e.emulatorConfig.host)&&(l.credentials="include"),S.fetch()(a,l)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function en(e,t){return N(e,"POST","/v2/accounts:revokeToken",k(e,t))}class ei{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_(e.idToken,"internal-error"),_(void 0!==e.idToken,"internal-error"),_(void 0!==e.refreshToken,"internal-error");let t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):Q(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){_(0!==e.length,"internal-error");let t=Q(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(_(this.refreshToken,e,"user-token-expired"),this.refreshToken)?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:n,expiresIn:i}=await er(e,t);this.updateTokensAndExpiration(r,n,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(e,t){let{refreshToken:r,accessToken:n,expirationTime:i}=t,s=new ei;return r&&(_("string"==typeof r,"internal-error",{appName:e}),s.refreshToken=r),n&&(_("string"==typeof n,"internal-error",{appName:e}),s.accessToken=n),i&&(_("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ei,this.toJSON())}_performRefresh(){return v("not implemented")}}function es(e,t){_("string"==typeof e||void 0===e,"internal-error",{appName:t})}class ea{constructor({uid:e,auth:t,stsTokenManager:r,...n}){this.providerId="firebase",this.proactiveRefresh=new Y(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=n.displayName||null,this.email=n.email||null,this.emailVerified=n.emailVerified||!1,this.phoneNumber=n.phoneNumber||null,this.photoURL=n.photoURL||null,this.isAnonymous=n.isAnonymous||!1,this.tenantId=n.tenantId||null,this.providerData=n.providerData?[...n.providerData]:[],this.metadata=new X(n.createdAt||void 0,n.lastLoginAt||void 0)}async getIdToken(e){let t=await J(this,this.stsTokenManager.getToken(this.auth,e));return _(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return H(this,e)}reload(){return ee(this)}_assign(e){this!==e&&(_(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>({...e})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new ea({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){_(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Z(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(i._isFirebaseServerApp(this.auth.app))return Promise.reject(m(this.auth));let e=await this.getIdToken();return await J(this,j(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let r=t.displayName??void 0,n=t.email??void 0,i=t.phoneNumber??void 0,s=t.photoURL??void 0,a=t.tenantId??void 0,o=t._redirectEventId??void 0,l=t.createdAt??void 0,u=t.lastLoginAt??void 0,{uid:c,emailVerified:h,isAnonymous:d,providerData:f,stsTokenManager:p}=t;_(c&&p,e,"internal-error");let m=ei.fromJSON(this.name,p);_("string"==typeof c,e,"internal-error"),es(r,e.name),es(n,e.name),_("boolean"==typeof h,e,"internal-error"),_("boolean"==typeof d,e,"internal-error"),es(i,e.name),es(s,e.name),es(a,e.name),es(o,e.name),es(l,e.name),es(u,e.name);let g=new ea({uid:c,auth:e,email:n,emailVerified:h,displayName:r,isAnonymous:d,photoURL:s,phoneNumber:i,tenantId:a,stsTokenManager:m,createdAt:l,lastLoginAt:u});return f&&Array.isArray(f)&&(g.providerData=f.map(e=>({...e}))),o&&(g._redirectEventId=o),g}static async _fromIdTokenResponse(e,t,r=!1){let n=new ei;n.updateFromServerResponse(t);let i=new ea({uid:t.localId,auth:e,stsTokenManager:n,isAnonymous:r});return await Z(i),i}static async _fromGetAccountInfoResponse(e,t,r){let n=t.users[0];_(void 0!==n.localId,"internal-error");let i=void 0!==n.providerUserInfo?et(n.providerUserInfo):[],s=!(n.email&&n.passwordHash)&&!i?.length,a=new ei;a.updateFromIdToken(r);let o=new ea({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:s});return Object.assign(o,{uid:n.localId,displayName:n.displayName||null,photoURL:n.photoUrl||null,email:n.email||null,emailVerified:n.emailVerified||!1,phoneNumber:n.phoneNumber||null,tenantId:n.tenantId||null,providerData:i,metadata:new X(n.createdAt,n.lastLoginAt),isAnonymous:!(n.email&&n.passwordHash)&&!i?.length}),o}}let eo=new Map;function el(e){w(e instanceof Function,"Expected a class definition");let t=eo.get(e);return t?w(t instanceof e,"Instance stored in cache mismatched with class"):(t=new e,eo.set(e,t)),t}class eu{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){let t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}function ec(e,t,r){return`firebase:${e}:${t}:${r}`}eu.type="NONE";class eh{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:n,name:i}=this.auth;this.fullUserKey=ec(this.userKey,n.apiKey,i),this.fullPersistenceKey=ec("persistence",n.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){let t=await G(this.auth,{idToken:e}).catch(()=>void 0);return t?ea._fromGetAccountInfoResponse(this.auth,t,e):null}return ea._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new eh(el(eu),e,r);let n=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e),i=n[0]||el(eu),s=ec(r,e.config.apiKey,e.name),a=null;for(let r of t)try{let t=await r._get(s);if(t){let n;if("string"==typeof t){let r=await G(e,{idToken:t}).catch(()=>void 0);if(!r)break;n=await ea._fromGetAccountInfoResponse(e,r,t)}else n=ea._fromJSON(e,t);r!==i&&(a=n),i=r;break}}catch{}let o=n.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&o.length&&(i=o[0],a&&await i._set(s,a.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch{}}))),new eh(i,e,r)}}function ed(e){let t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";{if(eg(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(ef(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(e_(t))return"Blackberry";if(ev(t))return"Webos";if(ep(t))return"Safari";if((t.includes("chrome/")||em(t))&&!t.includes("edge/"))return"Chrome";if(ey(t))return"Android";let r=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(r?.length===2)return r[1]}return"Other"}function ef(e=s.getUA()){return/firefox\//i.test(e)}function ep(e=s.getUA()){let t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function em(e=s.getUA()){return/crios\//i.test(e)}function eg(e=s.getUA()){return/iemobile/i.test(e)}function ey(e=s.getUA()){return/android/i.test(e)}function e_(e=s.getUA()){return/blackberry/i.test(e)}function ev(e=s.getUA()){return/webos/i.test(e)}function ew(e=s.getUA()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function eI(e=s.getUA()){return ew(e)||ey(e)||ev(e)||e_(e)||/windows phone/i.test(e)||eg(e)}function eE(e,t=[]){let r;switch(e){case"Browser":r=ed(s.getUA());break;case"Worker":r=`${ed(s.getUA())}-${e}`;break;default:r=e}let n=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${i.SDK_VERSION}/${n}`}class eT{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=t=>new Promise((r,n)=>{try{let n=e(t);r(n)}catch(e){n(e)}});r.onAbort=t,this.queue.push(r);let n=this.queue.length-1;return()=>{this.queue[n]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(e){for(let e of(t.reverse(),t))try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:e?.message})}}}async function eb(e,t={}){return N(e,"GET","/v2/passwordPolicy",k(e,t))}class eA{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??6,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),void 0!==t.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),void 0!==t.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),void 0!==t.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),void 0!==t.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,n=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),n&&(t.meetsMaxPasswordLength=e.length<=n)}validatePasswordCharacterOptions(e,t){let r;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let n=0;n<e.length;n++)r=e.charAt(n),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,n,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=n)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class eS{constructor(e,t,r,n){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new eR(this),this.idTokenSubscription=new eR(this),this.beforeStateQueue=new eT(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=u,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=el(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted){if(this.persistenceManager=await eh.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted||(this._isInitialized=!0)}}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(this.currentUser||e){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await G(this,{idToken:e}),r=await ea._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(i._isFirebaseServerApp(this.app)){let e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),r=t,n=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let t=this.redirectUser?._redirectEventId,i=r?._redirectEventId,s=await this.tryRedirectSignIn(e);(!t||t===i)&&s?.user&&(r=s.user,n=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(n)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(e))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return(_(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId)?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Z(e)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;let e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(i._isFirebaseServerApp(this.app))return Promise.reject(m(this));let t=e?s.getModularInstance(e):null;return t&&_(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&_(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return i._isFirebaseServerApp(this.app)?Promise.reject(m(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return i._isFirebaseServerApp(this.app)?Promise.reject(m(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(el(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=new eA(await eb(this));null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new s.ErrorFactory("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await en(this,t)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return null===e?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&el(e)||this._popupRedirectResolver;_(t,this,"argument-error"),this.redirectPersistenceManager=await eh.create(this,[el(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return(this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e)?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,n){if(this._deleted)return()=>{};let i="function"==typeof t?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(_(a,this,"internal-error"),a.then(()=>{s||i(this.currentUser)}),"function"==typeof t){let i=e.addObserver(t,r,n);return()=>{s=!0,i()}}{let r=e.addObserver(t);return()=>{s=!0,r()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=eE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(i._isFirebaseServerApp(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&function(e,...t){c.logLevel<=a.LogLevel.WARN&&c.warn(`Auth (${i.SDK_VERSION}): ${e}`,...t)}(`Error while retrieving App Check token: ${e.error}`),e?.token}}function eC(e){return s.getModularInstance(e)}class eR{constructor(e){this.auth=e,this.observer=null,this.addObserver=s.createSubscribe(e=>this.observer=e)}get next(){return _(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let eP={async loadJS(){throw Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ek(e){return eP.loadJS(e)}function eN(e){return`__${e}${Math.floor(1e6*Math.random())}`}class eD{constructor(e){this.auth=e,this.counter=1e12,this._widgets=new Map}render(e,t){let r=this.counter;return this._widgets.set(r,new eL(e,this.auth.name,t||{})),this.counter++,r}reset(e){let t=e||1e12;this._widgets.get(t)?.delete(),this._widgets.delete(t)}getResponse(e){return this._widgets.get(e||1e12)?.getResponse()||""}async execute(e){return this._widgets.get(e||1e12)?.execute(),""}}class ex{constructor(){this.enterprise=new eO}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class eO{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class eL{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const n="string"==typeof e?document.getElementById(e):e;_(n,"argument-error",{appName:t}),this.container=n,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout(()=>{this.responseToken=function(e){let t=[],r="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let e=0;e<50;e++)t.push(r.charAt(Math.floor(Math.random()*r.length)));return t.join("")}(50);let{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(e){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(e){}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw Error("reCAPTCHA mock was already deleted!")}}let eM="NO_RECAPTCHA";class eV{constructor(e){this.type="recaptcha-enterprise",this.auth=eC(e)}async verify(e="verify",t=!1){async function r(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,r)=>{B(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(n=>{if(void 0===n.recaptchaKey)r(Error("recaptcha Enterprise site key undefined"));else{let r=new U(n);return null==e.tenantId?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,t(r.siteKey)}}).catch(e=>{r(e)})})}function n(t,r,n){let i=window.grecaptcha;F(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{r(e)}).catch(()=>{r(eM)})}):n(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new ex().execute("siteKey",{action:"verify"}):new Promise((e,i)=>{r(this.auth).then(r=>{if(!t&&F(window.grecaptcha))n(r,e,i);else{if("undefined"==typeof window)return void i(Error("RecaptchaVerifier is only supported in browser"));let t=eP.recaptchaEnterpriseScript;0!==t.length&&(t+=r),ek(t).then(()=>{n(r,e,i)}).catch(e=>{i(e)})}}).catch(e=>{i(e)})})}}async function eF(e,t,r,n=!1,i=!1){let s,a=new eV(e);if(i)s=eM;else try{s=await a.verify(r)}catch(e){s=await a.verify(r,!0)}let o={...t};if("mfaSmsEnrollment"===r||"mfaSmsSignIn"===r){if("phoneEnrollmentInfo"in o){let e=o.phoneEnrollmentInfo.phoneNumber,t=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){let e=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function eU(e,t,r,n,i){if("EMAIL_PASSWORD_PROVIDER"===i)if(!e._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))return n(e,t).catch(async i=>{if("auth/missing-recaptcha-token"!==i.code)return Promise.reject(i);{console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let i=await eF(e,t,r,"getOobCode"===r);return n(e,i)}});else{let i=await eF(e,t,r,"getOobCode"===r);return n(e,i)}if("PHONE_PROVIDER"!==i)return Promise.reject(i+" provider is not supported.");if(e._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){let i=await eF(e,t,r);return n(e,i).catch(async i=>{if(e._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&("auth/missing-recaptcha-token"===i.code||"auth/invalid-app-credential"===i.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${r} flow.`);let i=await eF(e,t,r,!1,!0);return n(e,i)}return Promise.reject(i)})}{let i=await eF(e,t,r,!1,!0);return n(e,i)}}async function eq(e){let t=eC(e),r=new U(await B(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}));null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()&&new eV(t).verify()}function eB(e,t){let r=i._getProvider(e,"auth");if(r.isInitialized()){let e=r.getImmediate(),n=r.getOptions();if(s.deepEqual(n,t??{}))return e;d(e,"already-initialized")}return r.initialize({options:t})}function ej(e,t,r){let n=eC(e);_(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");let i=!!r?.disableWarnings,a=ez(t),{host:o,port:l}=function(e){let t=ez(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};let n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){let e=i[1];return{host:e,port:eG(n.substr(e.length+1))}}{let[e,t]=n.split(":");return{host:e,port:eG(t)}}}(t),u=null===l?"":`:${l}`,c={url:`${a}//${o}${u}/`},h=Object.freeze({host:o,port:l,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){_(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),_(s.deepEqual(c,n.config.emulator)&&s.deepEqual(h,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=c,n.emulatorConfig=h,n.settings.appVerificationDisabledForTesting=!0,s.isCloudWorkstation(o)?(s.pingServer(`${a}//${o}${u}`),s.updateEmulatorBanner("Auth",!0)):i||function(){function e(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function ez(e){let t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function eG(e){if(!e)return null;let t=Number(e);return isNaN(t)?null:t}class e${constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return v("not implemented")}_getIdTokenResponse(e){return v("not implemented")}_linkToIdToken(e,t){return v("not implemented")}_getReauthenticationResolver(e){return v("not implemented")}}async function eH(e,t){return N(e,"POST","/v1/accounts:resetPassword",k(e,t))}async function eK(e,t){return N(e,"POST","/v1/accounts:update",t)}async function eW(e,t){return N(e,"POST","/v1/accounts:signUp",t)}async function eQ(e,t){return N(e,"POST","/v1/accounts:update",k(e,t))}async function eJ(e,t){return x(e,"POST","/v1/accounts:signInWithPassword",k(e,t))}async function eY(e,t){return N(e,"POST","/v1/accounts:sendOobCode",k(e,t))}async function eX(e,t){return eY(e,t)}async function eZ(e,t){return eY(e,t)}async function e0(e,t){return eY(e,t)}async function e1(e,t){return eY(e,t)}async function e2(e,t){return x(e,"POST","/v1/accounts:signInWithEmailLink",k(e,t))}async function e6(e,t){return x(e,"POST","/v1/accounts:signInWithEmailLink",k(e,t))}class e3 extends e${constructor(e,t,r,n=null){super("password",r),this._email=e,this._password=t,this._tenantId=n}static _fromEmailAndPassword(e,t){return new e3(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new e3(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t="string"==typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);else if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return eU(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",eJ,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return e2(e,{email:this._email,oobCode:this._password});default:d(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return eU(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",eW,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return e6(e,{idToken:t,email:this._email,oobCode:this._password});default:d(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function e4(e,t){return x(e,"POST","/v1/accounts:signInWithIdp",k(e,t))}class e5 extends e${constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new e5(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):d("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let{providerId:t,signInMethod:r,...n}="string"==typeof e?JSON.parse(e):e;if(!t||!r)return null;let i=new e5(t,r);return i.idToken=n.idToken||void 0,i.accessToken=n.accessToken||void 0,i.secret=n.secret,i.nonce=n.nonce,i.pendingToken=n.pendingToken||null,i}_getIdTokenResponse(e){return e4(e,this.buildRequest())}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,e4(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,e4(e,t)}buildRequest(){let e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=s.querystring(t)}return e}}async function e8(e,t){return N(e,"POST","/v1/accounts:sendVerificationCode",k(e,t))}async function e7(e,t){return x(e,"POST","/v1/accounts:signInWithPhoneNumber",k(e,t))}async function e9(e,t){let r=await x(e,"POST","/v1/accounts:signInWithPhoneNumber",k(e,t));if(r.temporaryProof)throw M(e,"account-exists-with-different-credential",r);return r}let te={USER_NOT_FOUND:"user-not-found"};async function tt(e,t){return x(e,"POST","/v1/accounts:signInWithPhoneNumber",k(e,{...t,operation:"REAUTH"}),te)}class tr extends e${constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new tr({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new tr({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return e7(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return e9(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return tt(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:n}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:n}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:n,temporaryProof:i}=e;return r||t||n||i?new tr({verificationId:t,verificationCode:r,phoneNumber:n,temporaryProof:i}):null}}class tn{constructor(e){const t=s.querystringDecode(s.extractQuerystring(e)),r=t.apiKey??null,n=t.oobCode??null,i=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(t.mode??null);_(r&&n&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=n,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){let t,r,n,i=(r=(t=s.querystringDecode(s.extractQuerystring(e)).link)?s.querystringDecode(s.extractQuerystring(t)).deep_link_id:null,((n=s.querystringDecode(s.extractQuerystring(e)).deep_link_id)?s.querystringDecode(s.extractQuerystring(n)).link:null)||n||r||t||e);try{return new tn(i)}catch{return null}}}class ti{constructor(){this.providerId=ti.PROVIDER_ID}static credential(e,t){return e3._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){let r=tn.parseLink(t);return _(r,"argument-error"),e3._fromEmailAndCode(e,r.code,r.tenantId)}}ti.PROVIDER_ID="password",ti.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ti.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ts{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ta extends ts{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class to extends ta{static credentialFromJSON(e){let t="string"==typeof e?JSON.parse(e):e;return _("providerId"in t&&"signInMethod"in t,"argument-error"),e5._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return _(e.idToken||e.accessToken,"argument-error"),e5._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return to.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return to.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:n,pendingToken:i,nonce:s,providerId:a}=e;if(!r&&!n&&!t&&!i||!a)return null;try{return new to(a)._credential({idToken:t,accessToken:r,nonce:s,pendingToken:i})}catch(e){return null}}}class tl extends ta{constructor(){super("facebook.com")}static credential(e){return e5._fromParams({providerId:tl.PROVIDER_ID,signInMethod:tl.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return tl.credentialFromTaggedObject(e)}static credentialFromError(e){return tl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return tl.credential(e.oauthAccessToken)}catch{return null}}}tl.FACEBOOK_SIGN_IN_METHOD="facebook.com",tl.PROVIDER_ID="facebook.com";class tu extends ta{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return e5._fromParams({providerId:tu.PROVIDER_ID,signInMethod:tu.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return tu.credentialFromTaggedObject(e)}static credentialFromError(e){return tu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return tu.credential(t,r)}catch{return null}}}tu.GOOGLE_SIGN_IN_METHOD="google.com",tu.PROVIDER_ID="google.com";class tc extends ta{constructor(){super("github.com")}static credential(e){return e5._fromParams({providerId:tc.PROVIDER_ID,signInMethod:tc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return tc.credentialFromTaggedObject(e)}static credentialFromError(e){return tc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return tc.credential(e.oauthAccessToken)}catch{return null}}}tc.GITHUB_SIGN_IN_METHOD="github.com",tc.PROVIDER_ID="github.com";class th extends e${constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return e4(e,this.buildRequest())}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,e4(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,e4(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){let{providerId:t,signInMethod:r,pendingToken:n}="string"==typeof e?JSON.parse(e):e;return t&&r&&n&&t===r?new th(t,n):null}static _create(e,t){return new th(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class td extends ts{constructor(e){_(e.startsWith("saml."),"argument-error"),super(e)}static credentialFromResult(e){return td.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return td.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){let t=th.fromJSON(e);return _(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return th._create(r,t)}catch(e){return null}}}class tf extends ta{constructor(){super("twitter.com")}static credential(e,t){return e5._fromParams({providerId:tf.PROVIDER_ID,signInMethod:tf.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return tf.credentialFromTaggedObject(e)}static credentialFromError(e){return tf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return tf.credential(t,r)}catch{return null}}}async function tp(e,t){return x(e,"POST","/v1/accounts:signUp",k(e,t))}tf.TWITTER_SIGN_IN_METHOD="twitter.com",tf.PROVIDER_ID="twitter.com";class tm{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,n=!1){return new tm({user:await ea._fromIdTokenResponse(e,r,n),providerId:tg(r),_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){return await e._updateTokensIfNecessary(r,!0),new tm({user:e,providerId:tg(r),_tokenResponse:r,operationType:t})}}function tg(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}async function ty(e){if(i._isFirebaseServerApp(e.app))return Promise.reject(m(e));let t=eC(e);if(await t._initializationPromise,t.currentUser?.isAnonymous)return new tm({user:t.currentUser,providerId:null,operationType:"signIn"});let r=await tp(t,{returnSecureToken:!0}),n=await tm._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(n.user),n}class t_ extends s.FirebaseError{constructor(e,t,r,n){super(t.code,t.message),this.operationType=r,this.user=n,Object.setPrototypeOf(this,t_.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,n){return new t_(e,t,r,n)}}function tv(e,t,r,n){return("reauthenticate"===t?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(r=>{if("auth/multi-factor-auth-required"===r.code)throw t_._fromErrorAndOperation(e,r,t,n);throw r})}function tw(e){return new Set(e.map(({providerId:e})=>e).filter(e=>!!e))}async function tI(e,t){let r=s.getModularInstance(e);await tT(!0,r,t);let{providerUserInfo:n}=await z(r.auth,{idToken:await r.getIdToken(),deleteProvider:[t]}),i=tw(n||[]);return r.providerData=r.providerData.filter(e=>i.has(e.providerId)),i.has("phone")||(r.phoneNumber=null),await r.auth._persistUserIfCurrent(r),r}async function tE(e,t,r=!1){let n=await J(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return tm._forOperation(e,"link",n)}async function tT(e,t,r){await Z(t),_(tw(t.providerData).has(r)===e,t.auth,!1===e?"provider-already-linked":"no-such-provider")}async function tb(e,t,r=!1){let{auth:n}=e;if(i._isFirebaseServerApp(n.app))return Promise.reject(m(n));let s="reauthenticate";try{let i=await J(e,tv(n,s,t,e),r);_(i.idToken,n,"internal-error");let a=W(i.idToken);_(a,n,"internal-error");let{sub:o}=a;return _(e.uid===o,n,"user-mismatch"),tm._forOperation(e,s,i)}catch(e){throw e?.code==="auth/user-not-found"&&d(n,"user-mismatch"),e}}async function tA(e,t,r=!1){if(i._isFirebaseServerApp(e.app))return Promise.reject(m(e));let n="signIn",s=await tv(e,n,t),a=await tm._fromIdTokenResponse(e,n,s);return r||await e._updateCurrentUser(a.user),a}async function tS(e,t){return tA(eC(e),t)}async function tC(e,t){let r=s.getModularInstance(e);return await tT(!1,r,t.providerId),tE(r,t)}async function tR(e,t){return tb(s.getModularInstance(e),t)}async function tP(e,t){return x(e,"POST","/v1/accounts:signInWithCustomToken",k(e,t))}async function tk(e,t){if(i._isFirebaseServerApp(e.app))return Promise.reject(m(e));let r=eC(e),n=await tP(r,{token:t,returnSecureToken:!0}),s=await tm._fromIdTokenResponse(r,"signIn",n);return await r._updateCurrentUser(s.user),s}class tN{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?tD._fromServerResponse(e,t):"totpInfo"in t?tx._fromServerResponse(e,t):d(e,"internal-error")}}class tD extends tN{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new tD(t)}}class tx extends tN{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new tx(t)}}function tO(e,t,r){_(r.url?.length>0,e,"invalid-continue-uri"),_(void 0===r.dynamicLinkDomain||r.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),_(void 0===r.linkDomain||r.linkDomain.length>0,e,"invalid-hosting-link-domain"),t.continueUrl=r.url,t.dynamicLinkDomain=r.dynamicLinkDomain,t.linkDomain=r.linkDomain,t.canHandleCodeInApp=r.handleCodeInApp,r.iOS&&(_(r.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=r.iOS.bundleId),r.android&&(_(r.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=r.android.installApp,t.androidMinimumVersionCode=r.android.minimumVersion,t.androidPackageName=r.android.packageName)}async function tL(e){let t=eC(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function tM(e,t,r){let n=eC(e),i={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};r&&tO(n,i,r),await eU(n,i,"getOobCode",eZ,"EMAIL_PASSWORD_PROVIDER")}async function tV(e,t,r){await eH(s.getModularInstance(e),{oobCode:t,newPassword:r}).catch(async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&tL(e),t})}async function tF(e,t){await eQ(s.getModularInstance(e),{oobCode:t})}async function tU(e,t){let r=s.getModularInstance(e),n=await eH(r,{oobCode:t}),i=n.requestType;switch(_(i,r,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":_(n.newEmail,r,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":_(n.mfaInfo,r,"internal-error");default:_(n.email,r,"internal-error")}let a=null;return n.mfaInfo&&(a=tN._fromServerResponse(eC(r),n.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===n.requestType?n.newEmail:n.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===n.requestType?n.email:n.newEmail)||null,multiFactorInfo:a},operation:i}}async function tq(e,t){let{data:r}=await tU(s.getModularInstance(e),t);return r.email}async function tB(e,t,r){if(i._isFirebaseServerApp(e.app))return Promise.reject(m(e));let n=eC(e),s=eU(n,{returnSecureToken:!0,email:t,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",tp,"EMAIL_PASSWORD_PROVIDER"),a=await s.catch(t=>{throw"auth/password-does-not-meet-requirements"===t.code&&tL(e),t}),o=await tm._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(o.user),o}async function tj(e,t,r){let n=eC(e),i={requestType:"EMAIL_SIGNIN",email:t,clientType:"CLIENT_TYPE_WEB"};_(r.handleCodeInApp,n,"argument-error"),r&&tO(n,i,r),await eU(n,i,"getOobCode",e0,"EMAIL_PASSWORD_PROVIDER")}async function tz(e,t,r){if(i._isFirebaseServerApp(e.app))return Promise.reject(m(e));let n=s.getModularInstance(e),a=ti.credentialWithLink(t,r||I());return _(a._tenantId===(n.tenantId||null),n,"tenant-id-mismatch"),tS(n,a)}async function tG(e,t){return N(e,"POST","/v1/accounts:createAuthUri",k(e,t))}async function t$(e,t){let r=E()?I():"http://localhost",{signinMethods:n}=await tG(s.getModularInstance(e),{identifier:t,continueUri:r});return n||[]}async function tH(e,t){let r=s.getModularInstance(e),n={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&tO(r.auth,n,t);let{email:i}=await eX(r.auth,n);i!==e.email&&await e.reload()}async function tK(e,t,r){let n=s.getModularInstance(e),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};r&&tO(n.auth,i,r);let{email:a}=await e1(n.auth,i);a!==e.email&&await e.reload()}async function tW(e,t){return N(e,"POST","/v1/accounts:update",t)}async function tQ(e,{displayName:t,photoURL:r}){if(void 0===t&&void 0===r)return;let n=s.getModularInstance(e),i=await n.getIdToken(),a=await J(n,tW(n.auth,{idToken:i,displayName:t,photoUrl:r,returnSecureToken:!0}));n.displayName=a.displayName||null,n.photoURL=a.photoUrl||null;let o=n.providerData.find(({providerId:e})=>"password"===e);o&&(o.displayName=n.displayName,o.photoURL=n.photoURL),await n._updateTokensIfNecessary(a)}async function tJ(e,t,r){let{auth:n}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),r&&(i.password=r);let s=await J(e,eK(n,i));await e._updateTokensIfNecessary(s,!0)}class tY{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class tX extends tY{constructor(e,t,r,n){super(e,t,r),this.username=n}}class tZ extends tY{constructor(e,t){super(e,"facebook.com",t)}}class t0 extends tX{constructor(e,t){super(e,"github.com",t,"string"==typeof t?.login?t?.login:null)}}class t1 extends tY{constructor(e,t){super(e,"google.com",t)}}class t2 extends tX{constructor(e,t,r){super(e,"twitter.com",t,r)}}async function t6(e,t){return eC(e).validatePassword(t)}function t3(e,t,r,n){return s.getModularInstance(e).onIdTokenChanged(t,r,n)}function t4(e,t,r){return s.getModularInstance(e).beforeAuthStateChanged(t,r)}async function t5(e){return s.getModularInstance(e).delete()}class t8{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new t8("enroll",e,t)}static _fromMfaPendingCredential(e){return new t8("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){if(e?.multiFactorSession){if(e.multiFactorSession?.pendingCredential)return t8._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);else if(e.multiFactorSession?.idToken)return t8._fromIdtoken(e.multiFactorSession.idToken)}return null}}class t7{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){let r=eC(e),n=t.customData._serverResponse,i=(n.mfaInfo||[]).map(e=>tN._fromServerResponse(r,e));_(n.mfaPendingCredential,r,"internal-error");let s=t8._fromMfaPendingCredential(n.mfaPendingCredential);return new t7(s,i,async e=>{let i=await e._process(r,s);delete n.mfaInfo,delete n.mfaPendingCredential;let a={...n,idToken:i.idToken,refreshToken:i.refreshToken};switch(t.operationType){case"signIn":let o=await tm._fromIdTokenResponse(r,t.operationType,a);return await r._updateCurrentUser(o.user),o;case"reauthenticate":return _(t.user,r,"internal-error"),tm._forOperation(t.user,t.operationType,a);default:d(r,"internal-error")}})}async resolveSignIn(e){return this.signInResolver(e)}}function t9(e,t){return N(e,"POST","/v2/accounts/mfaEnrollment:start",k(e,t))}class re{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(t=>tN._fromServerResponse(e.auth,t)))})}static _fromUser(e){return new re(e)}async getSession(){return t8._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){let r=await this.getSession(),n=await J(this.user,e._process(this.user.auth,r,t));return await this.user._updateTokensIfNecessary(n),this.user.reload()}async unenroll(e){let t="string"==typeof e?e:e.uid,r=await this.user.getIdToken();try{var n,i;let e=await J(this.user,(n=this.user.auth,i={idToken:r,mfaEnrollmentId:t},N(n,"POST","/v2/accounts/mfaEnrollment:withdraw",k(n,i))));this.enrolledFactors=this.enrolledFactors.filter(({uid:e})=>e!==t),await this.user._updateTokensIfNecessary(e),await this.user.reload()}catch(e){throw e}}}let rt=new WeakMap,rr="__sak";class rn{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{if(!this.storage)return Promise.resolve(!1);return this.storage.setItem(rr,"1"),this.storage.removeItem(rr),Promise.resolve(!0)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class ri extends rn{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=eI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(let t of Object.keys(this.listeners)){let r=this.storage.getItem(t),n=this.localCache[t];r!==n&&e(t,n,r)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,r)=>{this.notifyListeners(e,r)});let r=e.key;t?this.detachListener():this.stopPolling();let n=()=>{let e=this.storage.getItem(r);(t||this.localCache[r]!==e)&&this.notifyListeners(r,e)},i=this.storage.getItem(r);s.isIE()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(n,10):n()}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let e of Array.from(r))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){let t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}function rs(e){let t=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),r=RegExp(`${t}=([^;]+)`);return document.cookie.match(r)?.[1]??null}function ra(e){let t="http:"===window.location.protocol;return`${t?"__dev_":"__HOST-"}FIREBASE_${e.split(":")[3]}`}ri.type="LOCAL";class ro{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){let t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set("finalTarget",e),t}async _isAvailable(){return("boolean"!=typeof isSecureContext||!!isSecureContext)&&"undefined"!=typeof navigator&&"undefined"!=typeof document&&(navigator.cookieEnabled??!0)}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;let t=ra(e);if(window.cookieStore){let e=await window.cookieStore.get(t);return e?.value}return rs(t)}async _remove(e){if(!this._isAvailable()||!await this._get(e))return;let t=ra(e);document.cookie=`${t}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch(()=>void 0)}_addListener(e,t){if(!this._isAvailable())return;let r=ra(e);if(window.cookieStore){let e=e=>{let n=e.changed.find(e=>e.name===r);n&&t(n.value),e.deleted.find(e=>e.name===r)&&t(null)};return this.listenerUnsubscribes.set(t,()=>window.cookieStore.removeEventListener("change",e)),window.cookieStore.addEventListener("change",e)}let n=rs(r),i=setInterval(()=>{let e=rs(r);e!==n&&(t(e),n=e)},1e3);this.listenerUnsubscribes.set(t,()=>clearInterval(i))}_removeListener(e,t){let r=this.listenerUnsubscribes.get(t);r&&(r(),this.listenerUnsubscribes.delete(t))}}ro.type="COOKIE";class rl extends rn{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}rl.type="SESSION";class ru{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){let t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;let r=new ru(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let{eventId:t,eventType:r,data:n}=e.data,i=this.handlersMap[r];if(!i?.size)return;e.ports[0].postMessage({status:"ack",eventId:t,eventType:r});let s=Array.from(i).map(async t=>t(e.origin,n)),a=await Promise.all(s.map(async e=>{try{let t=await e;return{fulfilled:!0,value:t}}catch(e){return{fulfilled:!1,reason:e}}}));e.ports[0].postMessage({status:"done",eventId:t,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function rc(e="",t=10){let r="";for(let e=0;e<t;e++)r+=Math.floor(10*Math.random());return e+r}ru.receivers=[];class rh{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let n,i,s="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!s)throw Error("connection_unavailable");return new Promise((a,o)=>{let l=rc("",20);s.port1.start();let u=setTimeout(()=>{o(Error("unsupported_event"))},r);i={messageChannel:s,onMessage(e){if(e.data.eventId===l)switch(e.data.status){case"ack":clearTimeout(u),n=setTimeout(()=>{o(Error("timeout"))},3e3);break;case"done":clearTimeout(n),a(e.data.response);break;default:clearTimeout(u),clearTimeout(n),o(Error("invalid_response"))}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}function rd(){return window}function rf(){return void 0!==rd().WorkerGlobalScope&&"function"==typeof rd().importScripts}async function rp(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}let rm="firebaseLocalStorageDb",rg="firebaseLocalStorage",ry="fbase_key";class r_{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function rv(e,t){return e.transaction([rg],t?"readwrite":"readonly").objectStore(rg)}function rw(){let e=indexedDB.open(rm,1);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{let t=e.result;try{t.createObjectStore(rg,{keyPath:ry})}catch(e){r(e)}}),e.addEventListener("success",async()=>{let r=e.result;r.objectStoreNames.contains(rg)?t(r):(r.close(),await new r_(indexedDB.deleteDatabase(rm)).toPromise(),t(await rw()))})})}async function rI(e,t,r){return new r_(rv(e,!0).put({[ry]:t,value:r})).toPromise()}async function rE(e,t){let r=rv(e,!1).get(t),n=await new r_(r).toPromise();return void 0===n?null:n.value}function rT(e,t){return new r_(rv(e,!0).delete(t)).toPromise()}class rb{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await rw()),this.db}async _withRetries(e){let t=0;for(;;)try{let t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return rf()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ru._getInstance(rf()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await rp(),!this.activeServiceWorker)return;this.sender=new rh(this.activeServiceWorker);let e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&(navigator?.serviceWorker?.controller||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await rw();return await rI(e,rr,"1"),await rT(e,rr),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>rI(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){let t=await this._withRetries(t=>rE(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>rT(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(e=>new r_(rv(e,!1).getAll()).toPromise());if(!e||0!==this.pendingWrites)return[];let t=[],r=new Set;if(0!==e.length)for(let{fbase_key:n,value:i}of e)r.add(n),JSON.stringify(this.localCache[n])!==JSON.stringify(i)&&(this.notifyListeners(n,i),t.push(n));for(let e of Object.keys(this.localCache))this.localCache[e]&&!r.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let e of Array.from(r))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}function rA(e,t){return N(e,"POST","/v2/accounts/mfaSignIn:start",k(e,t))}rb.type="LOCAL";let rS=eN("rcb"),rC=new b(3e4,6e4);class rR{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!rd().grecaptcha?.render}load(e,t=""){var r;return(_((r=t).length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(r),e,"argument-error"),this.shouldResolveImmediately(t)&&V(rd().grecaptcha))?Promise.resolve(rd().grecaptcha):new Promise((r,n)=>{let i=rd().setTimeout(()=>{n(f(e,"network-request-failed"))},rC.get());rd()[rS]=()=>{rd().clearTimeout(i),delete rd()[rS];let s=rd().grecaptcha;if(!s||!V(s))return void n(f(e,"internal-error"));let a=s.render;s.render=(e,t)=>{let r=a(e,t);return this.counter++,r},this.hostLanguage=t,r(s)},ek(`${eP.recaptchaV2Script}?${s.querystring({onload:rS,render:"explicit",hl:t})}`).catch(()=>{clearTimeout(i),n(f(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!rd().grecaptcha?.render&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class rP{async load(e){return new eD(e)}clearedOneInstance(){}}let rk="recaptcha",rN={theme:"light",type:"image"};class rD{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){let t=tr._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function rx(e,t,r){if(i._isFirebaseServerApp(e.app))return Promise.reject(m(e));let n=eC(e);return new rD(await rM(n,t,s.getModularInstance(r)),e=>tS(n,e))}async function rO(e,t,r){let n=s.getModularInstance(e);return await tT(!1,n,"phone"),new rD(await rM(n.auth,t,s.getModularInstance(r)),e=>tC(n,e))}async function rL(e,t,r){let n=s.getModularInstance(e);return i._isFirebaseServerApp(n.auth.app)?Promise.reject(m(n.auth)):new rD(await rM(n.auth,t,s.getModularInstance(r)),e=>tR(n,e))}async function rM(e,t,r){if(!e._getRecaptchaConfig())try{await eq(e)}catch(e){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let n;if(n="string"==typeof t?{phoneNumber:t}:t,"session"in n){let t=n.session;if("phoneNumber"in n){_("enroll"===t.type,e,"internal-error");let i={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:n.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},s=async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===eM){_(r?.type===rk,e,"argument-error");let n=await rF(e,t,r);return t9(e,n)}return t9(e,t)},a=eU(e,i,"mfaSmsEnrollment",s,"PHONE_PROVIDER");return(await a.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{_("signin"===t.type,e,"internal-error");let i=n.multiFactorHint?.uid||n.multiFactorUid;_(i,e,"missing-multi-factor-info");let s={mfaPendingCredential:t.credential,mfaEnrollmentId:i,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},a=async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===eM){_(r?.type===rk,e,"argument-error");let n=await rF(e,t,r);return rA(e,n)}return rA(e,t)},o=eU(e,s,"mfaSmsSignIn",a,"PHONE_PROVIDER");return(await o.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{let t={phoneNumber:n.phoneNumber,clientType:"CLIENT_TYPE_WEB"},i=async(e,t)=>{if(t.captchaResponse===eM){_(r?.type===rk,e,"argument-error");let n=await rF(e,t,r);return e8(e,n)}return e8(e,t)},s=eU(e,t,"sendVerificationCode",i,"PHONE_PROVIDER");return(await s.catch(e=>Promise.reject(e))).sessionInfo}}finally{r?._reset()}}async function rV(e,t){let r=s.getModularInstance(e);if(i._isFirebaseServerApp(r.auth.app))return Promise.reject(m(r.auth));await tE(r,t)}async function rF(e,t,r){_(r.type===rk,e,"argument-error");let n=await r.verify();_("string"==typeof n,e,"argument-error");let i={...t};if("phoneEnrollmentInfo"in i){let e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,r=i.phoneEnrollmentInfo.clientType,s=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:n,captchaResponse:t,clientType:r,recaptchaVersion:s}}),i}if(!("phoneSignInInfo"in i))return Object.assign(i,{recaptchaToken:n}),i;{let e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,r=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:n,captchaResponse:e,clientType:t,recaptchaVersion:r}}),i}}class rU{constructor(e){this.providerId=rU.PROVIDER_ID,this.auth=eC(e)}verifyPhoneNumber(e,t){return rM(this.auth,e,s.getModularInstance(t))}static credential(e,t){return tr._fromVerification(e,t)}static credentialFromResult(e){return rU.credentialFromTaggedObject(e)}static credentialFromError(e){return rU.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:t,temporaryProof:r}=e;return t&&r?tr._fromTokenResponse(t,r):null}}function rq(e,t){return t?el(t):(_(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}rU.PROVIDER_ID="phone",rU.PHONE_SIGN_IN_METHOD="phone";class rB extends e${constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return e4(e,this._buildIdpRequest())}_linkToIdToken(e,t){return e4(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return e4(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function rj(e){return tA(e.auth,new rB(e),e.bypassAuthState)}function rz(e){let{auth:t,user:r}=e;return _(r,t,"internal-error"),tb(r,new rB(e),e.bypassAuthState)}async function rG(e){let{auth:t,user:r}=e;return _(r,t,"internal-error"),tE(r,new rB(e),e.bypassAuthState)}class r${constructor(e,t,r,n,i=!1){this.auth=e,this.resolver=r,this.user=n,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:n,tenantId:i,error:s,type:a}=e;if(s)return void this.reject(s);let o={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:n||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return rj;case"linkViaPopup":case"linkViaRedirect":return rG;case"reauthViaPopup":case"reauthViaRedirect":return rz;default:d(this.auth,"internal-error")}}resolve(e){w(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){w(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}let rH=new b(2e3,1e4);async function rK(e,t,r){if(i._isFirebaseServerApp(e.app))return Promise.reject(f(e,"operation-not-supported-in-this-environment"));let n=eC(e);g(e,t,ts);let s=rq(n,r);return new rJ(n,"signInViaPopup",t,s).executeNotNull()}async function rW(e,t,r){let n=s.getModularInstance(e);if(i._isFirebaseServerApp(n.auth.app))return Promise.reject(f(n.auth,"operation-not-supported-in-this-environment"));g(n.auth,t,ts);let a=rq(n.auth,r);return new rJ(n.auth,"reauthViaPopup",t,a,n).executeNotNull()}async function rQ(e,t,r){let n=s.getModularInstance(e);g(n.auth,t,ts);let i=rq(n.auth,r);return new rJ(n.auth,"linkViaPopup",t,i,n).executeNotNull()}class rJ extends r${constructor(e,t,r,n,i){super(e,t,n,i),this.provider=r,this.authWindow=null,this.pollId=null,rJ.currentPopupAction&&rJ.currentPopupAction.cancel(),rJ.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return _(e,this.auth,"internal-error"),e}async onExecution(){w(1===this.filter.length,"Popup operations only handle one event");let e=rc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(f(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(f(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,rJ.currentPopupAction=null}pollUserCancellation(){let e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(f(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,rH.get())};e()}}rJ.currentPopupAction=null;let rY=new Map;class rX extends r${constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=rY.get(this.auth._key());if(!e){try{let t=await rZ(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}rY.set(this.auth._key(),e)}return this.bypassAuthState||rY.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"===e.type)return void this.resolve(null);if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function rZ(e,t){let r=r6(t),n=r2(e);if(!await n._isAvailable())return!1;let i=await n._get(r)==="true";return await n._remove(r),i}async function r0(e,t){return r2(e)._set(r6(t),"true")}function r1(e,t){rY.set(e._key(),t)}function r2(e){return el(e._redirectPersistence)}function r6(e){return ec("pendingRedirect",e.config.apiKey,e.name)}async function r3(e,t,r){if(i._isFirebaseServerApp(e.app))return Promise.reject(m(e));let n=eC(e);g(e,t,ts),await n._initializationPromise;let s=rq(n,r);return await r0(s,n),s._openRedirect(n,t,"signInViaRedirect")}async function r4(e,t,r){let n=s.getModularInstance(e);if(g(n.auth,t,ts),i._isFirebaseServerApp(n.auth.app))return Promise.reject(m(n.auth));await n.auth._initializationPromise;let a=rq(n.auth,r);await r0(a,n.auth);let o=await r9(n);return a._openRedirect(n.auth,t,"reauthViaRedirect",o)}async function r5(e,t,r){let n=s.getModularInstance(e);g(n.auth,t,ts),await n.auth._initializationPromise;let i=rq(n.auth,r);await tT(!1,n,t.providerId),await r0(i,n.auth);let a=await r9(n);return i._openRedirect(n.auth,t,"linkViaRedirect",a)}async function r8(e,t){return await eC(e)._initializationPromise,r7(e,t,!1)}async function r7(e,t,r=!1){if(i._isFirebaseServerApp(e.app))return Promise.reject(m(e));let n=eC(e),s=rq(n,t),a=new rX(n,s,r),o=await a.execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,t)),o}async function r9(e){let t=rc(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}class ne{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return nr(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!nr(e)){let r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(f(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(nt(e))}saveEventToCache(e){this.cachedEventUids.add(nt(e)),this.lastProcessedEventTime=Date.now()}}function nt(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function nr({type:e,error:t}){return"unknown"===e&&t?.code==="auth/no-auth-event"}async function nn(e,t={}){return N(e,"GET","/v1/projects",t)}let ni=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ns=/^https?/;async function na(e){if(e.config.emulator)return;let{authorizedDomains:t}=await nn(e);for(let e of t)try{if(function(e){let t=I(),{protocol:r,hostname:n}=new URL(t);if(e.startsWith("chrome-extension://")){let i=new URL(e);return""===i.hostname&&""===n?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&i.hostname===n}if(!ns.test(r))return!1;if(ni.test(e))return n===e;let i=e.replace(/\./g,"\\.");return RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}(e))return}catch{}d(e,"unauthorized-domain")}let no=new b(3e4,6e4);function nl(){let e=rd().___jsl;if(e?.H){for(let t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}}let nu=null,nc=new b(5e3,15e3),nh={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},nd=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);async function nf(e){let t,r,n,a,o,l=await (nu=nu||new Promise((t,r)=>{function n(){nl(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{nl(),r(f(e,"network-request-failed"))},timeout:no.get()})}if(rd().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(rd().gapi?.load)n();else{let t=eN("iframefcb");return rd()[t]=()=>{gapi.load?n():r(f(e,"network-request-failed"))},ek(`${eP.gapiScript}?onload=${t}`).catch(e=>r(e))}}).catch(e=>{throw nu=null,e})),u=rd().gapi;return _(u,e,"internal-error"),l.open({where:document.body,url:(_((t=e.config).authDomain,e,"auth-domain-config-required"),r=t.emulator?A(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,n={apiKey:t.apiKey,appName:e.name,v:i.SDK_VERSION},(a=nd.get(e.config.apiHost))&&(n.eid=a),(o=e._getFrameworks()).length&&(n.fw=o.join(",")),`${r}?${s.querystring(n).slice(1)}`),messageHandlersFilter:u.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:nh,dontclear:!0},t=>new Promise(async(r,n)=>{await t.restyle({setHideOnLeave:!1});let i=f(e,"network-request-failed"),s=rd().setTimeout(()=>{n(i)},nc.get());function a(){rd().clearTimeout(s),r(t)}t.ping(a).then(a,()=>{n(i)})}))}let np={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class nm{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}let ng=encodeURIComponent("fac");async function ny(e,t,r,n,a,o){_(e.config.authDomain,e,"auth-domain-config-required"),_(e.config.apiKey,e,"invalid-api-key");let l={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:n,v:i.SDK_VERSION,eventId:a};if(t instanceof ts)for(let[r,n]of(t.setDefaultLanguage(e.languageCode),l.providerId=t.providerId||"",s.isEmpty(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters())),Object.entries(o||{})))l[r]=n;if(t instanceof ta){let e=t.getScopes().filter(e=>""!==e);e.length>0&&(l.scopes=e.join(","))}for(let t of(e.tenantId&&(l.tid=e.tenantId),Object.keys(l)))void 0===l[t]&&delete l[t];let u=await e._getAppCheckToken(),c=u?`#${ng}=${encodeURIComponent(u)}`:"";return`${function({config:e}){return e.emulator?A(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${s.querystring(l).slice(1)}${c}`}let n_="webStorageSupport",nv=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=rl,this._completeRedirectFn=r7,this._overrideRedirectResult=r1}async _openPopup(e,t,r,n){w(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");let i=await ny(e,t,r,I(),n);return function(e,t,r,n=500,i=600){let a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString(),l="",u={...np,width:n.toString(),height:i.toString(),top:a,left:o},c=s.getUA().toLowerCase();r&&(l=em(c)?"_blank":r),ef(c)&&(t=t||"http://localhost",u.scrollbars="yes");let h=Object.entries(u).reduce((e,[t,r])=>`${e}${t}=${r},`,"");if(function(e=s.getUA()){return ew(e)&&!!window.navigator?.standalone}(c)&&"_self"!==l){var d,f;let e,r;return d=t||"",f=l,(e=document.createElement("a")).href=d,e.target=f,(r=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r),new nm(null)}let p=window.open(t||"",l,h);_(p,e,"popup-blocked");try{p.focus()}catch(e){}return new nm(p)}(e,i,rc())}async _openRedirect(e,t,r,n){var i;return await this._originValidation(e),i=await ny(e,t,r,I(),n),rd().location.href=i,new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:e,promise:r}=this.eventManagers[t];return e?Promise.resolve(e):(w(r,"If manager is not set, promise should be"),r)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){let t=await nf(e),r=new ne(e);return t.register("authEvent",t=>(_(t?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(t.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(n_,{type:n_},r=>{let n=r?.[0]?.[n_];void 0!==n&&t(!!n),d(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=na(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return eI()||ep()||ew()}};class nw{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return v("unexpected MultiFactorSessionType")}}}class nI extends nw{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new nI(e)}_finalizeEnroll(e,t,r){return N(e,"POST","/v2/accounts/mfaEnrollment:finalize",k(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()}))}_finalizeSignIn(e,t){return N(e,"POST","/v2/accounts/mfaSignIn:finalize",k(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()}))}}class nE{static assertion(e){return nI._fromCredential(e)}}nE.FACTOR_ID="phone";class nT{static assertionForEnrollment(e,t){return nb._fromSecret(e,t)}static assertionForSignIn(e,t){return nb._fromEnrollmentId(e,t)}static async generateSecret(e){var t;_(void 0!==e.user?.auth,"internal-error");let r=await N(t=e.user.auth,"POST","/v2/accounts/mfaEnrollment:start",k(t,{idToken:e.credential,totpEnrollmentInfo:{}}));return nA._fromStartTotpMfaEnrollmentResponse(r,e.user.auth)}}nT.FACTOR_ID="totp";class nb extends nw{constructor(e,t,r){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=r}static _fromSecret(e,t){return new nb(t,void 0,e)}static _fromEnrollmentId(e,t){return new nb(t,e)}async _finalizeEnroll(e,t,r){return _(void 0!==this.secret,e,"argument-error"),N(e,"POST","/v2/accounts/mfaEnrollment:finalize",k(e,{idToken:t,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)}))}async _finalizeSignIn(e,t){_(void 0!==this.enrollmentId&&void 0!==this.otp,e,"argument-error");let r={verificationCode:this.otp};return N(e,"POST","/v2/accounts/mfaSignIn:finalize",k(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r}))}}class nA{constructor(e,t,r,n,i,s,a){this.sessionInfo=s,this.auth=a,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=r,this.codeIntervalSeconds=n,this.enrollmentCompletionDeadline=i}static _fromStartTotpMfaEnrollmentResponse(e,t){return new nA(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){let r=!1;return(nS(e)||nS(t))&&(r=!0),r&&(nS(e)&&(e=this.auth.currentUser?.email||"unknownuser"),nS(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function nS(e){return void 0===e||e?.length===0}var nC="@firebase/auth",nR="1.12.0";class nP{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return(this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser)?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(t=>{e(t?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){_(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}let nk=s.getExperimentalSetting("authIdTokenMaxAge")||300,nN=null;eP={loadJS:e=>new Promise((t,r)=>{let n=document.createElement("script");n.setAttribute("src",e),n.onload=t,n.onerror=e=>{let t=f("internal-error");t.customData=e,r(t)},n.type="text/javascript",n.charset="UTF-8",(document.getElementsByTagName("head")?.[0]??document).appendChild(n)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},n="Browser",i._registerComponent(new o.Component("auth",(e,{options:t})=>{let r,i,s=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=s.options;_(l&&!l.includes(":"),"invalid-api-key",{appName:s.name});let c=new eS(s,a,o,{apiKey:l,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:eE(n)});return i=(Array.isArray(r=t?.persistence||[])?r:[r]).map(el),t?.errorMap&&c._updateErrorMap(t.errorMap),c._initializeWithPersistence(i,t?.popupRedirectResolver),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),i._registerComponent(new o.Component("auth-internal",e=>new nP(eC(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),i.registerVersion(nC,nR,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(n)),i.registerVersion(nC,nR,"cjs2020"),r.AUTH_ERROR_CODES_MAP_DO_NOT_USE_INTERNALLY={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_PASSWORD:"auth/missing-password",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type",INVALID_HOSTING_LINK_DOMAIN:"auth/invalid-hosting-link-domain"},r.ActionCodeOperation={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"},r.ActionCodeURL=tn,r.AuthCredential=e$,r.AuthEventManager=ne,r.AuthImpl=eS,r.AuthPopup=nm,r.EmailAuthCredential=e3,r.EmailAuthProvider=ti,r.FacebookAuthProvider=tl,r.FactorId={PHONE:"phone",TOTP:"totp"},r.FetchProvider=S,r.GithubAuthProvider=tc,r.GoogleAuthProvider=tu,r.OAuthCredential=e5,r.OAuthProvider=to,r.OperationType={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},r.PhoneAuthCredential=tr,r.PhoneAuthProvider=rU,r.PhoneMultiFactorGenerator=nE,r.ProviderId={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},r.RecaptchaVerifier=class{constructor(e,t,r={...rN}){this.parameters=r,this.type=rk,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=eC(e),this.isInvisible="invisible"===this.parameters.size,_("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const n="string"==typeof t?document.getElementById(t):t;_(n,this.auth,"argument-error"),this.container=n,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new rP:new rR,this.validateStartingState()}async verify(){this.assertNotDestroyed();let e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(r=>{let n=e=>{e&&(this.tokenChangeListeners.delete(n),r(e))};this.tokenChangeListeners.add(n),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){_(!this.parameters.sitekey,this.auth,"argument-error"),_(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),_("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(e=>e(t)),"function"==typeof e)e(t);else if("string"==typeof e){let r=rd()[e];"function"==typeof r&&r(t)}}}assertNotDestroyed(){_(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){let t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){let e;_(E()&&!rf(),this.auth,"internal-error"),await (e=null,new Promise(t=>{"complete"===document.readyState?t():(e=()=>t(),window.addEventListener("load",e))}).catch(t=>{throw e&&window.removeEventListener("load",e),t})),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);let t=await q(this.auth);_(t,this.auth,"internal-error"),this.parameters.sitekey=t}getAssertedRecaptcha(){return _(this.recaptcha,this.auth,"internal-error"),this.recaptcha}},r.SAMLAuthCredential=th,r.SAMLAuthProvider=td,r.SignInMethod={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},r.TotpMultiFactorGenerator=nT,r.TotpSecret=nA,r.TwitterAuthProvider=tf,r.UserImpl=ea,r._assert=_,r._castAuth=eC,r._clearRedirectOutcomes=function(){rY.clear()},r._createError=f,r._fail=d,r._generateEventId=rc,r._getClientVersion=eE,r._getInstance=el,r._getProjectConfig=nn,r._getRedirectResult=r7,r._getRedirectUrl=ny,r._isAndroid=ey,r._isIOS=ew,r._isIOS7Or8=function(e=s.getUA()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)},r._overrideRedirectResult=r1,r._persistenceKeyName=ec,r.applyActionCode=tF,r.beforeAuthStateChanged=t4,r.browserCookiePersistence=ro,r.browserLocalPersistence=ri,r.browserPopupRedirectResolver=nv,r.browserSessionPersistence=rl,r.checkActionCode=tU,r.confirmPasswordReset=tV,r.connectAuthEmulator=ej,r.createUserWithEmailAndPassword=tB,r.debugAssert=w,r.debugErrorMap=function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}},r.deleteUser=t5,r.fetchSignInMethodsForEmail=t$,r.getAdditionalUserInfo=function(e){let{user:t,_tokenResponse:r}=e;return t.isAnonymous&&!r?{providerId:null,isNewUser:!1,profile:null}:function(e){if(!e)return null;let{providerId:t}=e,r=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},n=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!t&&e?.idToken){let t=W(e.idToken)?.firebase?.sign_in_provider;if(t)return new tY(n,"anonymous"!==t&&"custom"!==t?t:null)}if(!t)return null;switch(t){case"facebook.com":return new tZ(n,r);case"github.com":return new t0(n,r);case"google.com":return new t1(n,r);case"twitter.com":return new t2(n,r,e.screenName||null);case"custom":case"anonymous":return new tY(n,null);default:return new tY(n,t,r)}}(r)},r.getAuth=function(e=i.getApp()){let t=i._getProvider(e,"auth");if(t.isInitialized())return t.getImmediate();let r=eB(e,{popupRedirectResolver:nv,persistence:[rb,ri,rl]}),n=s.getExperimentalSetting("authTokenSyncURL");if(n&&"boolean"==typeof isSecureContext&&isSecureContext){let e=new URL(n,location.origin);if(location.origin===e.origin){let t,n=(t=e.toString(),async e=>{let r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>nk)return;let i=r?.token;nN!==i&&(nN=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});t4(r,n,()=>n(r.currentUser)),t3(r,e=>n(e))}}let a=s.getDefaultEmulatorHost("auth");return a&&ej(r,`http://${a}`),r},r.getIdToken=function(e,t=!1){return s.getModularInstance(e).getIdToken(t)},r.getIdTokenResult=H,r.getMultiFactorResolver=function(e,t){let r=s.getModularInstance(e);return _(t.customData.operationType,r,"argument-error"),_(t.customData._serverResponse?.mfaPendingCredential,r,"argument-error"),t7._fromError(r,t)},r.getRedirectResult=r8,r.inMemoryPersistence=eu,r.indexedDBLocalPersistence=rb,r.initializeAuth=eB,r.initializeRecaptchaConfig=function(e){return eq(e)},r.isSignInWithEmailLink=function(e,t){let r=tn.parseLink(t);return r?.operation==="EMAIL_SIGNIN"},r.linkWithCredential=tC,r.linkWithPhoneNumber=rO,r.linkWithPopup=rQ,r.linkWithRedirect=function(e,t,r){return r5(e,t,r)},r.multiFactor=function(e){let t=s.getModularInstance(e);return rt.has(t)||rt.set(t,re._fromUser(t)),rt.get(t)},r.onAuthStateChanged=function(e,t,r,n){return s.getModularInstance(e).onAuthStateChanged(t,r,n)},r.onIdTokenChanged=t3,r.parseActionCodeURL=function(e){return tn.parseLink(e)},r.prodErrorMap=l,r.reauthenticateWithCredential=tR,r.reauthenticateWithPhoneNumber=rL,r.reauthenticateWithPopup=rW,r.reauthenticateWithRedirect=function(e,t,r){return r4(e,t,r)},r.reload=ee,r.revokeAccessToken=function(e,t){return eC(e).revokeAccessToken(t)},r.sendEmailVerification=tH,r.sendPasswordResetEmail=tM,r.sendSignInLinkToEmail=tj,r.setPersistence=function(e,t){return s.getModularInstance(e).setPersistence(t)},r.signInAnonymously=ty,r.signInWithCredential=tS,r.signInWithCustomToken=tk,r.signInWithEmailAndPassword=function(e,t,r){return i._isFirebaseServerApp(e.app)?Promise.reject(m(e)):tS(s.getModularInstance(e),ti.credential(t,r)).catch(async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&tL(e),t})},r.signInWithEmailLink=tz,r.signInWithPhoneNumber=rx,r.signInWithPopup=rK,r.signInWithRedirect=function(e,t,r){return r3(e,t,r)},r.signOut=function(e){return s.getModularInstance(e).signOut()},r.unlink=tI,r.updateCurrentUser=function(e,t){return s.getModularInstance(e).updateCurrentUser(t)},r.updateEmail=function(e,t){let r=s.getModularInstance(e);return i._isFirebaseServerApp(r.auth.app)?Promise.reject(m(r.auth)):tJ(r,t,null)},r.updatePassword=function(e,t){return tJ(s.getModularInstance(e),null,t)},r.updatePhoneNumber=rV,r.updateProfile=tQ,r.useDeviceLanguage=function(e){s.getModularInstance(e).useDeviceLanguage()},r.validatePassword=t6,r.verifyBeforeUpdateEmail=tK,r.verifyPasswordResetCode=tq},697960,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e.r(62328);e.r(336952),e.r(650043),e.r(601402),e.r(140952),r.ActionCodeOperation=n.ActionCodeOperation,r.ActionCodeURL=n.ActionCodeURL,r.AuthCredential=n.AuthCredential,r.AuthErrorCodes=n.AUTH_ERROR_CODES_MAP_DO_NOT_USE_INTERNALLY,r.EmailAuthCredential=n.EmailAuthCredential,r.EmailAuthProvider=n.EmailAuthProvider,r.FacebookAuthProvider=n.FacebookAuthProvider,r.FactorId=n.FactorId,r.GithubAuthProvider=n.GithubAuthProvider,r.GoogleAuthProvider=n.GoogleAuthProvider,r.OAuthCredential=n.OAuthCredential,r.OAuthProvider=n.OAuthProvider,r.OperationType=n.OperationType,r.PhoneAuthCredential=n.PhoneAuthCredential,r.PhoneAuthProvider=n.PhoneAuthProvider,r.PhoneMultiFactorGenerator=n.PhoneMultiFactorGenerator,r.ProviderId=n.ProviderId,r.RecaptchaVerifier=n.RecaptchaVerifier,r.SAMLAuthProvider=n.SAMLAuthProvider,r.SignInMethod=n.SignInMethod,r.TotpMultiFactorGenerator=n.TotpMultiFactorGenerator,r.TotpSecret=n.TotpSecret,r.TwitterAuthProvider=n.TwitterAuthProvider,r.applyActionCode=n.applyActionCode,r.beforeAuthStateChanged=n.beforeAuthStateChanged,r.browserCookiePersistence=n.browserCookiePersistence,r.browserLocalPersistence=n.browserLocalPersistence,r.browserPopupRedirectResolver=n.browserPopupRedirectResolver,r.browserSessionPersistence=n.browserSessionPersistence,r.checkActionCode=n.checkActionCode,r.confirmPasswordReset=n.confirmPasswordReset,r.connectAuthEmulator=n.connectAuthEmulator,r.createUserWithEmailAndPassword=n.createUserWithEmailAndPassword,r.debugErrorMap=n.debugErrorMap,r.deleteUser=n.deleteUser,r.fetchSignInMethodsForEmail=n.fetchSignInMethodsForEmail,r.getAdditionalUserInfo=n.getAdditionalUserInfo,r.getAuth=n.getAuth,r.getIdToken=n.getIdToken,r.getIdTokenResult=n.getIdTokenResult,r.getMultiFactorResolver=n.getMultiFactorResolver,r.getRedirectResult=n.getRedirectResult,r.inMemoryPersistence=n.inMemoryPersistence,r.indexedDBLocalPersistence=n.indexedDBLocalPersistence,r.initializeAuth=n.initializeAuth,r.initializeRecaptchaConfig=n.initializeRecaptchaConfig,r.isSignInWithEmailLink=n.isSignInWithEmailLink,r.linkWithCredential=n.linkWithCredential,r.linkWithPhoneNumber=n.linkWithPhoneNumber,r.linkWithPopup=n.linkWithPopup,r.linkWithRedirect=n.linkWithRedirect,r.multiFactor=n.multiFactor,r.onAuthStateChanged=n.onAuthStateChanged,r.onIdTokenChanged=n.onIdTokenChanged,r.parseActionCodeURL=n.parseActionCodeURL,r.prodErrorMap=n.prodErrorMap,r.reauthenticateWithCredential=n.reauthenticateWithCredential,r.reauthenticateWithPhoneNumber=n.reauthenticateWithPhoneNumber,r.reauthenticateWithPopup=n.reauthenticateWithPopup,r.reauthenticateWithRedirect=n.reauthenticateWithRedirect,r.reload=n.reload,r.revokeAccessToken=n.revokeAccessToken,r.sendEmailVerification=n.sendEmailVerification,r.sendPasswordResetEmail=n.sendPasswordResetEmail,r.sendSignInLinkToEmail=n.sendSignInLinkToEmail,r.setPersistence=n.setPersistence,r.signInAnonymously=n.signInAnonymously,r.signInWithCredential=n.signInWithCredential,r.signInWithCustomToken=n.signInWithCustomToken,r.signInWithEmailAndPassword=n.signInWithEmailAndPassword,r.signInWithEmailLink=n.signInWithEmailLink,r.signInWithPhoneNumber=n.signInWithPhoneNumber,r.signInWithPopup=n.signInWithPopup,r.signInWithRedirect=n.signInWithRedirect,r.signOut=n.signOut,r.unlink=n.unlink,r.updateCurrentUser=n.updateCurrentUser,r.updateEmail=n.updateEmail,r.updatePassword=n.updatePassword,r.updatePhoneNumber=n.updatePhoneNumber,r.updateProfile=n.updateProfile,r.useDeviceLanguage=n.useDeviceLanguage,r.validatePassword=n.validatePassword,r.verifyBeforeUpdateEmail=n.verifyBeforeUpdateEmail,r.verifyPasswordResetCode=n.verifyPasswordResetCode},76436,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e.r(697960);Object.keys(n).forEach(function(e){"default"===e||r.hasOwnProperty(e)||Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}})})},848720,(e,t,r)=>{(function(){"use strict";function e(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.C=Array(this.blockSize),this.o=this.h=0,this.u()}var r=function(){this.blockSize=-1};function n(){}function i(e,t,r){r||(r=0);let n=Array(16);if("string"==typeof t)for(var i=0;i<16;++i)n[i]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(i=0;i<16;++i)n[i]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],i=e.g[2];let s=e.g[3],a;a=t+(s^r&(i^s))+n[0]+0xd76aa478|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[1]+0xe8c7b756|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[2]+0x242070db|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[3]+0xc1bdceee|0,a=t+(s^(r=i+(a<<22|a>>>10))&(i^s))+n[4]+0xf57c0faf|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[5]+0x4787c62a|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[6]+0xa8304613|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[7]+0xfd469501|0,a=t+(s^(r=i+(a<<22|a>>>10))&(i^s))+n[8]+0x698098d8|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[9]+0x8b44f7af|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[10]+0xffff5bb1|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[11]+0x895cd7be|0,a=t+(s^(r=i+(a<<22|a>>>10))&(i^s))+n[12]+0x6b901122|0,a=s+(i^(t=r+(a<<7|a>>>25))&(r^i))+n[13]+0xfd987193|0,a=i+(r^(s=t+(a<<12|a>>>20))&(t^r))+n[14]+0xa679438e|0,a=r+(t^(i=s+(a<<17|a>>>15))&(s^t))+n[15]+0x49b40821|0,r=i+(a<<22|a>>>10),a=t+(i^s&(r^i))+n[1]+0xf61e2562|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[6]+0xc040b340|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[11]+0x265e5a51|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[0]+0xe9b6c7aa|0,r=i+(a<<20|a>>>12),a=t+(i^s&(r^i))+n[5]+0xd62f105d|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[10]+0x2441453|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[15]+0xd8a1e681|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[4]+0xe7d3fbc8|0,r=i+(a<<20|a>>>12),a=t+(i^s&(r^i))+n[9]+0x21e1cde6|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[14]+0xc33707d6|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[3]+0xf4d50d87|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[8]+0x455a14ed|0,r=i+(a<<20|a>>>12),a=t+(i^s&(r^i))+n[13]+0xa9e3e905|0,t=r+(a<<5|a>>>27),a=s+(r^i&(t^r))+n[2]+0xfcefa3f8|0,s=t+(a<<9|a>>>23),a=i+(t^r&(s^t))+n[7]+0x676f02d9|0,i=s+(a<<14|a>>>18),a=r+(s^t&(i^s))+n[12]+0x8d2a4c8a|0,a=t+((r=i+(a<<20|a>>>12))^i^s)+n[5]+0xfffa3942|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[8]+0x8771f681|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[11]+0x6d9d6122|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[14]+0xfde5380c|0,a=t+((r=i+(a<<23|a>>>9))^i^s)+n[1]+0xa4beea44|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[4]+0x4bdecfa9|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[7]+0xf6bb4b60|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[10]+0xbebfbc70|0,a=t+((r=i+(a<<23|a>>>9))^i^s)+n[13]+0x289b7ec6|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[0]+0xeaa127fa|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[3]+0xd4ef3085|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[6]+0x4881d05|0,a=t+((r=i+(a<<23|a>>>9))^i^s)+n[9]+0xd9d4d039|0,a=s+((t=r+(a<<4|a>>>28))^r^i)+n[12]+0xe6db99e5|0,a=i+((s=t+(a<<11|a>>>21))^t^r)+n[15]+0x1fa27cf8|0,a=r+((i=s+(a<<16|a>>>16))^s^t)+n[2]+0xc4ac5665|0,r=i+(a<<23|a>>>9),a=t+(i^(r|~s))+n[0]+0xf4292244|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[7]+0x432aff97|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[14]+0xab9423a7|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[5]+0xfc93a039|0,r=i+(a<<21|a>>>11),a=t+(i^(r|~s))+n[12]+0x655b59c3|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[3]+0x8f0ccc92|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[10]+0xffeff47d|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[1]+0x85845dd1|0,r=i+(a<<21|a>>>11),a=t+(i^(r|~s))+n[8]+0x6fa87e4f|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[15]+0xfe2ce6e0|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[6]+0xa3014314|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[13]+0x4e0811a1|0,r=i+(a<<21|a>>>11),a=t+(i^(r|~s))+n[4]+0xf7537e82|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~i))+n[11]+0xbd3af235|0,s=t+(a<<10|a>>>22),a=i+(t^(s|~r))+n[2]+0x2ad7d2bb|0,i=s+(a<<15|a>>>17),a=r+(s^(i|~t))+n[9]+0xeb86d391|0,e.g[0]=e.g[0]+t|0,e.g[1]=e.g[1]+(i+(a<<21|a>>>11))|0,e.g[2]=e.g[2]+i|0,e.g[3]=e.g[3]+s|0}function s(e,t){this.h=t;let r=[],n=!0;for(let i=e.length-1;i>=0;i--){let s=0|e[i];n&&s==t||(r[i]=s,n=!1)}this.g=r}n.prototype=r.prototype,e.F=r.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,t,n){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return r.prototype[t].apply(e,i)},e.prototype.u=function(){this.g[0]=0x67452301,this.g[1]=0xefcdab89,this.g[2]=0x98badcfe,this.g[3]=0x10325476,this.o=this.h=0},e.prototype.v=function(e,t){void 0===t&&(t=e.length);let r=t-this.blockSize,n=this.C,s=this.h,a=0;for(;a<t;){if(0==s)for(;a<=r;)i(this,e,a),a+=this.blockSize;if("string"==typeof e){for(;a<t;)if(n[s++]=e.charCodeAt(a++),s==this.blockSize){i(this,n),s=0;break}}else for(;a<t;)if(n[s++]=e[a++],s==this.blockSize){i(this,n),s=0;break}}this.h=s,this.o+=t},e.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var r=e.length-8;r<e.length;++r)e[r]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,r=0;r<4;++r)for(let n=0;n<32;n+=8)e[t++]=this.g[r]>>>n&255;return e};var a,o={};function l(e){var t;return -128<=e&&e<128?(t=function(e){return new s([0|e],e<0?-1:0)},Object.prototype.hasOwnProperty.call(o,e)?o[e]:o[e]=t(e)):new s([0|e],e<0?-1:0)}function u(e){if(isNaN(e)||!isFinite(e))return c;if(e<0)return m(u(-e));let t=[],r=1;for(let n=0;e>=r;n++)t[n]=e/r|0,r*=0x100000000;return new s(t,0)}var c=l(0),h=l(1),d=l(0x1000000);function f(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function p(e){return -1==e.h}function m(e){let t=e.g.length,r=[];for(let n=0;n<t;n++)r[n]=~e.g[n];return new s(r,~e.h).add(h)}function g(e,t){return e.add(m(t))}function y(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function _(e,t){this.g=e,this.h=t}function v(e,t){if(f(t))throw Error("division by zero");if(f(e))return new _(c,c);if(p(e))return t=v(m(e),t),new _(m(t.g),m(t.h));if(p(t))return t=v(e,m(t)),new _(m(t.g),t.h);if(e.g.length>30){if(p(e)||p(t))throw Error("slowDivide_ only works with positive integers.");for(var r=h,n=t;0>=n.l(e);)r=w(r),n=w(n);var i=I(r,1),s=I(n,1);for(n=I(n,2),r=I(r,2);!f(n);){var a=s.add(n);0>=a.l(e)&&(i=i.add(r),s=a),n=I(n,1),r=I(r,1)}return t=g(e,i.j(t)),new _(i,t)}for(i=c;e.l(t)>=0;){for(n=(n=Math.ceil(Math.log(r=Math.max(1,Math.floor(e.m()/t.m())))/Math.LN2))<=48?1:Math.pow(2,n-48),a=(s=u(r)).j(t);p(a)||a.l(e)>0;)r-=n,a=(s=u(r)).j(t);f(s)&&(s=h),i=i.add(s),e=g(e,a)}return new _(i,e)}function w(e){let t=e.g.length+1,r=[];for(let n=0;n<t;n++)r[n]=e.i(n)<<1|e.i(n-1)>>>31;return new s(r,e.h)}function I(e,t){let r=t>>5;t%=32;let n=e.g.length-r,i=[];for(let s=0;s<n;s++)i[s]=t>0?e.i(s+r)>>>t|e.i(s+r+1)<<32-t:e.i(s+r);return new s(i,e.h)}(a=s.prototype).m=function(){if(p(this))return-m(this).m();let e=0,t=1;for(let r=0;r<this.g.length;r++){let n=this.i(r);e+=(n>=0?n:0x100000000+n)*t,t*=0x100000000}return e},a.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(f(this))return"0";if(p(this))return"-"+m(this).toString(e);let t=u(Math.pow(e,6));var r=this;let n="";for(;;){let i=v(r,t).g,s=(((r=g(r,i.j(t))).g.length>0?r.g[0]:r.h)>>>0).toString(e);if(f(r=i))return s+n;for(;s.length<6;)s="0"+s;n=s+n}},a.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},a.l=function(e){return p(e=g(this,e))?-1:+!f(e)},a.abs=function(){return p(this)?m(this):this},a.add=function(e){let t=Math.max(this.g.length,e.g.length),r=[],n=0;for(let i=0;i<=t;i++){let t=n+(65535&this.i(i))+(65535&e.i(i)),s=(t>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);n=s>>>16,t&=65535,s&=65535,r[i]=s<<16|t}return new s(r,-0x80000000&r[r.length-1]?-1:0)},a.j=function(e){if(f(this)||f(e))return c;if(p(this))return p(e)?m(this).j(m(e)):m(m(this).j(e));if(p(e))return m(this.j(m(e)));if(0>this.l(d)&&0>e.l(d))return u(this.m()*e.m());let t=this.g.length+e.g.length,r=[];for(var n=0;n<2*t;n++)r[n]=0;for(n=0;n<this.g.length;n++)for(let t=0;t<e.g.length;t++){let i=this.i(n)>>>16,s=65535&this.i(n),a=e.i(t)>>>16,o=65535&e.i(t);r[2*n+2*t]+=s*o,y(r,2*n+2*t),r[2*n+2*t+1]+=i*o,y(r,2*n+2*t+1),r[2*n+2*t+1]+=s*a,y(r,2*n+2*t+1),r[2*n+2*t+2]+=i*a,y(r,2*n+2*t+2)}for(e=0;e<t;e++)r[e]=r[2*e+1]<<16|r[2*e];for(e=t;e<2*t;e++)r[e]=0;return new s(r,0)},a.B=function(e){return v(this,e).h},a.and=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let n=0;n<t;n++)r[n]=this.i(n)&e.i(n);return new s(r,this.h&e.h)},a.or=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let n=0;n<t;n++)r[n]=this.i(n)|e.i(n);return new s(r,this.h|e.h)},a.xor=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let n=0;n<t;n++)r[n]=this.i(n)^e.i(n);return new s(r,this.h^e.h)},e.prototype.digest=e.prototype.A,e.prototype.reset=e.prototype.u,e.prototype.update=e.prototype.v,t.exports.Md5=e,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=u,s.fromString=function e(t,r){if(0==t.length)throw Error("number format error: empty string");if((r=r||10)<2||36<r)throw Error("radix out of range: "+r);if("-"==t.charAt(0))return m(e(t.substring(1),r));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');let n=u(Math.pow(r,8)),i=c;for(let e=0;e<t.length;e+=8){var s=Math.min(8,t.length-e);let a=parseInt(t.substring(e,e+s),r);s<8?(s=u(Math.pow(r,s)),i=i.j(s).add(u(a))):i=(i=i.j(n)).add(u(a))}return i},t.exports.Integer=s}).apply(e.g)},301207,(e,t,r)=>{(function(){"use strict";var r,n,i=Object.defineProperty,s=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,e.g];for(var r=0;r<t.length;++r){var n=t[r];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function a(e,t){if(t)e:{var r=s;e=e.split(".");for(var n=0;n<e.length-1;n++){var a=e[n];if(!(a in r))break e;r=r[a]}(t=t(n=r[e=e[e.length-1]]))!=n&&null!=t&&i(r,e,{configurable:!0,writable:!0,value:t})}}a("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(e){return e||function(e){var t,r=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.push([t,e[t]]);return r}});var o=o||{},l=this||self;function u(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function c(e,t,r){return e.call.apply(e.bind,arguments)}function h(e,t,r){return(h=c).apply(null,arguments)}function d(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=r.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function f(e,t){function r(){}r.prototype=t.prototype,e.Z=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.Ob=function(e,r,n){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[r].apply(e,i)}}var p="undefined"!=typeof AsyncContext&&"function"==typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function m(e){let t=e.length;if(t>0){let r=Array(t);for(let n=0;n<t;n++)r[n]=e[n];return r}return[]}function g(e,t){for(let t=1;t<arguments.length;t++){let n=arguments[t];var r=typeof n;if("array"==(r="object"!=r?r:n?Array.isArray(n)?"array":r:"null")||"object"==r&&"number"==typeof n.length){r=e.length||0;let t=n.length||0;e.length=r+t;for(let i=0;i<t;i++)e[r+i]=n[i]}else e.push(n)}}var y=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new _,e=>e.reset());class _{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let v,w=!1,I=new class{constructor(){this.h=this.g=null}add(e,t){let r=y.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},E=()=>{let e=Promise.resolve(void 0);v=()=>{e.then(T)}};function T(){let e;for(var t;e=null,I.g&&(e=I.g,I.g=I.g.next,I.g||(I.h=null),e.next=null),t=e;){try{t.h.call(t.g)}catch(e){!function(e){l.setTimeout(()=>{throw e},0)}(e)}y.j(t),y.h<100&&(y.h++,t.next=y.g,y.g=t)}w=!1}function b(){this.u=this.u,this.C=this.C}function A(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}b.prototype.u=!1,b.prototype.dispose=function(){this.u||(this.u=!0,this.N())},b.prototype[Symbol.dispose]=function(){this.dispose()},b.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},A.prototype.h=function(){this.defaultPrevented=!0};var S=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{let e=()=>{};l.addEventListener("test",e,t),l.removeEventListener("test",e,t)}catch(e){}return e}();function C(e){return/^[\s\xa0]*$/.test(e)}function R(e,t){A.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}f(R,A),R.prototype.init=function(e,t){let r=this.type=e.type,n=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==r?t=e.fromElement:"mouseout"==r&&(t=e.toElement)),this.relatedTarget=t,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&R.Z.h.call(this)},R.prototype.h=function(){R.Z.h.call(this);let e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var P="closure_listenable_"+(1e6*Math.random()|0),k=0;function N(e,t,r,n,i){this.listener=e,this.proxy=null,this.src=t,this.type=r,this.capture=!!n,this.ha=i,this.key=++k,this.da=this.fa=!1}function D(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function x(e,t,r){for(let n in e)t.call(r,e[n],n,e)}function O(e){let t={};for(let r in e)t[r]=e[r];return t}let L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(e,t){let r,n;for(let t=1;t<arguments.length;t++){for(r in n=arguments[t])e[r]=n[r];for(let t=0;t<L.length;t++)r=L[t],Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}}function V(e){this.src=e,this.g={},this.h=0}function F(e,t){let r=t.type;if(r in e.g){var n,i=e.g[r],s=Array.prototype.indexOf.call(i,t,void 0);(n=s>=0)&&Array.prototype.splice.call(i,s,1),n&&(D(t),0==e.g[r].length&&(delete e.g[r],e.h--))}}function U(e,t,r,n){for(let i=0;i<e.length;++i){let s=e[i];if(!s.da&&s.listener==t&&!!r==s.capture&&s.ha==n)return i}return -1}V.prototype.add=function(e,t,r,n,i){let s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);let a=U(e,t,n,i);return a>-1?(t=e[a],r||(t.fa=!1)):((t=new N(t,this.src,s,!!n,i)).fa=r,e.push(t)),t};var q="closure_lm_"+(1e6*Math.random()|0),B={},j=0;function z(e,t,r,n,i,s){if(!t)throw Error("Invalid event type");let a=u(i)?!!i.capture:!!i,o=K(e);if(o||(e[q]=o=new V(e)),(r=o.add(t,r,n,a,s)).proxy)return r;if(n=function e(t){return H.call(e.src,e.listener,t)},r.proxy=n,n.src=e,n.listener=r,e.addEventListener)S||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),n,i);else if(e.attachEvent)e.attachEvent($(t.toString()),n);else if(e.addListener&&e.removeListener)e.addListener(n);else throw Error("addEventListener and attachEvent are unavailable.");return j++,r}function G(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[P])F(t.i,e);else{var r=e.type,n=e.proxy;t.removeEventListener?t.removeEventListener(r,n,e.capture):t.detachEvent?t.detachEvent($(r),n):t.addListener&&t.removeListener&&t.removeListener(n),j--,(r=K(t))?(F(r,e),0==r.h&&(r.src=null,t[q]=null)):D(e)}}}function $(e){return e in B?B[e]:B[e]="on"+e}function H(e,t){if(e.da)e=!0;else{t=new R(t,this);let r=e.listener,n=e.ha||e.src;e.fa&&G(e),e=r.call(n,t)}return e}function K(e){return(e=e[q])instanceof V?e:null}var W="__closure_events_fn_"+(1e9*Math.random()>>>0);function Q(e){return"function"==typeof e?e:(e[W]||(e[W]=function(t){return e.handleEvent(t)}),e[W])}function J(){b.call(this),this.i=new V(this),this.M=this,this.G=null}function Y(e,t){let r,n;var i,s=e.G;if(s)for(i=[];s;s=s.G)i.push(s);if(e=e.M,s=t.type||t,"string"==typeof t)t=new A(t,e);else if(t instanceof A)t.target=t.target||e;else{var a=t;M(t=new A(s,e),a)}if(a=!0,i)for(n=i.length-1;n>=0;n--)a=X(r=t.g=i[n],s,!0,t)&&a;if(a=X(r=t.g=e,s,!0,t)&&a,a=X(r,s,!1,t)&&a,i)for(n=0;n<i.length;n++)a=X(r=t.g=i[n],s,!1,t)&&a}function X(e,t,r,n){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let i=!0;for(let s=0;s<t.length;++s){let a=t[s];if(a&&!a.da&&a.capture==r){let t=a.listener,r=a.ha||a.src;a.fa&&F(e.i,a),i=!1!==t.call(r,n)&&i}}return i&&!n.defaultPrevented}f(J,b),J.prototype[P]=!0,J.prototype.removeEventListener=function(e,t,r,n){!function e(t,r,n,i,s){if(Array.isArray(r))for(var a=0;a<r.length;a++)e(t,r[a],n,i,s);else(i=u(i)?!!i.capture:!!i,n=Q(n),t&&t[P])?(t=t.i,(a=String(r).toString())in t.g&&(n=U(r=t.g[a],n,i,s))>-1&&(D(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete t.g[a],t.h--))):t&&(t=K(t))&&(r=t.g[r.toString()],t=-1,r&&(t=U(r,n,i,s)),(n=t>-1?r[t]:null)&&G(n))}(this,e,t,r,n)},J.prototype.N=function(){if(J.Z.N.call(this),this.i){var e=this.i;for(let t in e.g){let r=e.g[t];for(let e=0;e<r.length;e++)D(r[e]);delete e.g[t],e.h--}}this.G=null},J.prototype.J=function(e,t,r,n){return this.i.add(String(e),t,!1,r,n)},J.prototype.K=function(e,t,r,n){return this.i.add(String(e),t,!0,r,n)};class Z extends b{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:function e(t){t.g=function(e,t){if("function"!=typeof e)if(e&&"function"==typeof e.handleEvent)e=h(e.handleEvent,e);else throw Error("Invalid listener argument");return Number(t)>0x7fffffff?-1:l.setTimeout(e,t||0)}(()=>{t.g=null,t.i&&(t.i=!1,e(t))},t.l);let r=t.h;t.h=null,t.m.apply(null,r)}(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ee(e){b.call(this),this.h=e,this.g={}}f(ee,b);var et=[];function er(e){x(e.g,function(e,t){this.g.hasOwnProperty(t)&&G(e)},e),e.g={}}ee.prototype.N=function(){ee.Z.N.call(this),er(this)},ee.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var en=l.JSON.stringify,ei=l.JSON.parse,es=class{stringify(e){return l.JSON.stringify(e,void 0)}parse(e){return l.JSON.parse(e,void 0)}};function ea(){}function eo(){}var el={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function eu(){A.call(this,"d")}function ec(){A.call(this,"c")}f(eu,A),f(ec,A);var eh={},ed=null;function ef(){return ed=ed||new J}function ep(e){A.call(this,eh.Ia,e)}function em(e){let t=ef();Y(t,new ep(t,e))}function eg(e,t){A.call(this,eh.STAT_EVENT,e),this.stat=t}function ey(e){let t=ef();Y(t,new eg(t,e))}function e_(e,t){A.call(this,eh.Ja,e),this.size=t}function ev(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){e()},t)}function ew(){this.g=!0}function eI(e,t,r,n){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{let s=JSON.parse(t);if(s){for(e=0;e<s.length;e++)if(Array.isArray(s[e])){var r=s[e];if(!(r.length<2)){var n=r[1];if(Array.isArray(n)&&!(n.length<1)){var i=n[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(let e=1;e<n.length;e++)n[e]=""}}}}return en(s)}catch(e){return t}}(e,r)+(n?" "+n:"")})}eh.Ia="serverreachability",f(ep,A),eh.STAT_EVENT="statevent",f(eg,A),eh.Ja="timingevent",f(e_,A),ew.prototype.ua=function(){this.g=!1},ew.prototype.info=function(){};var eE={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},eT={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function eb(){}function eA(e){return encodeURIComponent(String(e))}function eS(e,t,r,n){this.j=e,this.i=t,this.l=r,this.S=n||1,this.V=new ee(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new eC}function eC(){this.i=null,this.g="",this.h=!1}f(eb,ea),eb.prototype.g=function(){return new XMLHttpRequest},r=new eb;var eR={},eP={};function ek(e,t,r){e.M=1,e.A=e0(eQ(t)),e.u=r,e.R=!0,eN(e,null)}function eN(e,t){e.F=Date.now(),ex(e),e.B=eQ(e.A);var r,n,i,s,a,o,l=e.B,c=e.S;Array.isArray(c)||(c=[String(c)]),ti(l.i,"t",c),e.C=0,l=e.j.L,e.h=new eC,e.g=tG(e.j,l?t:null,!e.u),e.P>0&&(e.O=new Z(h(e.Y,e,e.g),e.P)),t=e.V,l=e.g,c=e.ba;var d="readystatechange";Array.isArray(d)||(d&&(et[0]=d.toString()),d=et);for(let e=0;e<d.length;e++){let r=function e(t,r,n,i,s){if(i&&i.once)return function e(t,r,n,i,s){if(Array.isArray(r)){for(let a=0;a<r.length;a++)e(t,r[a],n,i,s);return null}return n=Q(n),t&&t[P]?t.K(r,n,u(i)?!!i.capture:!!i,s):z(t,r,n,!0,i,s)}(t,r,n,i,s);if(Array.isArray(r)){for(let a=0;a<r.length;a++)e(t,r[a],n,i,s);return null}return n=Q(n),t&&t[P]?t.J(r,n,u(i)?!!i.capture:!!i,s):z(t,r,n,!1,i,s)}(l,d[e],c||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}t=e.J?O(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),em(1),r=e.i,n=e.v,i=e.B,s=e.l,a=e.S,o=e.u,r.info(function(){if(r.g)if(o){var e="",t=o.split("&");for(let r=0;r<t.length;r++){var l=t[r].split("=");if(l.length>1){let t=l[0];l=l[1];let r=t.split("_");e=r.length>=2&&"type"==r[1]?e+(t+"=")+l+"&":e+(t+"=redacted&")}}}else e=null;else e=o;return"XMLHTTP REQ ("+s+") [attempt "+a+"]: "+n+"\n"+i+"\n"+e})}function eD(e){return!!e.g&&"GET"==e.v&&2!=e.M&&e.j.Aa}function ex(e){e.T=Date.now()+e.H,eO(e,e.H)}function eO(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=ev(h(e.aa,e),t)}function eL(e){e.D&&(l.clearTimeout(e.D),e.D=null)}function eM(e){0==e.j.I||e.K||tU(e.j,e)}function eV(e){eL(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,er(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function eF(e,t){try{var r=e.j;if(0!=r.I&&(r.g==e||ez(r.h,e))){if(!e.L&&ez(r.h,e)&&3==r.I){try{var n=r.Ba.g.parse(t)}catch(e){n=null}if(Array.isArray(n)&&3==n.length){var i=n;if(0==i[0]){e:if(!r.v){if(r.g)if(r.g.F+3e3<e.F)tF(r),tR(r);else break e;tL(r),ey(18)}}else r.xa=i[1],0<r.xa-r.K&&i[2]<37500&&r.F&&0==r.A&&!r.C&&(r.C=ev(h(r.Va,r),6e3));1>=ej(r.h)&&r.ta&&(r.ta=void 0)}else tB(r,11)}else if((e.L||r.g==e)&&tF(r),!C(t))for(i=r.Ba.g.parse(t),t=0;t<i.length;t++){let o=i[t],l=o[0];if(!(l<=r.K))if(r.K=l,o=o[1],2==r.I)if("c"==o[0]){r.M=o[1],r.ba=o[2];let t=o[3];null!=t&&(r.ka=t,r.j.info("VER="+r.ka));let i=o[4];null!=i&&(r.za=i,r.j.info("SVER="+r.za));let l=o[5];null!=l&&"number"==typeof l&&l>0&&(r.O=n=1.5*l,r.j.info("backChannelRequestTimeoutMs_="+n)),n=r;let u=e.g;if(u){let e=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=n.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(eG(s,s.h),s.h=null))}if(n.G){let e=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(n.wa=e,eZ(n.J,n.G,e))}}if(r.I=3,r.l&&r.l.ra(),r.aa&&(r.T=Date.now()-e.F,r.j.info("Handshake RTT: "+r.T+"ms")),(n=r).na=tz(n,n.L?n.ba:null,n.W),e.L){e$(n.h,e);var a=n.O;a&&(e.H=a),e.D&&(eL(e),ex(e)),n.g=e}else tO(n);r.i.length>0&&tk(r)}else"stop"!=o[0]&&"close"!=o[0]||tB(r,7);else 3==r.I&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?tB(r,7):tC(r):"noop"!=o[0]&&r.l&&r.l.qa(o),r.A=0)}}em(4)}catch(e){}}eS.prototype.ba=function(e){e=e.target;let t=this.O;t&&3==tT(e)?t.j():this.Y(e)},eS.prototype.Y=function(e){try{if(e==this.g)e:{let f=tT(this.g),p=this.g.ya(),m=this.g.ca();if(!(f<3)&&(3!=f||this.g&&(this.h.h||this.g.la()||tb(this.g)))){this.K||4!=f||7==p||(8==p||m<=0?em(3):em(2)),eL(this);var t=this.g.ca();this.X=t;var r=function(e){if(!eD(e))return e.g.la();let t=tb(e.g);if(""===t)return"";let r="",n=t.length,i=4==tT(e.g);if(!e.h.i){if("undefined"==typeof TextDecoder)return eV(e),eM(e),"";e.h.i=new l.TextDecoder}for(let s=0;s<n;s++)e.h.h=!0,r+=e.h.i.decode(t[s],{stream:!(i&&s==n-1)});return t.length=0,e.h.g+=r,e.C=0,e.h.g}(this);if(this.o=200==t,n=this.i,i=this.v,s=this.B,a=this.l,o=this.S,n.info(function(){return"XMLHTTP RESP ("+a+") [ attempt "+o+"]: "+i+"\n"+s+"\n"+f+" "+t}),this.o){if(this.U&&!this.L){t:{if(this.g){var n,i,s,a,o,u,c=this.g;if((u=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(u)){var h=u;break t}}h=null}if(e=h)eI(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,eF(this,e);else{this.o=!1,this.m=3,ey(12),eV(this),eM(this);break e}}if(this.R){let t;for(e=!0;!this.K&&this.C<r.length;)if((t=function(e,t){var r=e.C,n=t.indexOf("\n",r);return -1==n?eP:isNaN(r=Number(t.substring(r,n)))?eR:(n+=1)+r>t.length?eP:(t=t.slice(n,n+r),e.C=n+r,t)}(this,r))==eP){4==f&&(this.m=4,ey(14),e=!1),eI(this.i,this.l,null,"[Incomplete Response]");break}else if(t==eR){this.m=4,ey(15),eI(this.i,this.l,r,"[Invalid Chunk]"),e=!1;break}else eI(this.i,this.l,t,null),eF(this,t);if(eD(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=f||0!=r.length||this.h.h||(this.m=1,ey(16),e=!1),this.o=this.o&&e,e){if(r.length>0&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.aa&&!d.P&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+r.length),tM(d),d.P=!0,ey(11))}}else eI(this.i,this.l,r,"[Invalid Chunked Response]"),eV(this),eM(this)}else eI(this.i,this.l,r,null),eF(this,r);4==f&&eV(this),this.o&&!this.K&&(4==f?tU(this.j,this):(this.o=!1,ex(this)))}else(function(e){let t={};e=(e.g&&tT(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<e.length;n++){if(C(e[n]))continue;var r=function(e){var t=1;e=e.split(":");let r=[];for(;t>0&&e.length;)r.push(e.shift()),t--;return e.length&&r.push(e.join(":")),r}(e[n]);let i=r[0];if("string"!=typeof(r=r[1]))continue;r=r.trim();let s=t[i]||[];t[i]=s,s.push(r)}var n=function(e){return e.join(", ")};for(let e in t)n.call(void 0,t[e],e,t)})(this.g),400==t&&r.indexOf("Unknown SID")>0?(this.m=3,ey(12)):(this.m=0,ey(13)),eV(this),eM(this)}}}catch(e){}finally{}},eS.prototype.cancel=function(){this.K=!0,eV(this)},eS.prototype.aa=function(){var e,t;this.D=null;let r=Date.now();r-this.T>=0?(e=this.i,t=this.B,e.info(function(){return"TIMEOUT: "+t}),2!=this.M&&(em(3),ey(17)),eV(this),this.m=2,eM(this)):eO(this,this.T-r)};var eU=class{constructor(e,t){this.g=e,this.map=t}};function eq(e){this.l=e||10,e=l.PerformanceNavigationTiming?(e=l.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function eB(e){return!!e.h||!!e.g&&e.g.size>=e.j}function ej(e){return e.h?1:e.g?e.g.size:0}function ez(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function eG(e,t){e.g?e.g.add(t):e.h=t}function e$(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function eH(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(let r of e.g.values())t=t.concat(r.G);return t}return m(e.i)}eq.prototype.cancel=function(){if(this.i=eH(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(let e of this.g.values())e.cancel();this.g.clear()}};var eK=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function eW(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof eW?(this.l=e.l,eJ(this,e.j),this.o=e.o,this.g=e.g,eY(this,e.u),this.h=e.h,eX(this,ts(e.i)),this.m=e.m):e&&(t=String(e).match(eK))?(this.l=!1,eJ(this,t[1]||"",!0),this.o=e1(t[2]||""),this.g=e1(t[3]||"",!0),eY(this,t[4]),this.h=e1(t[5]||"",!0),eX(this,t[6]||"",!0),this.m=e1(t[7]||"")):(this.l=!1,this.i=new e9(null,this.l))}function eQ(e){return new eW(e)}function eJ(e,t,r){e.j=r?e1(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function eY(e,t){if(t){if(isNaN(t=Number(t))||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function eX(e,t,r){var n,i;t instanceof e9?(e.i=t,n=e.i,(i=e.l)&&!n.j&&(te(n),n.i=null,n.g.forEach(function(e,t){let r=t.toLowerCase();t!=r&&(tt(this,t),ti(this,r,e))},n)),n.j=i):(r||(t=e2(t,e8)),e.i=new e9(t,e.l))}function eZ(e,t,r){e.i.set(t,r)}function e0(e){return eZ(e,"zx",Math.floor(0x80000000*Math.random()).toString(36)+Math.abs(Math.floor(0x80000000*Math.random())^Date.now()).toString(36)),e}function e1(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function e2(e,t,r){return"string"==typeof e?(e=encodeURI(e).replace(t,e6),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function e6(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}eW.prototype.toString=function(){let e=[];var t=this.j;t&&e.push(e2(t,e3,!0),":");var r=this.g;return(r||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(e2(t,e3,!0),"@"),e.push(eA(r).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(r=this.u)&&e.push(":",String(r))),(r=this.h)&&(this.g&&"/"!=r.charAt(0)&&e.push("/"),e.push(e2(r,"/"==r.charAt(0)?e5:e4,!0))),(r=this.i.toString())&&e.push("?",r),(r=this.m)&&e.push("#",e2(r,e7)),e.join("")},eW.prototype.resolve=function(e){let t=eQ(this),r=!!e.j;r?eJ(t,e.j):r=!!e.o,r?t.o=e.o:r=!!e.g,r?t.g=e.g:r=null!=e.u;var n=e.h;if(r)eY(t,e.u);else if(r=!!e.h){if("/"!=n.charAt(0))if(this.g&&!this.h)n="/"+n;else{var i=t.h.lastIndexOf("/");-1!=i&&(n=t.h.slice(0,i+1)+n)}if(".."==(i=n)||"."==i)n="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){n=0==i.lastIndexOf("/",0),i=i.split("/");let e=[];for(let t=0;t<i.length;){let r=i[t++];"."==r?n&&t==i.length&&e.push(""):".."==r?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),n&&t==i.length&&e.push("")):(e.push(r),n=!0)}n=e.join("/")}else n=i}return r?t.h=n:r=""!==e.i.toString(),r?eX(t,ts(e.i)):r=!!e.m,r&&(t.m=e.m),t};var e3=/[#\/\?@]/g,e4=/[#\?:]/g,e5=/[#\?]/g,e8=/[#\?@]/g,e7=/#/g;function e9(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function te(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let r=0;r<e.length;r++){let n=e[r].indexOf("="),i,s=null;n>=0?(i=e[r].substring(0,n),s=e[r].substring(n+1)):i=e[r],t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,function(t,r){e.add(decodeURIComponent(t.replace(/\+/g," ")),r)}))}function tt(e,t){te(e),t=ta(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function tr(e,t){return te(e),t=ta(e,t),e.g.has(t)}function tn(e,t){te(e);let r=[];if("string"==typeof t)tr(e,t)&&(r=r.concat(e.g.get(ta(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)r=r.concat(e[t]);return r}function ti(e,t,r){tt(e,t),r.length>0&&(e.i=null,e.g.set(ta(e,t),m(r)),e.h+=r.length)}function ts(e){let t=new e9;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function ta(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function to(e,t,r,n,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),n(r)}catch(e){}}function tl(){this.g=new es}function tu(e){this.i=e.Sb||null,this.h=e.ab||!1}function tc(e,t){J.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function th(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function td(e){e.readyState=4,e.l=null,e.j=null,e.B=null,tf(e)}function tf(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function tp(e){let t="";return x(e,function(e,r){t+=r,t+=":",t+=e,t+="\r\n"}),t}function tm(e,t,r){e:{for(n in r){var n=!1;break e}n=!0}n||(r=tp(r),"string"==typeof e?(eA(t),null!=r&&eA(r)):eZ(e,t,r))}function tg(e){J.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(n=e9.prototype).add=function(e,t){te(this),this.i=null,e=ta(this,e);let r=this.g.get(e);return r||this.g.set(e,r=[]),r.push(t),this.h+=1,this},n.forEach=function(e,t){te(this),this.g.forEach(function(r,n){r.forEach(function(r){e.call(t,r,n,this)},this)},this)},n.set=function(e,t){return te(this),this.i=null,tr(this,e=ta(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},n.get=function(e,t){return e&&(e=tn(this,e)).length>0?String(e[0]):t},n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let e=[],t=Array.from(this.g.keys());for(let n=0;n<t.length;n++){var r=t[n];let i=eA(r);r=tn(this,r);for(let t=0;t<r.length;t++){let n=i;""!==r[t]&&(n+="="+eA(r[t])),e.push(n)}}return this.i=e.join("&")},f(tu,ea),tu.prototype.g=function(){return new tc(this.i,this.h)},f(tc,J),(n=tc.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,tf(this)},n.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||l).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,td(this)),this.readyState=0},n.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,tf(this)),this.g&&(this.readyState=3,tf(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(void 0!==l.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;th(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},n.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?td(this):tf(this),3==this.readyState&&th(this)}},n.Oa=function(e){this.g&&(this.response=this.responseText=e,td(this))},n.Na=function(e){this.g&&(this.response=e,td(this))},n.ga=function(){this.g&&td(this)},n.setRequestHeader=function(e,t){this.A.append(e,t)},n.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let e=[],t=this.h.entries();for(var r=t.next();!r.done;)e.push((r=r.value)[0]+": "+r[1]),r=t.next();return e.join("\r\n")},Object.defineProperty(tc.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),f(tg,J);var ty=/^https?$/i,t_=["POST","PUT"];function tv(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,tw(e),tE(e)}function tw(e){e.A||(e.A=!0,Y(e,"complete"),Y(e,"error"))}function tI(e){if(e.h&&void 0!==o){if(e.v&&4==tT(e))setTimeout(e.Ca.bind(e),0);else if(Y(e,"readystatechange"),4==tT(e)){e.h=!1;try{let s=e.ca();switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t,r,n=!0;break;default:n=!1}if(!(t=n)){if(r=0===s){let t=String(e.D).match(eK)[1]||null;!t&&l.self&&l.self.location&&(t=l.self.location.protocol.slice(0,-1)),r=!ty.test(t?t.toLowerCase():"")}t=r}if(t)Y(e,"complete"),Y(e,"success");else{e.o=6;try{var i=tT(e)>2?e.g.statusText:""}catch(e){i=""}e.l=i+" ["+e.ca()+"]",tw(e)}}finally{tE(e)}}}}function tE(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);let r=e.g;e.g=null,t||Y(e,"ready");try{r.onreadystatechange=null}catch(e){}}}function tT(e){return e.g?e.g.readyState:0}function tb(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function tA(e,t,r){return r&&r.internalChannelParams&&r.internalChannelParams[e]||t}function tS(e){this.za=0,this.i=[],this.j=new ew,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=tA("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=tA("baseRetryDelayMs",5e3,e),this.Za=tA("retryDelaySeedMs",1e4,e),this.Ta=tA("forwardChannelMaxRetries",2,e),this.va=tA("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new eq(e&&e.concurrentRequestLimit),this.Ba=new tl,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function tC(e){if(tP(e),3==e.I){var t=e.V++,r=eQ(e.J);if(eZ(r,"SID",e.M),eZ(r,"RID",t),eZ(r,"TYPE","terminate"),tD(e,r),(t=new eS(e,e.j,t)).M=2,t.A=e0(eQ(r)),r=!1,l.navigator&&l.navigator.sendBeacon)try{r=l.navigator.sendBeacon(t.A.toString(),"")}catch(e){}!r&&l.Image&&((new Image).src=t.A,r=!0),r||(t.g=tG(t.j,null),t.g.ea(t.A)),t.F=Date.now(),ex(t)}tj(e)}function tR(e){e.g&&(tM(e),e.g.cancel(),e.g=null)}function tP(e){tR(e),e.v&&(l.clearTimeout(e.v),e.v=null),tF(e),e.h.cancel(),e.m&&("number"==typeof e.m&&l.clearTimeout(e.m),e.m=null)}function tk(e){if(!eB(e.h)&&!e.m){e.m=!0;var t=e.Ea;v||E(),w||(v(),w=!0),I.add(t,e),e.D=0}}function tN(e,t){var r;r=t?t.l:e.V++;let n=eQ(e.J);eZ(n,"SID",e.M),eZ(n,"RID",r),eZ(n,"AID",e.K),tD(e,n),e.u&&e.o&&tm(n,e.u,e.o),r=new eS(e,e.j,r,e.D+1),null===e.u&&(r.J=e.o),t&&(e.i=t.G.concat(e.i)),t=tx(e,r,1e3),r.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),eG(e.h,r),ek(r,n,t)}function tD(e,t){e.H&&x(e.H,function(e,r){eZ(t,r,e)}),e.l&&x({},function(e,r){eZ(t,r,e)})}function tx(e,t,r){r=Math.min(e.i.length,r);let n=e.l?h(e.l.Ka,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){let e=["count="+r];-1==t?r>0?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let o=!0;for(let l=0;l<r;l++){var s=i[l].g;let r=i[l].map;if((s-=t)<0)t=Math.max(0,i[l].g-100),o=!1;else try{s="req"+s+"_";try{var a=r instanceof Map?r:Object.entries(r);for(let[t,r]of a){let n=r;u(r)&&(n=en(r)),e.push(s+t+"="+encodeURIComponent(n))}}catch(t){throw e.push(s+"type="+encodeURIComponent("_badmap")),t}}catch(e){n&&n(r)}}if(o){a=e.join("&");break e}}a=void 0}return t.G=e=e.i.splice(0,r),a}function tO(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;v||E(),w||(v(),w=!0),I.add(t,e),e.A=0}}function tL(e){return!e.g&&!e.v&&!(e.A>=3)&&(e.Y++,e.v=ev(h(e.Da,e),tq(e,e.A)),e.A++,!0)}function tM(e){null!=e.B&&(l.clearTimeout(e.B),e.B=null)}function tV(e){e.g=new eS(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=eQ(e.na);eZ(t,"RID","rpc"),eZ(t,"SID",e.M),eZ(t,"AID",e.K),eZ(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&eZ(t,"TO",e.ia),eZ(t,"TYPE","xmlhttp"),tD(e,t),e.u&&e.o&&tm(t,e.u,e.o),e.O&&(e.g.H=e.O);var r=e.g;e=e.ba,r.M=1,r.A=e0(eQ(t)),r.u=null,r.R=!0,eN(r,e)}function tF(e){null!=e.C&&(l.clearTimeout(e.C),e.C=null)}function tU(e,t){var r,n=null;if(e.g==t){tF(e),tM(e),e.g=null;var i=2}else{if(!ez(e.h,t))return;n=t.G,e$(e.h,t),i=1}if(0!=e.I){if(t.o)if(1==i){n=t.u?t.u.length:0,t=Date.now()-t.F;var s=e.D;Y(i=ef(),new e_(i,n,t,s)),tk(e)}else tO(e);else if(3==(s=t.m)||0==s&&t.X>0||!(1==i&&(r=t,!(ej(e.h)>=e.h.j-!!e.m)&&(e.m?(e.i=r.G.concat(e.i),!0):1!=e.I&&2!=e.I&&!(e.D>=(e.Sa?0:e.Ta))&&(e.m=ev(h(e.Ea,e,r),tq(e,e.D)),e.D++,!0)))||2==i&&tL(e)))switch(n&&n.length>0&&((t=e.h).i=t.i.concat(n)),s){case 1:tB(e,5);break;case 4:tB(e,10);break;case 3:tB(e,6);break;default:tB(e,2)}}}function tq(e,t){let r=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(r*=2),r*t}function tB(e,t){if(e.j.info("Error code "+t),2==t){let t,s,a;var r,n=h(e.bb,e),i=e.Ua;let o=!i;i=new eW(i||"//www.google.com/images/cleardot.gif"),l.location&&"http"==l.location.protocol||eJ(i,"https"),e0(i),o?function(e,t){let r=new ew;if(l.Image){let n=new Image;n.onload=d(to,r,"TestLoadImage: loaded",!0,t,n),n.onerror=d(to,r,"TestLoadImage: error",!1,t,n),n.onabort=d(to,r,"TestLoadImage: abort",!1,t,n),n.ontimeout=d(to,r,"TestLoadImage: timeout",!1,t,n),l.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=e}else t(!1)}(i.toString(),n):(r=i.toString(),t=new ew,s=new AbortController,a=setTimeout(()=>{s.abort(),to(t,"TestPingServer: timeout",!1,n)},1e4),fetch(r,{signal:s.signal}).then(e=>{clearTimeout(a),e.ok?to(t,"TestPingServer: ok",!0,n):to(t,"TestPingServer: server error",!1,n)}).catch(()=>{clearTimeout(a),to(t,"TestPingServer: error",!1,n)}))}else ey(2);e.I=0,e.l&&e.l.pa(t),tj(e),tP(e)}function tj(e){if(e.I=0,e.ja=[],e.l){let t=eH(e.h);(0!=t.length||0!=e.i.length)&&(g(e.ja,t),g(e.ja,e.i),e.h.i.length=0,m(e.i),e.i.length=0),e.l.oa()}}function tz(e,t,r){var n=r instanceof eW?eQ(r):new eW(r);if(""!=n.g)t&&(n.g=t+"."+n.g),eY(n,n.u);else{var i=l.location;n=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;let e=new eW(null);n&&eJ(e,n),t&&(e.g=t),i&&eY(e,i),r&&(e.h=r),n=e}return r=e.G,t=e.wa,r&&t&&eZ(n,r,t),eZ(n,"VER",e.ka),tD(e,n),n}function tG(e,t,r){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new tg(e.Aa&&!e.ma?new tu({ab:r}):e.ma)).Fa(e.L),t}function t$(){}function tH(){}function tK(e,t){J.call(this),this.g=new tS(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!C(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!C(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new tJ(this)}function tW(e){eu.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(let r in t){e=r;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function tQ(){ec.call(this),this.status=1}function tJ(e){this.g=e}(n=tg.prototype).Fa=function(e){this.H=e},n.ea=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():r.g(),this.g.onreadystatechange=p(h(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(e){tv(this,e);return}if(e=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var s in i)n.set(s,i[s]);else if("function"==typeof i.keys&&"function"==typeof i.get)for(let e of i.keys())n.set(e,i.get(e));else throw Error("Unknown input type for opt_headers: "+String(i));for(let[r,a]of(i=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),s=l.FormData&&e instanceof l.FormData,!(Array.prototype.indexOf.call(t_,t,void 0)>=0)||i||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),n))this.g.setRequestHeader(r,a);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(e),this.v=!1}catch(e){tv(this,e)}},n.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,Y(this,"complete"),Y(this,"abort"),tE(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),tE(this,!0)),tg.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?tI(this):this.Xa())},n.Xa=function(){tI(this)},n.isActive=function(){return!!this.g},n.ca=function(){try{return tT(this)>2?this.g.status:-1}catch(e){return -1}},n.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},n.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),ei(t)}},n.ya=function(){return this.o},n.Ha=function(){return"string"==typeof this.l?this.l:String(this.l)},(n=tS.prototype).ka=8,n.I=1,n.connect=function(e,t,r,n){ey(0),this.W=e,this.H=t||{},r&&void 0!==n&&(this.H.OSID=r,this.H.OAID=n),this.F=this.X,this.J=tz(this,null,this.W),tk(this)},n.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;let i=new eS(this,this.j,e),s=this.o;if(this.U&&(s?M(s=O(s),this.U):s=this.U),null!==this.u||this.R||(i.J=s,s=null),this.S)e:{for(var t=0,r=0;r<this.i.length;r++){t:{var n=this.i[r];if("__data__"in n.map&&"string"==typeof(n=n.map.__data__)){n=n.length;break t}n=void 0}if(void 0===n)break;if((t+=n)>4096){t=r;break e}if(4096===t||r===this.i.length-1){t=r+1;break e}}t=1e3}else t=1e3;t=tx(this,i,t),eZ(r=eQ(this.J),"RID",e),eZ(r,"CVER",22),this.G&&eZ(r,"X-HTTP-Session-Id",this.G),tD(this,r),s&&(this.R?t="headers="+eA(tp(s))+"&"+t:this.u&&tm(r,this.u,s)),eG(this.h,i),this.Ra&&eZ(r,"TYPE","init"),this.S?(eZ(r,"$req",t),eZ(r,"SID","null"),i.U=!0,ek(i,r,null)):ek(i,r,t),this.I=2}}else 3==this.I&&(e?tN(this,e):0==this.i.length||eB(this.h)||tN(this))},n.Da=function(){if(this.v=null,tV(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=ev(h(this.Wa,this),e)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ey(10),tR(this),tV(this))},n.Va=function(){null!=this.C&&(this.C=null,tR(this),tL(this),ey(19))},n.bb=function(e){e?(this.j.info("Successfully pinged google.com"),ey(2)):(this.j.info("Failed to ping google.com"),ey(1))},n.isActive=function(){return!!this.l&&this.l.isActive(this)},(n=t$.prototype).ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){},tH.prototype.g=function(e,t){return new tK(e,t)},f(tK,J),tK.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},tK.prototype.close=function(){tC(this.g)},tK.prototype.o=function(e){var t=this.g;if("string"==typeof e){var r={};r.__data__=e,e=r}else this.v&&((r={}).__data__=en(e),e=r);t.i.push(new eU(t.Ya++,e)),3==t.I&&tk(t)},tK.prototype.N=function(){this.g.l=null,delete this.j,tC(this.g),delete this.g,tK.Z.N.call(this)},f(tW,eu),f(tQ,ec),f(tJ,t$),tJ.prototype.ra=function(){Y(this.g,"a")},tJ.prototype.qa=function(e){Y(this.g,new tW(e))},tJ.prototype.pa=function(e){Y(this.g,new tQ(e))},tJ.prototype.oa=function(){Y(this.g,"b")},tH.prototype.createWebChannel=tH.prototype.g,tK.prototype.send=tK.prototype.o,tK.prototype.open=tK.prototype.m,tK.prototype.close=tK.prototype.close,t.exports.createWebChannelTransport=function(){return new tH},t.exports.getStatEventTarget=function(){return ef()},t.exports.Event=eh,t.exports.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},eE.NO_ERROR=0,eE.TIMEOUT=8,eE.HTTP_ERROR=6,t.exports.ErrorCode=eE,eT.COMPLETE="complete",t.exports.EventType=eT,eo.EventType=el,el.OPEN="a",el.CLOSE="b",el.ERROR="c",el.MESSAGE="d",J.prototype.listen=J.prototype.J,t.exports.WebChannel=eo,t.exports.FetchXmlHttpFactory=tu,tg.prototype.listenOnce=tg.prototype.K,tg.prototype.getLastError=tg.prototype.Ha,tg.prototype.getLastErrorCode=tg.prototype.ya,tg.prototype.getStatus=tg.prototype.ca,tg.prototype.getResponseJson=tg.prototype.La,tg.prototype.getResponseText=tg.prototype.la,tg.prototype.send=tg.prototype.ea,tg.prototype.setWithCredentials=tg.prototype.Fa,t.exports.XhrIo=tg}).apply(e.g)},771821,(e,t,r)=>{"use strict";var n,i,s,a,o=e.i(151495),l=e.i(37283),u=e.r(336952),c=e.r(650043),h=e.r(848720),d=e.r(601402),f=e.r(301207);class p{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}p.UNAUTHENTICATED=new p(null),p.GOOGLE_CREDENTIALS=new p("google-credentials-uid"),p.FIRST_PARTY=new p("first-party-uid"),p.MOCK_USER=new p("mock-user");let m="12.8.0",g=new d.Logger("@firebase/firestore");function y(){return g.logLevel}function _(e,...t){if(g.logLevel<=d.LogLevel.DEBUG){let r=t.map(I);g.debug(`Firestore (${m}): ${e}`,...r)}}function v(e,...t){if(g.logLevel<=d.LogLevel.ERROR){let r=t.map(I);g.error(`Firestore (${m}): ${e}`,...r)}}function w(e,...t){if(g.logLevel<=d.LogLevel.WARN){let r=t.map(I);g.warn(`Firestore (${m}): ${e}`,...r)}}function I(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function E(e,t,r){let n="Unexpected state";"string"==typeof t?n=t:r=t,T(e,n,r)}function T(e,t,r){let n=`FIRESTORE (${m}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==r)try{n+=" CONTEXT: "+JSON.stringify(r)}catch(e){n+=" CONTEXT: "+r}throw v(n),Error(n)}function b(e,t,r,n){let i="Unexpected state";"string"==typeof r?i=r:n=r,e||T(t,i,n)}let A={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class S extends c.FirebaseError{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class C{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class R{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class P{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(p.UNAUTHENTICATED))}shutdown(){}}class k{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class N{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=p.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);let e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class D{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new N(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(p.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class x{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class O{static newId(){let e=62*Math.floor(256/62),t="";for(;t.length<20;){let r=function(e){let t="undefined"!=typeof self&&(self.crypto||self.msCrypto),r=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(r);else for(let e=0;e<40;e++)r[e]=Math.floor(256*Math.random());return r}(0);for(let n=0;n<r.length;++n)t.length<20&&r[n]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(r[n]%62))}return t}}function L(e,t){return e<t?-1:+(e>t)}function M(e,t){let r=Math.min(e.length,t.length);for(let n=0;n<r;n++){let r=e.charAt(n),i=t.charAt(n);if(r!==i)return V(r)===V(i)?L(r,i):V(r)?1:-1}return L(e.length,t.length)}function V(e){let t=e.charCodeAt(0);return t>=55296&&t<=57343}function F(e,t,r){return e.length===t.length&&e.every((e,n)=>r(e,t[n]))}let U="__name__";class q{constructor(e,t,r){void 0===t?t=0:t>e.length&&E(637,{offset:t,range:e.length}),void 0===r?r=e.length-t:r>e.length-t&&E(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===q.comparator(this,e)}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof q?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let n=0;n<r;n++){let r=q.compareSegments(e.get(n),t.get(n));if(0!==r)return r}return L(e.length,t.length)}static compareSegments(e,t){let r=q.isNumericId(e),n=q.isNumericId(t);return r&&!n?-1:!r&&n?1:r&&n?q.extractNumericId(e).compare(q.extractNumericId(t)):M(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return h.Integer.fromString(e.substring(4,e.length-2))}}class B extends q{construct(e,t,r){return new B(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new S(A.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(e=>e.length>0))}return new B(t)}static emptyPath(){return new B([])}}let j=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class z extends q{construct(e,t,r){return new z(e,t,r)}static isValidIdentifier(e){return j.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),z.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===U}static keyField(){return new z([U])}static fromServerFormat(e){let t=[],r="",n=0,i=()=>{if(0===r.length)throw new S(A.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;n<e.length;){let t=e[n];if("\\"===t){if(n+1===e.length)throw new S(A.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let t=e[n+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new S(A.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=t,n+=2}else"`"===t?s=!s:"."!==t||s?r+=t:i(),n++}if(i(),s)throw new S(A.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new z(t)}static emptyPath(){return new z([])}}class G{constructor(e){this.path=e}static fromPath(e){return new G(B.fromString(e))}static fromName(e){return new G(B.fromString(e).popFirst(5))}static empty(){return new G(B.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===B.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return B.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new G(new B(e.slice()))}}function $(e,t,r){if(!r)throw new S(A.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function H(e,t,r,n){if(!0===t&&!0===n)throw new S(A.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)}function K(e){if(!G.isDocumentKey(e))throw new S(A.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function W(e){if(G.isDocumentKey(e))throw new S(A.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Q(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function J(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{var t;let r=(t=e).constructor?t.constructor.name:null;return r?`a custom ${r} object`:"an object"}}return"function"==typeof e?"a function":E(12329,{type:typeof e})}function Y(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new S(A.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let r=J(e);throw new S(A.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}function X(e,t){let r={typeString:e};return t&&(r.value=t),r}function Z(e,t){let r;if(!Q(e))throw new S(A.INVALID_ARGUMENT,"JSON must be an object");for(let n in t)if(t[n]){let i=t[n].typeString,s="value"in t[n]?{value:t[n].value}:void 0;if(!(n in e)){r=`JSON missing required field: '${n}'`;break}let a=e[n];if(i&&typeof a!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(void 0!==s&&a!==s.value){r=`Expected '${n}' field to equal '${s.value}'`;break}}if(r)throw new S(A.INVALID_ARGUMENT,r);return!0}class ee{static now(){return ee.fromMillis(Date.now())}static fromDate(e){return ee.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*1e6);return new ee(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0||t>=1e9)throw new S(A.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-0xe7791f700||e>=0x3afff44180)throw new S(A.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?L(this.nanoseconds,e.nanoseconds):L(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ee._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Z(e,ee._jsonSchema))return new ee(e.seconds,e.nanoseconds)}valueOf(){return String(this.seconds- -0xe7791f700).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ee._jsonSchemaVersion="firestore/timestamp/1.0",ee._jsonSchema={type:X("string",ee._jsonSchemaVersion),seconds:X("number"),nanoseconds:X("number")};class et{static fromTimestamp(e){return new et(e)}static min(){return new et(new ee(0,0))}static max(){return new et(new ee(0x3afff4417f,0x3b9ac9ff))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class er{constructor(e,t,r,n){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=n}}function en(e){return e.fields.find(e=>2===e.kind)}function ei(e){return e.fields.filter(e=>2!==e.kind)}function es(e,t){let r=L(e.collectionGroup,t.collectionGroup);if(0!==r)return r;for(let n=0;n<Math.min(e.fields.length,t.fields.length);++n)if(0!==(r=function(e,t){let r=z.comparator(e.fieldPath,t.fieldPath);return 0!==r?r:L(e.kind,t.kind)}(e.fields[n],t.fields[n])))return r;return L(e.fields.length,t.fields.length)}er.UNKNOWN_ID=-1;class ea{constructor(e,t){this.fieldPath=e,this.kind=t}}class eo{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new eo(0,ec.min())}}function el(e,t){let r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1;return new ec(et.fromTimestamp(1e9===n?new ee(r+1,0):new ee(r,n)),G.empty(),t)}function eu(e){return new ec(e.readTime,e.key,-1)}class ec{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ec(et.min(),G.empty(),-1)}static max(){return new ec(et.max(),G.empty(),-1)}}function eh(e,t){let r=e.readTime.compareTo(t.readTime);return 0!==r||0!==(r=G.comparator(e.documentKey,t.documentKey))?r:L(e.largestBatchId,t.largestBatchId)}let ed="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ef{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function ep(e){if(e.code!==A.FAILED_PRECONDITION||e.message!==ed)throw e;_("LocalStore","Unexpectedly lost primary lease")}class em{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&E(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new em((r,n)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(r,n)},this.catchCallback=e=>{this.wrapFailure(t,e).next(r,n)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof em?t:em.resolve(t)}catch(e){return em.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):em.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):em.reject(t)}static resolve(e){return new em((t,r)=>{t(e)})}static reject(e){return new em((t,r)=>{r(e)})}static waitFor(e){return new em((t,r)=>{let n=0,i=0,s=!1;e.forEach(e=>{++n,e.next(()=>{++i,s&&i===n&&t()},e=>r(e))}),s=!0,i===n&&t()})}static or(e){let t=em.resolve(!1);for(let r of e)t=t.next(e=>e?em.resolve(e):r());return t}static forEach(e,t){let r=[];return e.forEach((e,n)=>{r.push(t.call(this,e,n))}),this.waitFor(r)}static mapArray(e,t){return new em((r,n)=>{let i=e.length,s=Array(i),a=0;for(let o=0;o<i;o++){let l=o;t(e[l]).next(e=>{s[l]=e,++a===i&&r(s)},e=>n(e))}})}static doWhile(e,t){return new em((r,n)=>{let i=()=>{!0===e()?t().next(()=>{i()},n):r()};i()})}}let eg="SimpleDb";class ey{static open(e,t,r,n){try{return new ey(t,e.transaction(n,r))}catch(e){throw new eI(t,e)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new C,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new eI(e,t.error)):this.S.resolve()},this.transaction.onerror=t=>{let r=eS(t.target.error);this.S.reject(new eI(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(_(eg,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){let e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){return new eT(this.transaction.objectStore(e))}}class e_{static delete(e){return _(eg,"Removing database:",e),eb(c.getGlobal().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!c.isIndexedDBAvailable())return!1;if(e_.F())return!0;let e=c.getUA(),t=e_.M(e),r=ev(e);return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||0<t&&t<10||0<r&&r<4.5)}static F(){return void 0!==o.default&&"YES"===o.default.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE}static O(e,t){return e.store(t)}static M(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i);return Number(t?t[1].split("_").slice(0,2).join("."):"-1")}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,12.2===e_.M(c.getUA())&&v("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(_(eg,"Opening database:",this.name),this.db=await new Promise((t,r)=>{let n=indexedDB.open(this.name,this.version);n.onsuccess=e=>{t(e.target.result)},n.onblocked=()=>{r(new eI(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},n.onerror=t=>{let n=t.target.error;"VersionError"===n.name?r(new S(A.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new S(A.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new eI(e,n))},n.onupgradeneeded=e=>{_(eg,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);let t=e.target.result;this.N.k(t,n.transaction,e.oldVersion,this.version).next(()=>{_(eg,"Database upgrade to version "+this.version+" complete")})}})),this.K&&(this.db.onversionchange=e=>this.K(e)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,n){let i="readonly"===t,s=0;for(;;){++s;try{this.db=await this.L(e);let t=ey.open(this.db,e,i?"readonly":"readwrite",r),s=n(t).next(e=>(t.C(),e)).catch(e=>(t.abort(e),em.reject(e))).toPromise();return s.catch(()=>{}),await t.D,s}catch(t){let e="FirebaseError"!==t.name&&s<3;if(_(eg,"Transaction failed with error:",t.message,"Retrying:",e),this.close(),!e)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function ev(e){let t=e.match(/Android ([\d.]+)/i);return Number(t?t[1].split(".").slice(0,2).join("."):"-1")}class ew{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return eb(this.U.delete())}}class eI extends S{constructor(e,t){super(A.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function eE(e){return"IndexedDbTransactionError"===e.name}class eT{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(_(eg,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(_(eg,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),eb(r)}add(e){return _(eg,"ADD",this.store.name,e,e),eb(this.store.add(e))}get(e){return eb(this.store.get(e)).next(t=>(void 0===t&&(t=null),_(eg,"GET",this.store.name,e,t),t))}delete(e){return _(eg,"DELETE",this.store.name,e),eb(this.store.delete(e))}count(){return _(eg,"COUNT",this.store.name),eb(this.store.count())}H(e,t){let r=this.options(e,t),n=r.index?this.store.index(r.index):this.store;if("function"==typeof n.getAll){let e=n.getAll(r.range);return new em((t,r)=>{e.onerror=e=>{r(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}{let e=this.cursor(r),t=[];return this.J(e,(e,r)=>{t.push(r)}).next(()=>t)}}Z(e,t){let r=this.store.getAll(e,null===t?void 0:t);return new em((e,t)=>{r.onerror=e=>{t(e.target.error)},r.onsuccess=t=>{e(t.target.result)}})}X(e,t){_(eg,"DELETE ALL",this.store.name);let r=this.options(e,t);r.Y=!1;let n=this.cursor(r);return this.J(n,(e,t,r)=>r.delete())}ee(e,t){let r;t?r=e:(r={},t=e);let n=this.cursor(r);return this.J(n,t)}te(e){let t=this.cursor({});return new em((r,n)=>{t.onerror=e=>{n(eS(e.target.error))},t.onsuccess=t=>{let n=t.target.result;n?e(n.primaryKey,n.value).next(e=>{e?n.continue():r()}):r()}})}J(e,t){let r=[];return new em((n,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{let i=e.target.result;if(!i)return void n();let s=new ew(i),a=t(i.primaryKey,i.value,s);if(a instanceof em){let e=a.catch(e=>(s.done(),em.reject(e)));r.push(e)}s.isDone?n():null===s.G?i.continue():i.continue(s.G)}}).next(()=>em.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function eb(e){return new em((t,r)=>{e.onsuccess=e=>{t(e.target.result)},e.onerror=e=>{r(eS(e.target.error))}})}let eA=!1;function eS(e){let t=e_.M(c.getUA());if(t>=12.2&&t<13){let t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){let e=new S("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return eA||(eA=!0,setTimeout(()=>{throw e},0)),e}}return e}let eC="IndexBackfiller";class eR{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}re(e){_(eC,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{let e=await this.ne.ie();_(eC,`Documents written: ${e}`)}catch(e){eE(e)?_(eC,"Ignoring IndexedDB error during index backfill: ",e):await ep(e)}await this.re(6e4)})}}class eP{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.se(t,e))}se(e,t){let r=new Set,n=t,i=!0;return em.doWhile(()=>!0===i&&n>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(null!==t&&!r.has(t))return _(eC,`Processing collection: ${t}`),this.oe(e,t,n).next(e=>{n-=e,r.add(t)});i=!1})).next(()=>t-n)}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(n=>this.localStore.localDocuments.getNextDocuments(e,t,n,r).next(r=>{let i=r.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next(()=>this._e(n,r)).next(r=>(_(eC,`Updating offset: ${r}`),this.localStore.indexManager.updateCollectionGroup(e,t,r))).next(()=>i.size)}))}_e(e,t){let r=e;return t.changes.forEach((e,t)=>{let n=eu(t);eh(n,r)>0&&(r=n)}),new ec(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class ek{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ue&&this.ue(e),e}}function eN(e){return null==e}function eD(e){return 0===e&&1/e==-1/0}function ex(e){return"number"==typeof e&&Number.isInteger(e)&&!eD(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function eO(e){let t="";for(let r=0;r<e.length;r++)t.length>0&&(t+="\x01\x01"),t=function(e,t){let r=t,n=e.length;for(let t=0;t<n;t++){let n=e.charAt(t);switch(n){case"\0":r+="\x01\x10";break;case"\x01":r+="\x01\x11";break;default:r+=n}}return r}(e.get(r),t);return t+"\x01\x01"}ek.ce=-1;function eL(e){let t=e.length;if(b(t>=2,64408,{path:e}),2===t)return b("\x01"===e.charAt(0)&&"\x01"===e.charAt(1),56145,{path:e}),B.emptyPath();let r=t-2,n=[],i="";for(let s=0;s<t;){let t=e.indexOf("\x01",s);switch((t<0||t>r)&&E(50515,{path:e}),e.charAt(t+1)){case"\x01":let a,o=e.substring(s,t);0===i.length?a=o:(i+=o,a=i,i=""),n.push(a);break;case"\x10":i+=e.substring(s,t),i+="\0";break;case"\x11":i+=e.substring(s,t+1);break;default:E(61167,{path:e})}s=t+2}return new B(n)}let eM="remoteDocuments",eV="owner",eF="owner",eU="mutationQueues",eq="mutations",eB="batchId",ej="userMutationsIndex",ez=["userId","batchId"],eG={},e$="documentMutations",eH="remoteDocumentsV14",eK=["prefixPath","collectionGroup","readTime","documentId"],eW="documentKeyIndex",eQ=["prefixPath","collectionGroup","documentId"],eJ="collectionGroupIndex",eY=["collectionGroup","readTime","prefixPath","documentId"],eX="remoteDocumentGlobal",eZ="remoteDocumentGlobalKey",e0="targets",e1="queryTargetsIndex",e2=["canonicalId","targetId"],e6="targetDocuments",e3=["targetId","path"],e4="documentTargetsIndex",e5=["path","targetId"],e8="targetGlobalKey",e7="targetGlobal",e9="collectionParents",te=["collectionId","parent"],tt="clientMetadata",tr="bundles",tn="namedQueries",ti="indexConfiguration",ts="collectionGroupIndex",ta="indexState",to=["indexId","uid"],tl="sequenceNumberIndex",tu=["uid","sequenceNumber"],tc="indexEntries",th=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],td="documentKeyIndex",tf=["indexId","uid","orderedDocumentKey"],tp="documentOverlays",tm=["userId","collectionPath","documentId"],tg="collectionPathOverlayIndex",ty=["userId","collectionPath","largestBatchId"],t_="collectionGroupOverlayIndex",tv=["userId","collectionGroup","largestBatchId"],tw="globals",tI=[eU,eq,e$,eM,e0,eV,e7,e6,tt,eX,e9,tr,tn],tE=[...tI,tp],tT=[eU,eq,e$,eH,e0,eV,e7,e6,tt,eX,e9,tr,tn,tp],tb=[...tT,ti,ta,tc],tA=[...tb,tw];class tS extends ef{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function tC(e,t){return e_.O(e.le,t)}function tR(e){let t=0;for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function tP(e,t){for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function tk(e,t){let r=[];for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.push(t(e[n],n,e));return r}function tN(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class tD{constructor(e,t){this.comparator=e,this.root=t||tO.EMPTY}insert(e,t){return new tD(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,tO.BLACK,null,null))}remove(e){return new tD(this.comparator,this.root.remove(e,this.comparator).copy(null,null,tO.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let n=this.comparator(e,r.key);if(0===n)return t+r.left.size;n<0?r=r.left:(t+=r.left.size+1,r=r.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new tx(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new tx(this.root,e,this.comparator,!1)}getReverseIterator(){return new tx(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new tx(this.root,e,this.comparator,!0)}}class tx{constructor(e,t,r,n){this.isReverse=n,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&n&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class tO{constructor(e,t,r,n,i){this.key=e,this.value=t,this.color=null!=r?r:tO.RED,this.left=null!=n?n:tO.EMPTY,this.right=null!=i?i:tO.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,n,i){return new tO(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=n?n:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let n=this,i=r(e,n.key);return(n=i<0?n.copy(null,null,null,n.left.insert(e,t,r),null):0===i?n.copy(null,t,null,null,null):n.copy(null,null,null,null,n.right.insert(e,t,r))).fixUp()}removeMin(){if(this.left.isEmpty())return tO.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,t){let r,n=this;if(0>t(e,n.key))n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),0===t(e,n.key)){if(n.right.isEmpty())return tO.EMPTY;r=n.right.min(),n=n.copy(r.key,r.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}rotateLeft(){let e=this.copy(null,null,tO.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,tO.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){return Math.pow(2,this.check())<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw E(43730,{key:this.key,value:this.value});if(this.right.isRed())throw E(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw E(27949);return e+ +!this.isRed()}}tO.EMPTY=null,tO.RED=!0,tO.BLACK=!1,tO.EMPTY=new class{constructor(){this.size=0}get key(){throw E(57766)}get value(){throw E(16141)}get color(){throw E(16727)}get left(){throw E(29726)}get right(){throw E(36894)}copy(e,t,r,n,i){return this}insert(e,t,r){return new tO(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class tL{constructor(e){this.comparator=e,this.data=new tD(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let n=r.getNext();if(this.comparator(n.key,e[1])>=0)return;t(n.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new tM(this.data.getIterator())}getIteratorFrom(e){return new tM(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof tL)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let e=t.getNext().key,n=r.getNext().key;if(0!==this.comparator(e,n))return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new tL(this.comparator);return t.data=e,t}}class tM{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function tV(e){return e.hasNext()?e.getNext():void 0}class tF{constructor(e){this.fields=e,e.sort(z.comparator)}static empty(){return new tF([])}unionWith(e){let t=new tL(z.comparator);for(let e of this.fields)t=t.add(e);for(let r of e)t=t.add(r);return new tF(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return F(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class tU extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class tq{constructor(e){this.binaryString=e}static fromBase64String(e){return new tq(function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new tU("Invalid base64 string: "+e):e}}(e))}static fromUint8Array(e){return new tq(function(e){let t="";for(let r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t}(e))}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){var e=this.binaryString;let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return L(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}tq.EMPTY_BYTE_STRING=new tq("");let tB=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function tj(e){if(b(!!e,39018),"string"==typeof e){let t=0,r=tB.exec(e);if(b(!!r,46558,{timestamp:e}),r[1]){let e=r[1];t=Number(e=(e+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(e).getTime()/1e3),nanos:t}}return{seconds:tz(e.seconds),nanos:tz(e.nanos)}}function tz(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function tG(e){return"string"==typeof e?tq.fromBase64String(e):tq.fromUint8Array(e)}let t$="server_timestamp",tH="__type__",tK="__previous_value__",tW="__local_write_time__";function tQ(e){return(e?.mapValue?.fields||{})[tH]?.stringValue===t$}function tJ(e){let t=e.mapValue.fields[tK];return tQ(t)?tJ(t):t}function tY(e){let t=tj(e.mapValue.fields[tW].timestampValue);return new ee(t.seconds,t.nanos)}class tX{constructor(e,t,r,n,i,s,a,o,l,u,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=n,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=u,this.apiKey=c}}let tZ="(default)";class t0{constructor(e,t){this.projectId=e,this.database=t||tZ}static empty(){return new t0("","")}get isDefaultDatabase(){return this.database===tZ}isEqual(e){return e instanceof t0&&e.projectId===this.projectId&&e.database===this.database}}let t1="__type__",t2="__max__",t6={mapValue:{fields:{__type__:{stringValue:t2}}}},t3="__vector__",t4="value",t5={nullValue:"NULL_VALUE"};function t8(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?tQ(e)?4:rd(e)?0x1fffffffffffff:rc(e)?10:11:E(28295,{value:e})}function t7(e,t){if(e===t)return!0;let r=t8(e);if(r!==t8(t))return!1;switch(r){case 0:case 0x1fffffffffffff:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return tY(e).isEqual(tY(t));case 3:if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;let n=tj(e.timestampValue),i=tj(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos;case 5:return e.stringValue===t.stringValue;case 6:return tG(e.bytesValue).isEqual(tG(t.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return tz(e.geoPointValue.latitude)===tz(t.geoPointValue.latitude)&&tz(e.geoPointValue.longitude)===tz(t.geoPointValue.longitude);case 2:if("integerValue"in e&&"integerValue"in t)return tz(e.integerValue)===tz(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){let r=tz(e.doubleValue),n=tz(t.doubleValue);return r===n?eD(r)===eD(n):isNaN(r)&&isNaN(n)}return!1;case 9:return F(e.arrayValue.values||[],t.arrayValue.values||[],t7);case 10:case 11:let s=e.mapValue.fields||{},a=t.mapValue.fields||{};if(tR(s)!==tR(a))return!1;for(let e in s)if(s.hasOwnProperty(e)&&(void 0===a[e]||!t7(s[e],a[e])))return!1;return!0;default:return E(52216,{left:e})}}function t9(e,t){return void 0!==(e.values||[]).find(e=>t7(e,t))}function re(e,t){var r,n,i,s,a,o;if(e===t)return 0;let l=t8(e),u=t8(t);if(l!==u)return L(l,u);switch(l){case 0:case 0x1fffffffffffff:return 0;case 1:return L(e.booleanValue,t.booleanValue);case 2:let c,h;return c=tz(e.integerValue||e.doubleValue),c<(h=tz(t.integerValue||t.doubleValue))?-1:c>h?1:c===h?0:isNaN(c)?isNaN(h)?0:-1:1;case 3:return rt(e.timestampValue,t.timestampValue);case 4:return rt(tY(e),tY(t));case 5:return M(e.stringValue,t.stringValue);case 6:let d,f;return r=e.bytesValue,n=t.bytesValue,d=tG(r),f=tG(n),d.compareTo(f);case 7:return function(e,t){let r=e.split("/"),n=t.split("/");for(let e=0;e<r.length&&e<n.length;e++){let t=L(r[e],n[e]);if(0!==t)return t}return L(r.length,n.length)}(e.referenceValue,t.referenceValue);case 8:let p;return i=e.geoPointValue,s=t.geoPointValue,0!==(p=L(tz(i.latitude),tz(s.latitude)))?p:L(tz(i.longitude),tz(s.longitude));case 9:return rr(e.arrayValue,t.arrayValue);case 10:let m,g,y,_,v;return a=e.mapValue,o=t.mapValue,m=a.fields||{},g=o.fields||{},y=m[t4]?.arrayValue,_=g[t4]?.arrayValue,0!==(v=L(y?.values?.length||0,_?.values?.length||0))?v:rr(y,_);case 11:return function(e,t){if(e===t6.mapValue&&t===t6.mapValue)return 0;if(e===t6.mapValue)return 1;if(t===t6.mapValue)return -1;let r=e.fields||{},n=Object.keys(r),i=t.fields||{},s=Object.keys(i);n.sort(),s.sort();for(let e=0;e<n.length&&e<s.length;++e){let t=M(n[e],s[e]);if(0!==t)return t;let a=re(r[n[e]],i[s[e]]);if(0!==a)return a}return L(n.length,s.length)}(e.mapValue,t.mapValue);default:throw E(23264,{he:l})}}function rt(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return L(e,t);let r=tj(e),n=tj(t),i=L(r.seconds,n.seconds);return 0!==i?i:L(r.nanos,n.nanos)}function rr(e,t){let r=e.values||[],n=t.values||[];for(let e=0;e<r.length&&e<n.length;++e){let t=re(r[e],n[e]);if(t)return t}return L(r.length,n.length)}function rn(e){var t,r;let n;return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(n=tj(e.timestampValue),`time(${n.seconds},${n.nanos})`):"stringValue"in e?e.stringValue:"bytesValue"in e?tG(e.bytesValue).toBase64():"referenceValue"in e?(t=e.referenceValue,G.fromName(t).toString()):"geoPointValue"in e?(r=e.geoPointValue,`geo(${r.latitude},${r.longitude})`):"arrayValue"in e?function(e){let t="[",r=!0;for(let n of e.values||[])r?r=!1:t+=",",t+=rn(n);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){let t=Object.keys(e.fields||{}).sort(),r="{",n=!0;for(let i of t)n?n=!1:r+=",",r+=`${i}:${rn(e.fields[i])}`;return r+"}"}(e.mapValue):E(61005,{value:e})}function ri(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function rs(e){return!!e&&"integerValue"in e}function ra(e){return!!e&&"arrayValue"in e}function ro(e){return!!e&&"nullValue"in e}function rl(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function ru(e){return!!e&&"mapValue"in e}function rc(e){return(e?.mapValue?.fields||{})[t1]?.stringValue===t3}function rh(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:{...e.timestampValue}};if(e.mapValue){let t={mapValue:{fields:{}}};return tP(e.mapValue.fields,(e,r)=>t.mapValue.fields[e]=rh(r)),t}if(e.arrayValue){let t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=rh(e.arrayValue.values[r]);return t}return{...e}}function rd(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===t2}let rf={mapValue:{fields:{[t1]:{stringValue:t3},[t4]:{arrayValue:{}}}}};function rp(e,t){let r=re(e.value,t.value);return 0!==r?r:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function rm(e,t){let r=re(e.value,t.value);return 0!==r?r:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class rg{constructor(e){this.value=e}static empty(){return new rg({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(!ru(t=(t.mapValue.fields||{})[e.get(r)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=rh(t)}setAll(e){let t=z.emptyPath(),r={},n=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){let e=this.getFieldsMap(t);this.applyChanges(e,r,n),r={},n=[],t=i.popLast()}e?r[i.lastSegment()]=rh(e):n.push(i.lastSegment())});let i=this.getFieldsMap(t);this.applyChanges(i,r,n)}delete(e){let t=this.field(e.popLast());ru(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return t7(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let n=t.mapValue.fields[e.get(r)];ru(n)&&n.mapValue.fields||(n={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=n),t=n}return t.mapValue.fields}applyChanges(e,t,r){for(let n of(tP(t,(t,r)=>e[t]=r),r))delete e[n]}clone(){return new rg(rh(this.value))}}class ry{constructor(e,t,r,n,i,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=n,this.createTime=i,this.data=s,this.documentState=a}static newInvalidDocument(e){return new ry(e,0,et.min(),et.min(),et.min(),rg.empty(),0)}static newFoundDocument(e,t,r,n){return new ry(e,1,t,et.min(),r,n,0)}static newNoDocument(e,t){return new ry(e,2,t,et.min(),et.min(),rg.empty(),0)}static newUnknownDocument(e,t){return new ry(e,3,t,et.min(),et.min(),rg.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(et.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=rg.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=rg.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=et.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ry&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ry(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class r_{constructor(e,t){this.position=e,this.inclusive=t}}function rv(e,t,r){let n=0;for(let i=0;i<e.position.length;i++){let s=t[i],a=e.position[i];if(n=s.field.isKeyField()?G.comparator(G.fromName(a.referenceValue),r.key):re(a,r.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function rw(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!t7(e.position[r],t.position[r]))return!1;return!0}class rI{constructor(e,t="asc"){this.field=e,this.dir=t}}class rE{}class rT extends rE{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new rk(e,t,r):"array-contains"===t?new rO(e,r):"in"===t?new rL(e,r):"not-in"===t?new rM(e,r):"array-contains-any"===t?new rV(e,r):new rT(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new rN(e,r):new rD(e,r)}matches(e){let t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(re(t,this.value)):null!==t&&t8(this.value)===t8(t)&&this.matchesComparison(re(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return E(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class rb extends rE{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new rb(e,t)}matches(e){return rA(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function rA(e){return"and"===e.op}function rS(e){return"or"===e.op}function rC(e){return rR(e)&&rA(e)}function rR(e){for(let t of e.filters)if(t instanceof rb)return!1;return!0}function rP(e,t){let r=e.filters.concat(t);return rb.create(r,e.op)}class rk extends rT{constructor(e,t,r){super(e,t,r),this.key=G.fromName(r.referenceValue)}matches(e){let t=G.comparator(e.key,this.key);return this.matchesComparison(t)}}class rN extends rT{constructor(e,t){super(e,"in",t),this.keys=rx("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class rD extends rT{constructor(e,t){super(e,"not-in",t),this.keys=rx("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function rx(e,t){return(t.arrayValue?.values||[]).map(e=>G.fromName(e.referenceValue))}class rO extends rT{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return ra(t)&&t9(t.arrayValue,this.value)}}class rL extends rT{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return null!==t&&t9(this.value.arrayValue,t)}}class rM extends rT{constructor(e,t){super(e,"not-in",t)}matches(e){if(t9(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!t9(this.value.arrayValue,t)}}class rV extends rT{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!ra(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>t9(this.value.arrayValue,e))}}class rF{constructor(e,t=null,r=[],n=[],i=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=n,this.limit=i,this.startAt=s,this.endAt=a,this.Te=null}}function rU(e,t=null,r=[],n=[],i=null,s=null,a=null){return new rF(e,t,r,n,i,s,a)}function rq(e){if(null===e.Te){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(e=>(function e(t){if(t instanceof rT)return t.field.canonicalString()+t.op.toString()+rn(t.value);if(rC(t))return t.filters.map(t=>e(t)).join(",");{let r=t.filters.map(t=>e(t)).join(",");return`${t.op}(${r})`}})(e)).join(","),t+="|ob:",t+=e.orderBy.map(e=>e.field.canonicalString()+e.dir).join(","),eN(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>rn(e)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>rn(e)).join(",")),e.Te=t}return e.Te}function rB(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let i=0;i<e.orderBy.length;i++){var r,n;if(r=e.orderBy[i],n=t.orderBy[i],!(r.dir===n.dir&&r.field.isEqual(n.field)))return!1}if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!function e(t,r){return t instanceof rT?r instanceof rT&&t.op===r.op&&t.field.isEqual(r.field)&&t7(t.value,r.value):t instanceof rb?r instanceof rb&&t.op===r.op&&t.filters.length===r.filters.length&&t.filters.reduce((t,n,i)=>t&&e(n,r.filters[i]),!0):void E(19439)}(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!rw(e.startAt,t.startAt)&&rw(e.endAt,t.endAt)}function rj(e){return G.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function rz(e,t){return e.filters.filter(e=>e instanceof rT&&e.field.isEqual(t))}function rG(e,t,r){let n=t5,i=!0;for(let r of rz(e,t)){let e=t5,t=!0;switch(r.op){case"<":case"<=":var s;e="nullValue"in(s=r.value)?t5:"booleanValue"in s?{booleanValue:!1}:"integerValue"in s||"doubleValue"in s?{doubleValue:NaN}:"timestampValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in s?{stringValue:""}:"bytesValue"in s?{bytesValue:""}:"referenceValue"in s?ri(t0.empty(),G.empty()):"geoPointValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in s?{arrayValue:{}}:"mapValue"in s?rc(s)?rf:{mapValue:{}}:E(35942,{value:s});break;case"==":case"in":case">=":e=r.value;break;case">":e=r.value,t=!1;break;case"!=":case"not-in":e=t5}0>rp({value:n,inclusive:i},{value:e,inclusive:t})&&(n=e,i=t)}if(null!==r){for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){let e=r.position[s];0>rp({value:n,inclusive:i},{value:e,inclusive:r.inclusive})&&(n=e,i=r.inclusive);break}}return{value:n,inclusive:i}}function r$(e,t,r){let n=t6,i=!0;for(let r of rz(e,t)){let e=t6,t=!0;switch(r.op){case">=":case">":var s;e="nullValue"in(s=r.value)?{booleanValue:!1}:"booleanValue"in s?{doubleValue:NaN}:"integerValue"in s||"doubleValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in s?{stringValue:""}:"stringValue"in s?{bytesValue:""}:"bytesValue"in s?ri(t0.empty(),G.empty()):"referenceValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in s?{arrayValue:{}}:"arrayValue"in s?rf:"mapValue"in s?rc(s)?{mapValue:{}}:t6:E(61959,{value:s}),t=!1;break;case"==":case"in":case"<=":e=r.value;break;case"<":e=r.value,t=!1;break;case"!=":case"not-in":e=t6}rm({value:n,inclusive:i},{value:e,inclusive:t})>0&&(n=e,i=t)}if(null!==r){for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){let e=r.position[s];rm({value:n,inclusive:i},{value:e,inclusive:r.inclusive})>0&&(n=e,i=r.inclusive);break}}return{value:n,inclusive:i}}class rH{constructor(e,t=null,r=[],n=[],i=null,s="F",a=null,o=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=n,this.limit=i,this.limitType=s,this.startAt=a,this.endAt=o,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function rK(e){return new rH(e)}function rW(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function rQ(e){return G.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function rJ(e){return null!==e.collectionGroup}function rY(e){if(null===e.Ie){let t;e.Ie=[];let r=new Set;for(let t of e.explicitOrderBy)e.Ie.push(t),r.add(t.field.canonicalString());let n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(t=new tL(z.comparator),e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t).forEach(t=>{r.has(t.canonicalString())||t.isKeyField()||e.Ie.push(new rI(t,n))}),r.has(z.keyField().canonicalString())||e.Ie.push(new rI(z.keyField(),n))}return e.Ie}function rX(e){return e.Ee||(e.Ee=r0(e,rY(e))),e.Ee}function rZ(e){return e.Re||(e.Re=r0(e,e.explicitOrderBy)),e.Re}function r0(e,t){if("F"===e.limitType)return rU(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{let t="desc"===e.dir?"asc":"desc";return new rI(e.field,t)});let r=e.endAt?new r_(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new r_(e.startAt.position,e.startAt.inclusive):null;return rU(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function r1(e,t,r){return new rH(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function r2(e,t){return rB(rX(e),rX(t))&&e.limitType===t.limitType}function r6(e){return`${rq(rX(e))}|lt:${e.limitType}`}function r3(e){var t;let r;return`Query(target=${r=(t=rX(e)).path.canonicalString(),null!==t.collectionGroup&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(e=>(function e(t){return t instanceof rT?`${t.field.canonicalString()} ${t.op} ${rn(t.value)}`:t instanceof rb?t.op.toString()+" {"+t.getFilters().map(e).join(" ,")+"}":"Filter"})(e)).join(", ")}]`),eN(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(e=>`${e.field.canonicalString()} (${e.dir})`).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(e=>rn(e)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(e=>rn(e)).join(",")),`Target(${r})`}; limitType=${e.limitType})`}function r4(e,t){var r,n,i,s;let a,o,l;return t.isFoundDocument()&&(a=t.key.path,null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(a):G.isDocumentKey(e.path)?e.path.isEqual(a):e.path.isImmediateParentOf(a))&&function(e,t){for(let r of rY(e))if(!r.field.isKeyField()&&null===t.data.field(r.field))return!1;return!0}(e,t)&&function(e,t){for(let r of e.filters)if(!r.matches(t))return!1;return!0}(e,t)&&(r=e,n=t,(!r.startAt||(i=r.startAt,o=rv(i,rY(r),n),i.inclusive?!!(o<=0):!!(o<0)))&&(!r.endAt||(s=r.endAt,l=rv(s,rY(r),n),s.inclusive?!!(l>=0):!!(l>0))))}function r5(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function r8(e){return(t,r)=>{let n=!1;for(let i of rY(e)){let e=function(e,t,r){var n;let i,s,a=e.field.isKeyField()?G.comparator(t.key,r.key):(n=e.field,i=t.data.field(n),s=r.data.field(n),null!==i&&null!==s?re(i,s):E(42886));switch(e.dir){case"asc":return a;case"desc":return -1*a;default:return E(19790,{direction:e.dir})}}(i,t,r);if(0!==e)return e;n=n||i.field.isKeyField()}return 0}}class r7{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r){for(let[t,n]of r)if(this.equalsFn(t,e))return n}}has(e){return void 0!==this.get(e)}set(e,t){let r=this.mapKeyFn(e),n=this.inner[r];if(void 0===n)return this.inner[r]=[[e,t]],void this.innerSize++;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return void(n[r]=[e,t]);n.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return 1===r.length?delete this.inner[t]:r.splice(n,1),this.innerSize--,!0;return!1}forEach(e){tP(this.inner,(t,r)=>{for(let[t,n]of r)e(t,n)})}isEmpty(){return tN(this.inner)}size(){return this.innerSize}}let r9=new tD(G.comparator),ne=new tD(G.comparator);function nt(...e){let t=ne;for(let r of e)t=t.insert(r.key,r);return t}function nr(e){let t=ne;return e.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function nn(){return new r7(e=>e.toString(),(e,t)=>e.isEqual(t))}let ni=new tD(G.comparator),ns=new tL(G.comparator);function na(...e){let t=ns;for(let r of e)t=t.add(r);return t}let no=new tL(L);function nl(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:eD(t)?"-0":t}}function nu(e){return{integerValue:""+e}}function nc(e,t){return ex(t)?nu(t):nl(e,t)}class nh{constructor(){this._=void 0}}function nd(e,t){return e instanceof n_?rs(t)||t&&"doubleValue"in t?t:{integerValue:0}:null}class nf extends nh{}class np extends nh{constructor(e){super(),this.elements=e}}function nm(e,t){let r=nw(t);for(let t of e.elements)r.some(e=>t7(e,t))||r.push(t);return{arrayValue:{values:r}}}class ng extends nh{constructor(e){super(),this.elements=e}}function ny(e,t){let r=nw(t);for(let t of e.elements)r=r.filter(e=>!t7(e,t));return{arrayValue:{values:r}}}class n_ extends nh{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function nv(e){return tz(e.integerValue||e.doubleValue)}function nw(e){return ra(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class nI{constructor(e,t){this.field=e,this.transform=t}}class nE{constructor(e,t){this.version=e,this.transformResults=t}}class nT{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new nT}static exists(e){return new nT(void 0,e)}static updateTime(e){return new nT(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nb(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class nA{}function nS(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new nO(e.key,nT.none()):new nP(e.key,e.data,nT.none());{let r=e.data,n=rg.empty(),i=new tL(z.comparator);for(let e of t.fields)if(!i.has(e)){let t=r.field(e);null===t&&e.length>1&&(e=e.popLast(),t=r.field(e)),null===t?n.delete(e):n.set(e,t),i=i.add(e)}return new nk(e.key,n,new tF(i.toArray()),nT.none())}}function nC(e,t,r,n){return e instanceof nP?function(e,t,r,n){if(!nb(e.precondition,t))return r;let i=e.value.clone(),s=nx(e.fieldTransforms,n,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,r,n):e instanceof nk?function(e,t,r,n){if(!nb(e.precondition,t))return r;let i=nx(e.fieldTransforms,n,t),s=t.data;return(s.setAll(nN(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===r)?null:r.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,r,n):nb(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):r}function nR(e,t){var r,n;return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=e.fieldTransforms,n=t.fieldTransforms,!!(void 0===r&&void 0===n||!(!r||!n)&&F(r,n,(e,t)=>{var r,n;return e.field.isEqual(t.field)&&(r=e.transform,n=t.transform,r instanceof np&&n instanceof np||r instanceof ng&&n instanceof ng?F(r.elements,n.elements,t7):r instanceof n_&&n instanceof n_?t7(r.Ae,n.Ae):r instanceof nf&&n instanceof nf)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class nP extends nA{constructor(e,t,r,n=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}class nk extends nA{constructor(e,t,r,n,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=n,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function nN(e){let t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){let n=e.data.field(r);t.set(r,n)}}),t}function nD(e,t,r){let n=new Map;b(e.length===r.length,32656,{Ve:r.length,de:e.length});for(let s=0;s<r.length;s++){var i;let a=e[s],o=a.transform,l=t.data.field(a.field);n.set(a.field,(i=r[s],o instanceof np?nm(o,l):o instanceof ng?ny(o,l):i))}return n}function nx(e,t,r){let n=new Map;for(let i of e){let e=i.transform,s=r.data.field(i.field);n.set(i.field,function(e,t,r){var n;let i,s,a;return e instanceof nf?(n=t,i={fields:{[tH]:{stringValue:t$},[tW]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}},n&&tQ(n)&&(n=tJ(n)),n&&(i.fields[tK]=n),{mapValue:i}):e instanceof np?nm(e,t):e instanceof ng?ny(e,t):(a=nv(s=nd(e,t))+nv(e.Ae),rs(s)&&rs(e.Ae)?nu(a):nl(e.serializer,a))}(e,s,t))}return n}class nO extends nA{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nL extends nA{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class nM{constructor(e,t,r,n){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=n}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let t=0;t<this.mutations.length;t++){let n=this.mutations[t];n.key.isEqual(e.key)&&function(e,t,r){let n,i;e instanceof nP?(n=e.value.clone(),i=nD(e.fieldTransforms,t,r.transformResults),n.setAll(i),t.convertToFoundDocument(r.version,n).setHasCommittedMutations()):e instanceof nk?function(e,t,r){if(!nb(e.precondition,t))return t.convertToUnknownDocument(r.version);let n=nD(e.fieldTransforms,t,r.transformResults),i=t.data;i.setAll(nN(e)),i.setAll(n),t.convertToFoundDocument(r.version,i).setHasCommittedMutations()}(e,t,r):t.convertToNoDocument(r.version).setHasCommittedMutations()}(n,e,r[t])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=nC(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=nC(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=nn();return this.mutations.forEach(n=>{let i=e.get(n.key),s=i.overlayedDocument,a=this.applyToLocalView(s,i.mutatedFields),o=nS(s,a=t.has(n.key)?null:a);null!==o&&r.set(n.key,o),s.isValidDocument()||s.convertToNoDocument(et.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),na())}isEqual(e){return this.batchId===e.batchId&&F(this.mutations,e.mutations,(e,t)=>nR(e,t))&&F(this.baseMutations,e.baseMutations,(e,t)=>nR(e,t))}}class nV{constructor(e,t,r,n){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=n}static from(e,t,r){b(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let n=ni,i=e.mutations;for(let e=0;e<i.length;e++)n=n.insert(i[e].key,r[e].version);return new nV(e,t,r,n)}}class nF{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class nU{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}class nq{constructor(e,t){this.count=e,this.unchangedNames=t}}function nB(e){switch(e){case A.OK:return E(64938);case A.CANCELLED:case A.UNKNOWN:case A.DEADLINE_EXCEEDED:case A.RESOURCE_EXHAUSTED:case A.INTERNAL:case A.UNAVAILABLE:case A.UNAUTHENTICATED:return!1;case A.INVALID_ARGUMENT:case A.NOT_FOUND:case A.ALREADY_EXISTS:case A.PERMISSION_DENIED:case A.FAILED_PRECONDITION:case A.ABORTED:case A.OUT_OF_RANGE:case A.UNIMPLEMENTED:case A.DATA_LOSS:return!0;default:return E(15467,{code:e})}}function nj(e){if(void 0===e)return v("GRPC error has no .code"),A.UNKNOWN;switch(e){case n.OK:return A.OK;case n.CANCELLED:return A.CANCELLED;case n.UNKNOWN:return A.UNKNOWN;case n.DEADLINE_EXCEEDED:return A.DEADLINE_EXCEEDED;case n.RESOURCE_EXHAUSTED:return A.RESOURCE_EXHAUSTED;case n.INTERNAL:return A.INTERNAL;case n.UNAVAILABLE:return A.UNAVAILABLE;case n.UNAUTHENTICATED:return A.UNAUTHENTICATED;case n.INVALID_ARGUMENT:return A.INVALID_ARGUMENT;case n.NOT_FOUND:return A.NOT_FOUND;case n.ALREADY_EXISTS:return A.ALREADY_EXISTS;case n.PERMISSION_DENIED:return A.PERMISSION_DENIED;case n.FAILED_PRECONDITION:return A.FAILED_PRECONDITION;case n.ABORTED:return A.ABORTED;case n.OUT_OF_RANGE:return A.OUT_OF_RANGE;case n.UNIMPLEMENTED:return A.UNIMPLEMENTED;case n.DATA_LOSS:return A.DATA_LOSS;default:return E(39323,{code:e})}}(i=n||(n={}))[i.OK=0]="OK",i[i.CANCELLED=1]="CANCELLED",i[i.UNKNOWN=2]="UNKNOWN",i[i.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",i[i.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",i[i.NOT_FOUND=5]="NOT_FOUND",i[i.ALREADY_EXISTS=6]="ALREADY_EXISTS",i[i.PERMISSION_DENIED=7]="PERMISSION_DENIED",i[i.UNAUTHENTICATED=16]="UNAUTHENTICATED",i[i.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",i[i.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",i[i.ABORTED=10]="ABORTED",i[i.OUT_OF_RANGE=11]="OUT_OF_RANGE",i[i.UNIMPLEMENTED=12]="UNIMPLEMENTED",i[i.INTERNAL=13]="INTERNAL",i[i.UNAVAILABLE=14]="UNAVAILABLE",i[i.DATA_LOSS=15]="DATA_LOSS";let nz=null;function nG(){return new TextEncoder}let n$=new h.Integer([0xffffffff,0xffffffff],0);function nH(e){let t=nG().encode(e),r=new h.Md5;return r.update(t),new Uint8Array(r.digest())}function nK(e){let t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new h.Integer([r,n],0),new h.Integer([i,s],0)]}class nW{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new nQ(`Invalid padding: ${t}`);if(r<0||e.length>0&&0===this.hashCount)throw new nQ(`Invalid hash count: ${r}`);if(0===e.length&&0!==t)throw new nQ(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=h.Integer.fromNumber(this.ge)}ye(e,t,r){let n=e.add(t.multiply(h.Integer.fromNumber(r)));return 1===n.compare(n$)&&(n=new h.Integer([n.getBits(0),n.getBits(1)],0)),n.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;let[t,r]=nK(nH(e));for(let e=0;e<this.hashCount;e++){let n=this.ye(t,r,e);if(!this.we(n))return!1}return!0}static create(e,t,r){let n=new nW(new Uint8Array(Math.ceil(e/8)),e%8==0?0:8-e%8,t);return r.forEach(e=>n.insert(e)),n}insert(e){if(0===this.ge)return;let[t,r]=nK(nH(e));for(let e=0;e<this.hashCount;e++){let n=this.ye(t,r,e);this.be(n)}}be(e){let t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class nQ extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class nJ{constructor(e,t,r,n,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=n,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let n=new Map;return n.set(e,nY.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new nJ(et.min(),n,new tD(L),r9,na())}}class nY{constructor(e,t,r,n,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=n,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new nY(r,t,na(),na(),na())}}class nX{constructor(e,t,r,n){this.Se=e,this.removedTargetIds=t,this.key=r,this.De=n}}class nZ{constructor(e,t){this.targetId=e,this.Ce=t}}class n0{constructor(e,t,r=tq.EMPTY_BYTE_STRING,n=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=n}}class n1{constructor(){this.ve=0,this.Fe=n3(),this.Me=tq.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=na(),t=na(),r=na();return this.Fe.forEach((n,i)=>{switch(i){case 0:e=e.add(n);break;case 2:t=t.add(n);break;case 1:r=r.add(n);break;default:E(38017,{changeType:i})}}),new nY(this.Me,this.xe,e,t,r)}Ke(){this.Oe=!1,this.Fe=n3()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,b(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class n2{constructor(e){this.Ge=e,this.ze=new Map,this.je=r9,this.He=n6(),this.Je=n6(),this.Ze=new tD(L)}Xe(e){for(let t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:E(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,r)=>{this.rt(r)&&t(r)})}st(e){let t=e.targetId,r=e.Ce.count,n=this.ot(t);if(n){let a=n.target;if(rj(a))if(0===r){let e=new G(a.path);this.et(t,e,ry.newNoDocument(e,et.min()))}else b(1===r,20013,{expectedCount:r});else{let n=this._t(t);if(n!==r){var i,s;let r,a,o=this.ut(e),l=o?this.ct(o,e,n):1;0!==l&&(this.it(t),this.Ze=this.Ze.insert(t,2===l?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),nz?.lt((i=e.Ce,s=this.Ge.ht(),r={localCacheCount:n,existenceFilterCount:i.count,databaseId:s.database,projectId:s.projectId},(a=i.unchangedNames)&&(r.bloomFilter={applied:0===l,hashCount:a?.hashCount??0,bitmapLength:a?.bits?.bitmap?.length??0,padding:a?.bits?.padding??0,mightContain:e=>o?.mightContain(e)??!1}),r))}}}}ut(e){let t,r,n=e.Ce.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:i="",padding:s=0},hashCount:a=0}=n;try{t=tG(i).toUint8Array()}catch(e){if(e instanceof tU)return w("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{r=new nW(t,s,a)}catch(e){return w(e instanceof nQ?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===r.ge?null:r}ct(e,t,r){return 2*(t.Ce.count!==r-this.Pt(e,t.targetId))}Pt(e,t){let r=this.Ge.getRemoteKeysForTarget(t),n=0;return r.forEach(r=>{let i=this.Ge.ht(),s=`projects/${i.projectId}/databases/${i.database}/documents/${r.path.canonicalString()}`;e.mightContain(s)||(this.et(t,r,null),n++)}),n}Tt(e){let t=new Map;this.ze.forEach((r,n)=>{let i=this.ot(n);if(i){if(r.current&&rj(i.target)){let t=new G(i.target.path);this.It(t).has(n)||this.Et(n,t)||this.et(n,t,ry.newNoDocument(t,e))}r.Be&&(t.set(n,r.ke()),r.Ke())}});let r=na();this.Je.forEach((e,t)=>{let n=!0;t.forEachWhile(e=>{let t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(n=!1,!1)}),n&&(r=r.add(e))}),this.je.forEach((t,r)=>r.setReadTime(e));let n=new nJ(e,t,this.Ze,this.je,r);return this.je=r9,this.He=n6(),this.Je=n6(),this.Ze=new tD(L),n}Ye(e,t){if(!this.rt(e))return;let r=2*!!this.Et(e,t.key);this.nt(e).qe(t.key,r),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;let n=this.nt(e);this.Et(e,t)?n.qe(t,1):n.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new n1,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new tL(L),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new tL(L),this.He=this.He.insert(e,t)),t}rt(e){let t=null!==this.ot(e);return t||_("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new n1),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function n6(){return new tD(G.comparator)}function n3(){return new tD(G.comparator)}let n4={asc:"ASCENDING",desc:"DESCENDING"},n5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},n8={and:"AND",or:"OR"};class n7{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function n9(e,t){return e.useProto3Json||eN(t)?t:{value:t}}function ie(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function it(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function ir(e){let t;return b(!!e,49232),et.fromTimestamp(new ee((t=tj(e)).seconds,t.nanos))}function ii(e,t){return is(e,t).canonicalString()}function is(e,t){let r=new B(["projects",e.projectId,"databases",e.database]).child("documents");return void 0===t?r:r.child(t)}function ia(e){let t=B.fromString(e);return b(iA(t),10190,{key:t.toString()}),t}function io(e,t){return ii(e.databaseId,t.path)}function il(e,t){let r=ia(t);if(r.get(1)!==e.databaseId.projectId)throw new S(A.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new S(A.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new G(id(r))}function iu(e,t){return ii(e.databaseId,t)}function ic(e){let t=ia(e);return 4===t.length?B.emptyPath():id(t)}function ih(e){return new B(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function id(e){return b(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function ip(e,t,r){return{name:io(e,t),fields:r.value.mapValue.fields}}function im(e,t,r){let n={};return t.transaction?.length&&(n.transaction=t.transaction),n.executionTime=t.executionTime?ir(t.executionTime):void 0,r&&(n.key=r.name?il(e,r.name):void 0,n.fields=new rg({mapValue:{fields:r.fields}}),n.createTime=r.createTime?ir(r.createTime):void 0,n.updateTime=r.updateTime?ir(r.updateTime):void 0),n}function ig(e,t,r){let n=il(e,t.name),i=ir(t.updateTime),s=t.createTime?ir(t.createTime):et.min(),a=new rg({mapValue:{fields:t.fields}}),o=ry.newFoundDocument(n,i,s,a);return r&&o.setHasCommittedMutations(),r?o.setHasCommittedMutations():o}function iy(e,t){var r,n;let i;if(t instanceof nP)i={update:ip(e,t.key,t.value)};else if(t instanceof nO)i={delete:io(e,t.key)};else if(t instanceof nk){let r;i={update:ip(e,t.key,t.data),updateMask:(n=t.fieldMask,r=[],n.fields.forEach(e=>r.push(e.canonicalString())),{fieldPaths:r})}}else{if(!(t instanceof nL))return E(16599,{dt:t.type});i={verify:io(e,t.key)}}return t.fieldTransforms.length>0&&(i.updateTransforms=t.fieldTransforms.map(e=>(function(e,t){let r=t.transform;if(r instanceof nf)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(r instanceof np)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:r.elements}};if(r instanceof ng)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:r.elements}};if(r instanceof n_)return{fieldPath:t.field.canonicalString(),increment:r.Ae};throw E(20930,{transform:t.transform})})(0,e))),t.precondition.isNone||(i.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:ie(e,r.updateTime.toTimestamp())}:void 0!==r.exists?{exists:r.exists}:E(27497)),i}function i_(e,t){var r;let n=t.currentDocument?void 0!==(r=t.currentDocument).updateTime?nT.updateTime(ir(r.updateTime)):void 0!==r.exists?nT.exists(r.exists):nT.none():nT.none(),i=t.updateTransforms?t.updateTransforms.map(t=>{let r;return r=null,"setToServerValue"in t?(b("REQUEST_TIME"===t.setToServerValue,16630,{proto:t}),r=new nf):"appendMissingElements"in t?r=new np(t.appendMissingElements.values||[]):"removeAllFromArray"in t?r=new ng(t.removeAllFromArray.values||[]):"increment"in t?r=new n_(e,t.increment):E(16584,{proto:t}),new nI(z.fromServerFormat(t.fieldPath),r)}):[];if(t.update){t.update.name;let r=il(e,t.update.name),s=new rg({mapValue:{fields:t.update.fields}});return t.updateMask?new nk(r,s,new tF((t.updateMask.fieldPaths||[]).map(e=>z.fromServerFormat(e))),n,i):new nP(r,s,n,i)}return t.delete?new nO(il(e,t.delete),n):t.verify?new nL(il(e,t.verify),n):E(1463,{proto:t})}function iv(e,t){return{documents:[iu(e,t.path)]}}function iw(e,t){var r,n;let i,s={structuredQuery:{}},a=t.path;null!==t.collectionGroup?(i=a,s.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=a.popLast(),s.structuredQuery.from=[{collectionId:a.lastSegment()}]),s.parent=iu(e,i);let o=function(e){if(0!==e.length)return function e(t){var r;let n;return t instanceof rT?function(e){if("=="===e.op){if(rl(e.value))return{unaryFilter:{field:iT(e.field),op:"IS_NAN"}};if(ro(e.value))return{unaryFilter:{field:iT(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(rl(e.value))return{unaryFilter:{field:iT(e.field),op:"IS_NOT_NAN"}};if(ro(e.value))return{unaryFilter:{field:iT(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:iT(e.field),op:n5[e.op],value:e.value}}}(t):t instanceof rb?1===(n=(r=t).getFilters().map(t=>e(t))).length?n[0]:{compositeFilter:{op:n8[r.op],filters:n}}:E(54877,{filter:t})}(rb.create(e,"and"))}(t.filters);o&&(s.structuredQuery.where=o);let l=function(e){if(0!==e.length)return e.map(e=>({field:iT(e.field),direction:n4[e.dir]}))}(t.orderBy);l&&(s.structuredQuery.orderBy=l);let u=n9(e,t.limit);return null!==u&&(s.structuredQuery.limit=u),t.startAt&&(s.structuredQuery.startAt={before:(r=t.startAt).inclusive,values:r.position}),t.endAt&&(s.structuredQuery.endAt={before:!(n=t.endAt).inclusive,values:n.position}),{ft:s,parent:i}}function iI(e,t,r,n){let{ft:i,parent:s}=iw(e,t),a={},o=[],l=0;return r.forEach(e=>{let t=n?e.alias:"aggregate_"+l++;a[t]=e.alias,"count"===e.aggregateType?o.push({alias:t,count:{}}):"avg"===e.aggregateType?o.push({alias:t,avg:{field:iT(e.fieldPath)}}):"sum"===e.aggregateType&&o.push({alias:t,sum:{field:iT(e.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:o,structuredQuery:i.structuredQuery},parent:i.parent},gt:a,parent:s}}function iE(e){var t,r,n;let i,s,a,o,l=ic(e.parent),u=e.structuredQuery,c=u.from?u.from.length:0,h=null;if(c>0){b(1===c,65062);let e=u.from[0];e.allDescendants?h=e.collectionId:l=l.child(e.collectionId)}let d=[];u.where&&(d=(i=function e(t){return void 0!==t.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":let t=ib(e.unaryFilter.field);return rT.create(t,"==",{doubleValue:NaN});case"IS_NULL":let r=ib(e.unaryFilter.field);return rT.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let n=ib(e.unaryFilter.field);return rT.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let i=ib(e.unaryFilter.field);return rT.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return E(61313);default:return E(60726)}}(t):void 0!==t.fieldFilter?rT.create(ib(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return E(58110);default:return E(50506)}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==t.compositeFilter?rb.create(t.compositeFilter.filters.map(t=>e(t)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return E(1026)}}(t.compositeFilter.op)):E(30097,{filter:t})}(u.where))instanceof rb&&rC(i)?i.getFilters():[i]);let f=[];u.orderBy&&(f=u.orderBy.map(e=>new rI(ib(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))));let p=null;u.limit&&(p=eN(s="object"==typeof(t=u.limit)?t.value:t)?null:s);let m=null;u.startAt&&(a=!!(r=u.startAt).before,m=new r_(r.values||[],a));let g=null;return u.endAt&&(o=!(n=u.endAt).before,g=new r_(n.values||[],o)),new rH(l,h,f,d,p,"F",m,g)}function iT(e){return{fieldPath:e.canonicalString()}}function ib(e){return z.fromServerFormat(e.fieldPath)}function iA(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function iS(e){return!!e&&"function"==typeof e._toProto&&"ProtoValue"===e._protoValueType}class iC{constructor(e,t,r,n,i=et.min(),s=et.min(),a=tq.EMPTY_BYTE_STRING,o=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=n,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new iC(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new iC(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new iC(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new iC(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class iR{constructor(e){this.yt=e}}function iP(e,t){let r=t.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:ik(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument()){var i;n.document={name:io(i=e.yt,t.key),fields:t.data.value.mapValue.fields,updateTime:ie(i,t.version.toTimestamp()),createTime:ie(i,t.createTime.toTimestamp())}}else if(t.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:iN(t.version)};else{if(!t.isUnknownDocument())return E(57904,{document:t});n.unknownDocument={path:r.path.toArray(),version:iN(t.version)}}return n}function ik(e){let t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function iN(e){let t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function iD(e){let t=new ee(e.seconds,e.nanoseconds);return et.fromTimestamp(t)}function ix(e,t){let r=(t.baseMutations||[]).map(t=>i_(e.yt,t));for(let e=0;e<t.mutations.length-1;++e){let r=t.mutations[e];e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform&&(r.updateTransforms=t.mutations[e+1].transform.fieldTransforms,t.mutations.splice(e+1,1),++e)}let n=t.mutations.map(t=>i_(e.yt,t)),i=ee.fromMillis(t.localWriteTimeMs);return new nM(t.batchId,i,r,n)}function iO(e){var t;let r,n=iD(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?iD(e.lastLimboFreeSnapshotVersion):et.min();return new iC(void 0!==e.query.documents?(b(1===(r=(t=e.query).documents.length),1966,{count:r}),rX(rK(ic(t.documents[0])))):rX(iE(e.query)),e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,n,i,tq.fromBase64String(e.resumeToken))}function iL(e,t){let r,n=iN(t.snapshotVersion),i=iN(t.lastLimboFreeSnapshotVersion);r=rj(t.target)?iv(e.yt,t.target):iw(e.yt,t.target).ft;let s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:rq(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function iM(e){let t=iE({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?r1(t,t.limit,"L"):t}function iV(e,t){return new nF(t.largestBatchId,i_(e.yt,t.overlayMutation))}function iF(e,t){let r=t.path.lastSegment();return[e,eO(t.path.popLast()),r]}function iU(e,t,r,n){return{indexId:e,uid:t,sequenceNumber:r,readTime:iN(n.readTime),documentKey:eO(n.documentKey.path),largestBatchId:n.largestBatchId}}class iq{getBundleMetadata(e,t){return tC(e,tr).get(t).next(e=>{if(e)return{id:e.bundleId,createTime:iD(e.createTime),version:e.version}})}saveBundleMetadata(e,t){return tC(e,tr).put({bundleId:t.id,createTime:iN(ir(t.createTime)),version:t.version})}getNamedQuery(e,t){return tC(e,tn).get(t).next(e=>{if(e)return{name:e.name,query:iM(e.bundledQuery),readTime:iD(e.readTime)}})}saveNamedQuery(e,t){return tC(e,tn).put({name:t.name,readTime:iN(ir(t.readTime)),bundledQuery:t.bundledQuery})}}class iB{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){return new iB(e,t.uid||"")}getOverlay(e,t){return tC(e,tp).get(iF(this.userId,t)).next(e=>e?iV(this.serializer,e):null)}getOverlays(e,t){let r=nn();return em.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){let n=[];return r.forEach((r,i)=>{let s=new nF(t,i);n.push(this.bt(e,s))}),em.waitFor(n)}removeOverlaysForBatchId(e,t,r){let n=new Set;t.forEach(e=>n.add(eO(e.getCollectionPath())));let i=[];return n.forEach(t=>{let n=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,r+1],!1,!0);i.push(tC(e,tp).X(tg,n))}),em.waitFor(i)}getOverlaysForCollection(e,t,r){let n=nn(),i=eO(t),s=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,1/0],!0);return tC(e,tp).H(tg,s).next(e=>{for(let t of e){let e=iV(this.serializer,t);n.set(e.getKey(),e)}return n})}getOverlaysForCollectionGroup(e,t,r,n){let i,s=nn(),a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,1/0],!0);return tC(e,tp).ee({index:t_,range:a},(e,t,r)=>{let a=iV(this.serializer,t);s.size()<n||a.largestBatchId===i?(s.set(a.getKey(),a),i=a.largestBatchId):r.done()}).next(()=>s)}bt(e,t){return tC(e,tp).put(function(e,t,r){let[n,i,s]=iF(t,r.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:r.mutation.key.getCollectionGroup(),largestBatchId:r.largestBatchId,overlayMutation:iy(e.yt,r.mutation)}}(this.serializer,this.userId,t))}}class ij{St(e){return tC(e,tw)}getSessionToken(e){return this.St(e).get("sessionToken").next(e=>{let t=e?.value;return t?tq.fromUint8Array(t):tq.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}class iz{Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(+!!e.booleanValue);else if("integerValue"in e)this.Ft(t,15),t.Mt(tz(e.integerValue));else if("doubleValue"in e){let r=tz(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),eD(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),"string"==typeof r&&(r=tj(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(tG(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?rd(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):rc(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):E(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){let r=e.fields||{};for(let e of(this.Ft(t,55),Object.keys(r)))this.Ot(e,t),this.Ct(r[e],t)}kt(e,t){let r=e.fields||{};this.Ft(t,53);let n=r[t4].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(tz(n)),this.Ot(t4,t),this.Ct(r[t4],t)}qt(e,t){let r=e.values||[];for(let e of(this.Ft(t,50),r))this.Ct(e,t)}Lt(e,t){this.Ft(t,37),G.fromName(e).path.forEach(e=>{this.Ft(t,60),this.$t(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}function iG(e){return Math.ceil((64-function(e){let t=0;for(let r=0;r<8;++r){let n=function(e){if(0===e)return 8;let t=0;return e>>4||(t+=4,e<<=4),e>>6||(t+=2,e<<=2),e>>7||(t+=1),t}(255&e[r]);if(t+=n,8!==n)break}return t}(e))/8)}iz.Wt=new iz;class i${constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ht(r.value),r=t.next();this.Jt()}Zt(e){for(let t of e){let e=t.charCodeAt(0);if(e<128)this.Gt(e);else if(e<2048)this.Gt(960|e>>>6),this.Gt(128|63&e);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|e>>>12),this.Gt(128|63&e>>>6),this.Gt(128|63&e);else{let e=t.codePointAt(0);this.Gt(240|e>>>18),this.Gt(128|63&e>>>12),this.Gt(128|63&e>>>6),this.Gt(128|63&e)}}this.zt()}Xt(e){for(let t of e){let e=t.charCodeAt(0);if(e<128)this.Ht(e);else if(e<2048)this.Ht(960|e>>>6),this.Ht(128|63&e);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|e>>>12),this.Ht(128|63&e>>>6),this.Ht(128|63&e);else{let e=t.codePointAt(0);this.Ht(240|e>>>18),this.Ht(128|63&e>>>12),this.Ht(128|63&e>>>6),this.Ht(128|63&e)}}this.Jt()}Yt(e){let t=this.en(e),r=iG(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let e=t.length-r;e<t.length;++e)this.buffer[this.position++]=255&t[e]}nn(e){let t=this.en(e),r=iG(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let e=t.length-r;e<t.length;++e)this.buffer[this.position++]=~(255&t[e])}rn(){this.sn(255),this.sn(255)}_n(){this.an(255),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){let t,r=((t=new DataView(new ArrayBuffer(8))).setFloat64(0,e,!1),new Uint8Array(t.buffer)),n=!!(128&r[0]);r[0]^=n?255:128;for(let e=1;e<r.length;++e)r[e]^=255*!!n;return r}Gt(e){let t=255&e;0===t?(this.sn(0),this.sn(255)):255===t?(this.sn(255),this.sn(0)):this.sn(t)}Ht(e){let t=255&e;0===t?(this.an(0),this.an(255)):255===t?(this.an(255),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let n=new Uint8Array(r);n.set(this.buffer),this.buffer=n}}class iH{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class iK{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class iW{constructor(){this.cn=new i$,this.ascending=new iH(this.cn),this.descending=new iK(this.cn)}seed(e){this.cn.seed(e)}ln(e){return 0===e?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}class iQ{constructor(e,t,r,n){this.hn=e,this.Pn=t,this.Tn=r,this.In=n}En(){let e=this.In.length,t=0===e||255===this.In[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.In,0),t!==e?r.set([0],this.In.length):++r[r.length-1],new iQ(this.hn,this.Pn,this.Tn,r)}Rn(e,t,r){return{indexId:this.hn,uid:e,arrayValue:iX(this.Tn),directionalValue:iX(this.In),orderedDocumentKey:iX(t),documentKey:r.path.toArray()}}An(e,t,r){let n=this.Rn(e,t,r);return[n.indexId,n.uid,n.arrayValue,n.directionalValue,n.orderedDocumentKey,n.documentKey]}}function iJ(e,t){let r=e.hn-t.hn;return 0!==r||0!==(r=iY(e.Tn,t.Tn))||0!==(r=iY(e.In,t.In))?r:G.comparator(e.Pn,t.Pn)}function iY(e,t){for(let r=0;r<e.length&&r<t.length;++r){let n=e[r]-t[r];if(0!==n)return n}return e.length-t.length}function iX(e){return c.isSafariOrWebkit()?function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}(e):e}function iZ(e){return"string"!=typeof e?e:function(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e)}class i0{constructor(e){for(const t of(this.Vn=new tL((e,t)=>z.comparator(e.field,t.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[],e.filters))t.isInequality()?this.Vn=this.Vn.add(t):this.mn.push(t)}get fn(){return this.Vn.size>1}gn(e){if(b(e.collectionGroup===this.collectionId,49279),this.fn)return!1;let t=en(e);if(void 0!==t&&!this.pn(t))return!1;let r=ei(e),n=new Set,i=0,s=0;for(;i<r.length&&this.pn(r[i]);++i)n=n.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Vn.size>0){let e=this.Vn.getIterator().getNext();if(!n.has(e.field.canonicalString())){let t=r[i];if(!this.yn(e,t)||!this.wn(this.dn[s++],t))return!1}++i}for(;i<r.length;++i){let e=r[i];if(s>=this.dn.length||!this.wn(this.dn[s++],e))return!1}return!0}bn(){if(this.fn)return null;let e=new tL(z.comparator),t=[];for(let r of this.mn)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)t.push(new ea(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new ea(r.field,0))}for(let r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new ea(r.field,+("asc"!==r.dir))));return new er(er.UNKNOWN_ID,this.collectionId,t,eo.empty())}pn(e){for(let t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;let r="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===r}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function i1(e){return e instanceof rT}function i2(e){return e instanceof rb&&rC(e)}function i6(e){return i1(e)||i2(e)||function(e){if(e instanceof rb&&rS(e)){for(let t of e.getFilters())if(!i1(t)&&!i2(t))return!1;return!0}return!1}(e)}function i3(e,t){return b(e instanceof rT||e instanceof rb,38388),b(t instanceof rT||t instanceof rb,25473),i5(e instanceof rT?t instanceof rT?rb.create([e,t],"and"):i4(e,t):t instanceof rT?i4(t,e):function(e,t){if(b(e.filters.length>0&&t.filters.length>0,48005),rA(e)&&rA(t))return rP(e,t.getFilters());let r=rS(e)?e:t,n=rS(e)?t:e,i=r.filters.map(e=>i3(e,n));return rb.create(i,"or")}(e,t))}function i4(e,t){if(rA(t))return rP(t,e.getFilters());{let r=t.filters.map(t=>i3(e,t));return rb.create(r,"or")}}function i5(e){if(b(e instanceof rT||e instanceof rb,11850),e instanceof rT)return e;let t=e.getFilters();if(1===t.length)return i5(t[0]);if(rR(e))return e;let r=t.map(e=>i5(e)),n=[];return r.forEach(t=>{t instanceof rT?n.push(t):t instanceof rb&&(t.op===e.op?n.push(...t.filters):n.push(t))}),1===n.length?n[0]:rb.create(n,e.op)}class i8{constructor(){this.Sn=new i7}addToCollectionParentIndex(e,t){return this.Sn.add(t),em.resolve()}getCollectionParents(e,t){return em.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return em.resolve()}deleteFieldIndex(e,t){return em.resolve()}deleteAllFieldIndexes(e){return em.resolve()}createTargetIndexes(e,t){return em.resolve()}getDocumentsMatchingTarget(e,t){return em.resolve(null)}getIndexType(e,t){return em.resolve(0)}getFieldIndexes(e,t){return em.resolve([])}getNextCollectionGroupToUpdate(e){return em.resolve(null)}getMinOffset(e,t){return em.resolve(ec.min())}getMinOffsetFromCollectionGroup(e,t){return em.resolve(ec.min())}updateCollectionGroup(e,t,r){return em.resolve()}updateIndexEntries(e,t){return em.resolve()}}class i7{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),n=this.index[t]||new tL(B.comparator),i=!n.has(r);return this.index[t]=n.add(r),i}has(e){let t=e.lastSegment(),r=e.popLast(),n=this.index[t];return n&&n.has(r)}getEntries(e){return(this.index[e]||new tL(B.comparator)).toArray()}}let i9="IndexedDbIndexManager",se=new Uint8Array(0);class st{constructor(e,t){this.databaseId=t,this.Dn=new i7,this.Cn=new r7(e=>rq(e),(e,t)=>rB(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){let r=t.lastSegment(),n=t.popLast();e.addOnCommittedListener(()=>{this.Dn.add(t)});let i={collectionId:r,parent:eO(n)};return tC(e,e9).put(i)}return em.resolve()}getCollectionParents(e,t){let r=[],n=IDBKeyRange.bound([t,""],[t+"\0",""],!1,!0);return tC(e,e9).H(n).next(e=>{for(let n of e){if(n.collectionId!==t)break;r.push(eL(n.parent))}return r})}addFieldIndex(e,t){let r=tC(e,ti),n={indexId:t.indexId,collectionGroup:t.collectionGroup,fields:t.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])};delete n.indexId;let i=r.add(n);if(t.indexState){let r=tC(e,ta);return i.next(e=>{r.put(iU(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){let r=tC(e,ti),n=tC(e,ta),i=tC(e,tc);return r.delete(t.indexId).next(()=>n.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=tC(e,ti),r=tC(e,tc),n=tC(e,ta);return t.X().next(()=>r.X()).next(()=>n.X())}createTargetIndexes(e,t){return em.forEach(this.vn(t),t=>this.getIndexType(e,t).next(r=>{if(0===r||1===r){let r=new i0(t).bn();if(null!=r)return this.addFieldIndex(e,r)}}))}getDocumentsMatchingTarget(e,t){let r=tC(e,tc),n=!0,i=new Map;return em.forEach(this.vn(t),t=>this.Fn(e,t).next(e=>{n&&(n=!!e),i.set(t,e)})).next(()=>{if(n){let e=na(),n=[];return em.forEach(i,(i,s)=>{_(i9,`Using index id=${i.indexId}|cg=${i.collectionGroup}|f=${i.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")} to execute ${rq(t)}`);let a=function(e,t){let r=en(t);if(void 0===r)return null;for(let t of rz(e,r.fieldPath))switch(t.op){case"array-contains-any":return t.value.arrayValue.values||[];case"array-contains":return[t.value]}return null}(s,i),o=function(e,t){let r=new Map;for(let n of ei(t))for(let t of rz(e,n.fieldPath))switch(t.op){case"==":case"in":r.set(n.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return r.set(n.fieldPath.canonicalString(),t.value),Array.from(r.values())}return null}(s,i),l=function(e,t){let r=[],n=!0;for(let i of ei(t)){let t=0===i.kind?rG(e,i.fieldPath,e.startAt):r$(e,i.fieldPath,e.startAt);r.push(t.value),n&&(n=t.inclusive)}return new r_(r,n)}(s,i),u=function(e,t){let r=[],n=!0;for(let i of ei(t)){let t=0===i.kind?r$(e,i.fieldPath,e.endAt):rG(e,i.fieldPath,e.endAt);r.push(t.value),n&&(n=t.inclusive)}return new r_(r,n)}(s,i),c=this.Mn(i,s,l),h=this.Mn(i,s,u),d=this.xn(i,s,o),f=this.On(i.indexId,a,c,l.inclusive,h,u.inclusive,d);return em.forEach(f,i=>r.Z(i,t.limit).next(t=>{t.forEach(t=>{let r=G.fromSegments(t.documentKey);e.has(r)||(e=e.add(r),n.push(r))})}))}).next(()=>n)}return em.resolve(null)})}vn(e){let t=this.Cn.get(e);return t||(t=0===e.filters.length?[e]:(function(e){if(0===e.getFilters().length)return[];let t=function e(t){if(b(t instanceof rT||t instanceof rb,34018),t instanceof rT)return t;if(1===t.filters.length)return e(t.filters[0]);let r=t.filters.map(t=>e(t)),n=rb.create(r,t.op);return i6(n=i5(n))?n:(b(n instanceof rb,64498),b(rA(n),40251),b(n.filters.length>1,57927),n.filters.reduce((e,t)=>i3(e,t)))}(function e(t){if(b(t instanceof rT||t instanceof rb,20012),t instanceof rT){if(t instanceof rL){let e=t.value.arrayValue?.values?.map(e=>rT.create(t.field,"==",e))||[];return rb.create(e,"or")}return t}let r=t.filters.map(t=>e(t));return rb.create(r,t.op)}(e));return b(i6(t),7391),i1(t)||i2(t)?[t]:t.getFilters()})(rb.create(e.filters,"and")).map(t=>rU(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.Cn.set(e,t)),t}On(e,t,r,n,i,s,a){let o=(null!=t?t.length:1)*Math.max(r.length,i.length),l=o/(null!=t?t.length:1),u=[];for(let c=0;c<o;++c){let o=t?this.Nn(t[c/l]):se,h=this.Bn(e,o,r[c%l],n),d=this.Ln(e,o,i[c%l],s),f=a.map(t=>this.Bn(e,o,t,!0));u.push(...this.createRange(h,d,f))}return u}Bn(e,t,r,n){let i=new iQ(e,G.empty(),t,r);return n?i:i.En()}Ln(e,t,r,n){let i=new iQ(e,G.empty(),t,r);return n?i.En():i}Fn(e,t){let r=new i0(t),n=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,n).next(e=>{let t=null;for(let n of e)r.gn(n)&&(!t||n.fields.length>t.fields.length)&&(t=n);return t})}getIndexType(e,t){let r=2,n=this.vn(t);return em.forEach(n,t=>this.Fn(e,t).next(e=>{e?0!==r&&e.fields.length<function(e){let t=new tL(z.comparator),r=!1;for(let n of e.filters)for(let e of n.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?r=!0:t=t.add(e.field));for(let r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+ +!!r}(t)&&(r=1):r=0})).next(()=>null!==t.limit&&n.length>1&&2===r?1:r)}kn(e,t){let r=new iW;for(let n of ei(e)){let e=t.data.field(n.fieldPath);if(null==e)return null;let i=r.ln(n.kind);iz.Wt.Dt(e,i)}return r.un()}Nn(e){let t=new iW;return iz.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){let r,n=new iW;return iz.Wt.Dt(ri(this.databaseId,t),n.ln(0===(r=ei(e)).length?0:r[r.length-1].kind)),n.un()}xn(e,t,r){if(null===r)return[];let n=[];n.push(new iW);let i=0;for(let s of ei(e)){let e=r[i++];for(let r of n)if(this.qn(t,s.fieldPath)&&ra(e))n=this.Un(n,s,e);else{let t=r.ln(s.kind);iz.Wt.Dt(e,t)}}return this.$n(n)}Mn(e,t,r){return this.xn(e,t,r.position)}$n(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Un(e,t,r){let n=[...e],i=[];for(let e of r.arrayValue.values||[])for(let r of n){let n=new iW;n.seed(r.un()),iz.Wt.Dt(e,n.ln(t.kind)),i.push(n)}return i}qn(e,t){return!!e.filters.find(e=>e instanceof rT&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){let r=tC(e,ti),n=tC(e,ta);return(t?r.H(ts,IDBKeyRange.bound(t,t)):r.H()).next(e=>{let t=[];return em.forEach(e,e=>n.get([e.indexId,this.uid]).next(r=>{let n,i;t.push((n=r?new eo(r.sequenceNumber,new ec(iD(r.readTime),new G(eL(r.documentKey)),r.largestBatchId)):eo.empty(),i=e.fields.map(([e,t])=>new ea(z.fromServerFormat(e),t)),new er(e.indexId,e.collectionGroup,i,n)))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{let r=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==r?r:L(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,r){let n=tC(e,ti),i=tC(e,ta);return this.Wn(e).next(e=>n.H(ts,IDBKeyRange.bound(t,t)).next(t=>em.forEach(t,t=>i.put(iU(t.indexId,this.uid,e,r)))))}updateIndexEntries(e,t){let r=new Map;return em.forEach(t,(t,n)=>{let i=r.get(t.collectionGroup);return(i?em.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next(i=>(r.set(t.collectionGroup,i),em.forEach(i,r=>this.Qn(e,t,r).next(t=>{let i=this.Gn(n,r);return t.isEqual(i)?em.resolve():this.zn(e,n,r,t,i)}))))})}jn(e,t,r,n){return tC(e,tc).put(n.Rn(this.uid,this.Kn(r,t.key),t.key))}Hn(e,t,r,n){return tC(e,tc).delete(n.An(this.uid,this.Kn(r,t.key),t.key))}Qn(e,t,r){let n=tC(e,tc),i=new tL(iJ);return n.ee({index:td,range:IDBKeyRange.only([r.indexId,this.uid,iX(this.Kn(r,t))])},(e,n)=>{i=i.add(new iQ(r.indexId,t,iZ(n.arrayValue),iZ(n.directionalValue)))}).next(()=>i)}Gn(e,t){let r=new tL(iJ),n=this.kn(t,e);if(null==n)return r;let i=en(t);if(null!=i){let s=e.data.field(i.fieldPath);if(ra(s))for(let i of s.arrayValue.values||[])r=r.add(new iQ(t.indexId,e.key,this.Nn(i),n))}else r=r.add(new iQ(t.indexId,e.key,se,n));return r}zn(e,t,r,n,i){_(i9,"Updating index entries for document '%s'",t.key);let s=[];return function(e,t,r,n,i){let s=e.getIterator(),a=t.getIterator(),o=tV(s),l=tV(a);for(;o||l;){let e=!1,t=!1;if(o&&l){let n=r(o,l);n<0?t=!0:n>0&&(e=!0)}else null!=o?t=!0:e=!0;e?(n(l),l=tV(a)):t?(i(o),o=tV(s)):(o=tV(s),l=tV(a))}}(n,i,iJ,n=>{s.push(this.jn(e,t,r,n))},n=>{s.push(this.Hn(e,t,r,n))}),em.waitFor(s)}Wn(e){let t=1;return tC(e,ta).ee({index:tl,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,r,n)=>{n.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((e,t)=>iJ(e,t)).filter((e,t,r)=>!t||0!==iJ(e,r[t-1]));let n=[];for(let i of(n.push(e),r)){let r=iJ(i,e),s=iJ(i,t);if(0===r)n[0]=e.En();else if(r>0&&s<0)n.push(i),n.push(i.En());else if(s>0)break}n.push(t);let i=[];for(let e=0;e<n.length;e+=2){if(this.Jn(n[e],n[e+1]))return[];let t=n[e].An(this.uid,se,G.empty()),r=n[e+1].An(this.uid,se,G.empty());i.push(IDBKeyRange.bound(t,r))}return i}Jn(e,t){return iJ(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(sr)}getMinOffset(e,t){return em.mapArray(this.vn(t),t=>this.Fn(e,t).next(e=>e||E(44426))).next(sr)}}function sr(e){b(0!==e.length,28825);let t=e[0].indexState.offset,r=t.largestBatchId;for(let n=1;n<e.length;n++){let i=e[n].indexState.offset;0>eh(i,t)&&(t=i),r<i.largestBatchId&&(r=i.largestBatchId)}return new ec(t.readTime,t.documentKey,r)}let sn={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class si{static withCacheSize(e){return new si(e,si.DEFAULT_COLLECTION_PERCENTILE,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function ss(e,t,r){let n=e.store(eq),i=e.store(e$),s=[],a=IDBKeyRange.only(r.batchId),o=0,l=n.ee({range:a},(e,t,r)=>(o++,r.delete()));s.push(l.next(()=>{b(1===o,47070,{batchId:r.batchId})}));let u=[];for(let e of r.mutations){var c,h;let n=(c=e.key.path,h=r.batchId,[t,eO(c),h]);s.push(i.delete(n)),u.push(e.key)}return em.waitFor(s).next(()=>u)}function sa(e){let t;if(!e)return 0;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw E(14731);t=e.noDocument}return JSON.stringify(t).length}si.DEFAULT_COLLECTION_PERCENTILE=10,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,si.DEFAULT=new si(0x2800000,si.DEFAULT_COLLECTION_PERCENTILE,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),si.DISABLED=new si(-1,0,0);class so{constructor(e,t,r,n){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=n,this.Zn={}}static wt(e,t,r,n){return b(""!==e.uid,64387),new so(e.isAuthenticated()?e.uid:"",t,r,n)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,-1/0],[this.userId,1/0]);return su(e).ee({index:ej,range:r},(e,r,n)=>{t=!1,n.done()}).next(()=>t)}addMutationBatch(e,t,r,n){let i=tC(e,e$),s=su(e);return s.add({}).next(a=>{var o,l,u,c;let h,d;b("number"==typeof a,49019);let f=new nM(a,t,r,n),p=(o=this.serializer,l=this.userId,h=f.baseMutations.map(e=>iy(o.yt,e)),d=f.mutations.map(e=>iy(o.yt,e)),{userId:l,batchId:f.batchId,localWriteTimeMs:f.localWriteTime.toMillis(),baseMutations:h,mutations:d}),m=[],g=new tL((e,t)=>L(e.canonicalString(),t.canonicalString()));for(let e of n){let t=(u=this.userId,c=e.key.path,[u,eO(c),a]);g=g.add(e.key.path.popLast()),m.push(s.put(p)),m.push(i.put(t,eG))}return g.forEach(t=>{m.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.Zn[a]=f.keys()}),em.waitFor(m).next(()=>f)})}lookupMutationBatch(e,t){return su(e).get(t).next(e=>e?(b(e.userId===this.userId,48,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),ix(this.serializer,e)):null)}Xn(e,t){return this.Zn[t]?em.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){let r=e.keys();return this.Zn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,n=IDBKeyRange.lowerBound([this.userId,r]),i=null;return su(e).ee({index:ej,range:n},(e,t,n)=>{t.userId===this.userId&&(b(t.batchId>=r,47524,{Yn:r}),i=ix(this.serializer,t)),n.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,1/0]),r=-1;return su(e).ee({index:ej,range:t,reverse:!0},(e,t,n)=>{r=t.batchId,n.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,1/0]);return su(e).H(ej,t).next(e=>e.map(e=>ix(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=[this.userId,eO(t.path)],n=IDBKeyRange.lowerBound(r),i=[];return tC(e,e$).ee({range:n},(r,n,s)=>{let[a,o,l]=r,u=eL(o);if(a===this.userId&&t.path.isEqual(u))return su(e).get(l).next(e=>{if(!e)throw E(61480,{er:r,batchId:l});b(e.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:e.userId,batchId:l}),i.push(ix(this.serializer,e))});s.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new tL(L),n=[];return t.forEach(t=>{let i=[this.userId,eO(t.path)],s=IDBKeyRange.lowerBound(i),a=tC(e,e$).ee({range:s},(e,n,i)=>{let[s,a,o]=e,l=eL(a);s===this.userId&&t.path.isEqual(l)?r=r.add(o):i.done()});n.push(a)}),em.waitFor(n).next(()=>this.tr(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,n=r.length+1,i=[this.userId,eO(r)],s=IDBKeyRange.lowerBound(i),a=new tL(L);return tC(e,e$).ee({range:s},(e,t,i)=>{let[s,o,l]=e,u=eL(o);s===this.userId&&r.isPrefixOf(u)?u.length===n&&(a=a.add(l)):i.done()}).next(()=>this.tr(e,a))}tr(e,t){let r=[],n=[];return t.forEach(t=>{n.push(su(e).get(t).next(e=>{if(null===e)throw E(35274,{batchId:t});b(e.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),r.push(ix(this.serializer,e))}))}),em.waitFor(n).next(()=>r)}removeMutationBatch(e,t){return ss(e.le,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.nr(t.batchId)}),em.forEach(r,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return em.resolve();let r=IDBKeyRange.lowerBound([this.userId]),n=[];return tC(e,e$).ee({range:r},(e,t,r)=>{if(e[0]===this.userId){let t=eL(e[1]);n.push(t)}else r.done()}).next(()=>{b(0===n.length,56720,{rr:n.map(e=>e.canonicalString())})})})}containsKey(e,t){return sl(e,this.userId,t)}ir(e){return tC(e,eU).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function sl(e,t,r){let n=[t,eO(r.path)],i=n[1],s=IDBKeyRange.lowerBound(n),a=!1;return tC(e,e$).ee({range:s,Y:!0},(e,r,n)=>{let[s,o,l]=e;s===t&&o===i&&(a=!0),n.done()}).next(()=>a)}function su(e){return tC(e,eq)}class sc{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new sc(0)}static ar(){return new sc(-1)}}class sh{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next(t=>{let r=new sc(t.highestTargetId);return t.highestTargetId=r.next(),this.cr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.ur(e).next(e=>et.fromTimestamp(new ee(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.ur(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.ur(e).next(n=>(n.highestListenSequenceNumber=t,r&&(n.lastRemoteSnapshotVersion=r.toTimestamp()),t>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=t),this.cr(e,n)))}addTargetData(e,t){return this.lr(e,t).next(()=>this.ur(e).next(r=>(r.targetCount+=1,this.hr(t,r),this.cr(e,r))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>tC(e,e0).delete(t.targetId)).next(()=>this.ur(e)).next(t=>(b(t.targetCount>0,8065),t.targetCount-=1,this.cr(e,t)))}removeTargets(e,t,r){let n=0,i=[];return tC(e,e0).ee((s,a)=>{let o=iO(a);o.sequenceNumber<=t&&null===r.get(o.targetId)&&(n++,i.push(this.removeTargetData(e,o)))}).next(()=>em.waitFor(i)).next(()=>n)}forEachTarget(e,t){return tC(e,e0).ee((e,r)=>{t(iO(r))})}ur(e){return tC(e,e7).get(e8).next(e=>(b(null!==e,2888),e))}cr(e,t){return tC(e,e7).put(e8,t)}lr(e,t){return tC(e,e0).put(iL(this.serializer,t))}hr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.ur(e).next(e=>e.targetCount)}getTargetData(e,t){let r=rq(t),n=IDBKeyRange.bound([r,-1/0],[r,1/0]),i=null;return tC(e,e0).ee({range:n,index:e1},(e,r,n)=>{let s=iO(r);rB(t,s.target)&&(i=s,n.done())}).next(()=>i)}addMatchingKeys(e,t,r){let n=[],i=sd(e);return t.forEach(t=>{let s=eO(t.path);n.push(i.put({targetId:r,path:s})),n.push(this.referenceDelegate.addReference(e,r,t))}),em.waitFor(n)}removeMatchingKeys(e,t,r){let n=sd(e);return em.forEach(t,t=>{let i=eO(t.path);return em.waitFor([n.delete([r,i]),this.referenceDelegate.removeReference(e,r,t)])})}removeMatchingKeysForTargetId(e,t){let r=sd(e),n=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(n)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),n=sd(e),i=na();return n.ee({range:r,Y:!0},(e,t,r)=>{let n=new G(eL(e[1]));i=i.add(n)}).next(()=>i)}containsKey(e,t){let r=eO(t.path),n=IDBKeyRange.bound([r],[r+"\0"],!1,!0),i=0;return sd(e).ee({index:e4,Y:!0,range:n},([e,t],r,n)=>{0!==e&&(i++,n.done())}).next(()=>i>0)}At(e,t){return tC(e,e0).get(t).next(e=>e?iO(e):null)}}function sd(e){return tC(e,e6)}let sf="LruGarbageCollector";function sp([e,t],[r,n]){let i=L(e,r);return 0===i?L(t,n):i}class sm{constructor(e){this.Pr=e,this.buffer=new tL(sp),this.Tr=0}Ir(){return++this.Tr}Er(e){let t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{let e=this.buffer.last();0>sp(t,e)&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class sg{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Ar(e){_(sf,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){eE(e)?_(sf,"Ignoring IndexedDB error during garbage collection: ",e):await ep(e)}await this.Ar(3e5)})}}class sy{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return em.resolve(ek.ce);let r=new sm(t);return this.Vr.forEachTarget(e,e=>r.Er(e.sequenceNumber)).next(()=>this.Vr.mr(e,e=>r.Er(e))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return -1===this.params.cacheSizeCollectionThreshold?(_("LruGarbageCollector","Garbage collection skipped; disabled"),em.resolve(sn)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(_("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),sn):this.gr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let r,n,i,s,a,o,l,u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(_("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),n=this.params.maximumSequenceNumbersToCollect):n=t,s=Date.now(),this.nthSequenceNumber(e,n))).next(n=>(r=n,a=Date.now(),this.removeTargets(e,r,t))).next(t=>(i=t,o=Date.now(),this.removeOrphanedDocuments(e,r))).next(e=>(l=Date.now(),y()<=d.LogLevel.DEBUG&&_("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-u}ms
	Determined least recently used ${n} in `+(a-s)+"ms\n"+`	Removed ${i} targets in `+(o-a)+"ms\n"+`	Removed ${e} documents in `+(l-o)+"ms\n"+`Total Duration: ${l-u}ms`),em.resolve({didRun:!0,sequenceNumbersCollected:n,targetsRemoved:i,documentsRemoved:e})))}}class s_{constructor(e,t){this.db=e,this.garbageCollector=new sy(this,t)}dr(e){let t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}pr(e){let t=0;return this.mr(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,(e,r)=>t(r))}addReference(e,t,r){return sv(e,r)}removeReference(e,t,r){return sv(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return sv(e,t)}wr(e,t){let r;return r=!1,tC(e,eU).te(n=>sl(e,n,t).next(e=>(e&&(r=!0),em.resolve(!e)))).next(()=>r)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),n=[],i=0;return this.yr(e,(s,a)=>{if(a<=t){let t=this.wr(e,s).next(t=>{if(!t)return i++,r.getEntry(e,s).next(()=>(r.removeEntry(s,et.min()),sd(e).delete([0,eO(s.path)])))});n.push(t)}}).next(()=>em.waitFor(n)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return sv(e,t)}yr(e,t){let r=sd(e),n,i=ek.ce;return r.ee({index:e4},([e,r],{path:s,sequenceNumber:a})=>{0===e?(i!==ek.ce&&t(new G(eL(n)),i),i=a,n=s):i=ek.ce}).next(()=>{i!==ek.ce&&t(new G(eL(n)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function sv(e,t){var r;return sd(e).put((r=e.currentSequenceNumber,{targetId:0,path:eO(t.path),sequenceNumber:r}))}class sw{constructor(){this.changes=new r7(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ry.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return void 0!==r?em.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class sI{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return tC(e,eH).put(r)}removeEntry(e,t,r){let n;return tC(e,eH).delete([(n=t.path.toArray()).slice(0,n.length-2),n[n.length-2],ik(r),n[n.length-1]])}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.br(e,r)))}getEntry(e,t){let r=ry.newInvalidDocument(t);return tC(e,eH).ee({index:eW,range:IDBKeyRange.only(sT(t))},(e,n)=>{r=this.Sr(t,n)}).next(()=>r)}Dr(e,t){let r={size:0,document:ry.newInvalidDocument(t)};return tC(e,eH).ee({index:eW,range:IDBKeyRange.only(sT(t))},(e,n)=>{r={document:this.Sr(t,n),size:sa(n)}}).next(()=>r)}getEntries(e,t){let r=r9;return this.Cr(e,t,(e,t)=>{let n=this.Sr(e,t);r=r.insert(e,n)}).next(()=>r)}vr(e,t){let r=r9,n=new tD(G.comparator);return this.Cr(e,t,(e,t)=>{let i=this.Sr(e,t);r=r.insert(e,i),n=n.insert(e,sa(t))}).next(()=>({documents:r,Fr:n}))}Cr(e,t,r){if(t.isEmpty())return em.resolve();let n=new tL(sA);t.forEach(e=>n=n.add(e));let i=IDBKeyRange.bound(sT(n.first()),sT(n.last())),s=n.getIterator(),a=s.getNext();return tC(e,eH).ee({index:eW,range:i},(e,t,n)=>{let i=G.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;a&&0>sA(a,i);)r(a,null),a=s.getNext();a&&a.isEqual(i)&&(r(a,t),a=s.hasNext()?s.getNext():null),a?n.j(sT(a)):n.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,n,i){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),ik(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],o=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return tC(e,eH).H(IDBKeyRange.bound(a,o,!0)).next(e=>{i?.incrementDocumentReadCount(e.length);let r=r9;for(let i of e){let e=this.Sr(G.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(r4(t,e)||n.has(e.key))&&(r=r.insert(e.key,e))}return r})}getAllFromCollectionGroup(e,t,r,n){let i=r9,s=sb(t,r),a=sb(t,ec.max());return tC(e,eH).ee({index:eJ,range:IDBKeyRange.bound(s,a,!0)},(e,t,r)=>{let s=this.Sr(G.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(i=i.insert(s.key,s)).size===n&&r.done()}).next(()=>i)}newChangeBuffer(e){return new sE(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return tC(e,eX).get(eZ).next(e=>(b(!!e,20021),e))}br(e,t){return tC(e,eX).put(eZ,t)}Sr(e,t){if(t){let e=function(e,t){var r;let n,i;if(t.document)n=ig(e.yt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){let e=G.fromSegments(t.noDocument.path),r=iD(t.noDocument.readTime);n=ry.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return E(56709);{let e=G.fromSegments(t.unknownDocument.path),r=iD(t.unknownDocument.version);n=ry.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime((i=new ee((r=t.readTime)[0],r[1]),et.fromTimestamp(i))),n}(this.serializer,t);if(!(e.isNoDocument()&&e.version.isEqual(et.min())))return e}return ry.newInvalidDocument(e)}}class sE extends sw{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new r7(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){let t=[],r=0,n=new tL((e,t)=>L(e.canonicalString(),t.canonicalString()));return this.changes.forEach((i,s)=>{let a=this.Or.get(i);if(t.push(this.Mr.removeEntry(e,i,a.readTime)),s.isValidDocument()){let o=iP(this.Mr.serializer,s);n=n.add(i.path.popLast());let l=sa(o);r+=l-a.size,t.push(this.Mr.addEntry(e,i,o))}else if(r-=a.size,this.trackRemovals){let r=iP(this.Mr.serializer,s.convertToNoDocument(et.min()));t.push(this.Mr.addEntry(e,i,r))}}),n.forEach(r=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,r))}),t.push(this.Mr.updateMetadata(e,r)),em.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next(e=>(this.Or.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.Mr.vr(e,t).next(({documents:e,Fr:t})=>(t.forEach((t,r)=>{this.Or.set(t,{size:r,readTime:e.get(t).readTime})}),e))}}function sT(e){let t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function sb(e,t){let r=t.documentKey.path.toArray();return[e,ik(t.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function sA(e,t){let r=e.path.toArray(),n=t.path.toArray(),i=0;for(let e=0;e<r.length-2&&e<n.length-2;++e)if(i=L(r[e],n[e]))return i;return(i=L(r.length,n.length))||(i=L(r[r.length-2],n[n.length-2]))||L(r[r.length-1],n[n.length-1])}class sS{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class sC{constructor(e,t,r,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=n}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(n=>(r=n,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==r&&nC(r.mutation,e,tF.empty(),ee.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,na()).next(()=>t))}getLocalViewOfDocuments(e,t,r=na()){let n=nn();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,r).next(e=>{let t=nt();return e.forEach((e,r)=>{t=t.insert(e,r.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){let r=nn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,na()))}populateOverlays(e,t,r){let n=[];return r.forEach(e=>{t.has(e)||n.push(e)}),this.documentOverlayCache.getOverlays(e,n).next(e=>{e.forEach((e,r)=>{t.set(e,r)})})}computeViews(e,t,r,n){let i=r9,s=nn(),a=nn();return t.forEach((e,t)=>{let a=r.get(t.key);n.has(t.key)&&(void 0===a||a.mutation instanceof nk)?i=i.insert(t.key,t):void 0!==a?(s.set(t.key,a.mutation.getFieldMask()),nC(a.mutation,t,a.mutation.getFieldMask(),ee.now())):s.set(t.key,tF.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>a.set(e,new sS(t,s.get(e)??null))),a))}recalculateAndSaveOverlays(e,t){let r=nn(),n=new tD((e,t)=>e-t),i=na();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(let i of e)i.keys().forEach(e=>{let s=t.get(e);if(null===s)return;let a=r.get(e)||tF.empty();a=i.applyToLocalView(s,a),r.set(e,a);let o=(n.get(i.batchId)||na()).add(e);n=n.insert(i.batchId,o)})}).next(()=>{let s=[],a=n.getReverseIterator();for(;a.hasNext();){let n=a.getNext(),o=n.key,l=n.value,u=nn();l.forEach(e=>{if(!i.has(e)){let n=nS(t.get(e),r.get(e));null!==n&&u.set(e,n),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,u))}return em.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,r,n){return rQ(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):rJ(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,n):this.getDocumentsMatchingCollectionQuery(e,t,r,n)}getNextDocuments(e,t,r,n){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,n).next(i=>{let s=n-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,n-i.size):em.resolve(nn()),a=-1,o=i;return s.next(t=>em.forEach(t,(t,r)=>(a<r.largestBatchId&&(a=r.largestBatchId),i.get(t)?em.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,o,t,na())).next(e=>({batchId:a,changes:nr(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new G(t)).next(e=>{let t=nt();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,r,n){let i=t.collectionGroup,s=nt();return this.indexManager.getCollectionParents(e,i).next(a=>em.forEach(a,a=>{let o=new rH(a.child(i),null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt);return this.getDocumentsMatchingCollectionQuery(e,o,r,n).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,n))).next(e=>{i.forEach((t,r)=>{let n=r.getKey();null===e.get(n)&&(e=e.insert(n,ry.newInvalidDocument(n)))});let r=nt();return e.forEach((e,n)=>{let s=i.get(e);void 0!==s&&nC(s.mutation,n,tF.empty(),ee.now()),r4(t,n)&&(r=r.insert(e,n))}),r})}}class sR{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return em.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,{id:t.id,version:t.version,createTime:ir(t.createTime)}),em.resolve()}getNamedQuery(e,t){return em.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,{name:t.name,query:iM(t.bundledQuery),readTime:ir(t.readTime)}),em.resolve()}}class sP{constructor(){this.overlays=new tD(G.comparator),this.Lr=new Map}getOverlay(e,t){return em.resolve(this.overlays.get(t))}getOverlays(e,t){let r=nn();return em.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((r,n)=>{this.bt(e,t,n)}),em.resolve()}removeOverlaysForBatchId(e,t,r){let n=this.Lr.get(r);return void 0!==n&&(n.forEach(e=>this.overlays=this.overlays.remove(e)),this.Lr.delete(r)),em.resolve()}getOverlaysForCollection(e,t,r){let n=nn(),i=t.length+1,s=new G(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let e=a.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>r&&n.set(e.getKey(),e)}return em.resolve(n)}getOverlaysForCollectionGroup(e,t,r,n){let i=new tD((e,t)=>e-t),s=this.overlays.getIterator();for(;s.hasNext();){let e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>r){let t=i.get(e.largestBatchId);null===t&&(t=nn(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}let a=nn(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=n)););return em.resolve(a)}bt(e,t,r){let n=this.overlays.get(r.key);if(null!==n){let e=this.Lr.get(n.largestBatchId).delete(r.key);this.Lr.set(n.largestBatchId,e)}this.overlays=this.overlays.insert(r.key,new nF(t,r));let i=this.Lr.get(t);void 0===i&&(i=na(),this.Lr.set(t,i)),this.Lr.set(t,i.add(r.key))}}class sk{constructor(){this.sessionToken=tq.EMPTY_BYTE_STRING}getSessionToken(e){return em.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,em.resolve()}}class sN{constructor(){this.kr=new tL(sD.Kr),this.qr=new tL(sD.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){let r=new sD(e,t);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Wr(new sD(e,t))}Qr(e,t){e.forEach(e=>this.removeReference(e,t))}Gr(e){let t=new G(new B([])),r=new sD(t,e),n=new sD(t,e+1),i=[];return this.qr.forEachInRange([r,n],e=>{this.Wr(e),i.push(e.key)}),i}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){let t=new G(new B([])),r=new sD(t,e),n=new sD(t,e+1),i=na();return this.qr.forEachInRange([r,n],e=>{i=i.add(e.key)}),i}containsKey(e){let t=new sD(e,0),r=this.kr.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class sD{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return G.comparator(e.key,t.key)||L(e.Hr,t.Hr)}static Ur(e,t){return L(e.Hr,t.Hr)||G.comparator(e.key,t.key)}}class sx{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new tL(sD.Kr)}checkEmpty(e){return em.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,n){let i=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new nM(i,t,r,n);for(let t of(this.mutationQueue.push(s),n))this.Jr=this.Jr.add(new sD(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return em.resolve(s)}lookupMutationBatch(e,t){return em.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=this.Xr(t+1),n=r<0?0:r;return em.resolve(this.mutationQueue.length>n?this.mutationQueue[n]:null)}getHighestUnacknowledgedBatchId(){return em.resolve(0===this.mutationQueue.length?-1:this.Yn-1)}getAllMutationBatches(e){return em.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new sD(t,0),n=new sD(t,1/0),i=[];return this.Jr.forEachInRange([r,n],e=>{let t=this.Zr(e.Hr);i.push(t)}),em.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new tL(L);return t.forEach(e=>{let t=new sD(e,0),n=new sD(e,1/0);this.Jr.forEachInRange([t,n],e=>{r=r.add(e.Hr)})}),em.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,n=r.length+1,i=r;G.isDocumentKey(i)||(i=i.child(""));let s=new sD(new G(i),0),a=new tL(L);return this.Jr.forEachWhile(e=>{let t=e.key.path;return!!r.isPrefixOf(t)&&(t.length===n&&(a=a.add(e.Hr)),!0)},s),em.resolve(this.Yr(a))}Yr(e){let t=[];return e.forEach(e=>{let r=this.Zr(e);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){b(0===this.ei(t.batchId,"removed"),55003),this.mutationQueue.shift();let r=this.Jr;return em.forEach(t.mutations,n=>{let i=new sD(n.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,n.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,t){let r=new sD(t,0),n=this.Jr.firstAfterOrEqual(r);return em.resolve(t.isEqual(n&&n.key))}performConsistencyCheck(e){return this.mutationQueue.length,em.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class sO{constructor(e){this.ti=e,this.docs=new tD(G.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,n=this.docs.get(r),i=n?n.size:0,s=this.ti(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return em.resolve(r?r.document.mutableCopy():ry.newInvalidDocument(t))}getEntries(e,t){let r=r9;return t.forEach(e=>{let t=this.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():ry.newInvalidDocument(e))}),em.resolve(r)}getDocumentsMatchingQuery(e,t,r,n){let i=r9,s=t.path,a=new G(s.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){let{key:e,value:{document:a}}=o.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||0>=eh(eu(a),r)||(n.has(a.key)||r4(t,a))&&(i=i.insert(a.key,a.mutableCopy()))}return em.resolve(i)}getAllFromCollectionGroup(e,t,r,n){E(9500)}ni(e,t){return em.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new sL(this)}getSize(e){return em.resolve(this.size)}}class sL extends sw{constructor(e){super(),this.Mr=e}applyChanges(e){let t=[];return this.changes.forEach((r,n)=>{n.isValidDocument()?t.push(this.Mr.addEntry(e,n)):this.Mr.removeEntry(r)}),em.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class sM{constructor(e){this.persistence=e,this.ri=new r7(e=>rq(e),rB),this.lastRemoteSnapshotVersion=et.min(),this.highestTargetId=0,this.ii=0,this.si=new sN,this.targetCount=0,this.oi=sc._r()}forEachTarget(e,t){return this.ri.forEach((e,r)=>t(r)),em.resolve()}getLastRemoteSnapshotVersion(e){return em.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return em.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),em.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ii&&(this.ii=t),em.resolve()}lr(e){this.ri.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.oi=new sc(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,em.resolve()}updateTargetData(e,t){return this.lr(t),em.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,em.resolve()}removeTargets(e,t,r){let n=0,i=[];return this.ri.forEach((s,a)=>{a.sequenceNumber<=t&&null===r.get(a.targetId)&&(this.ri.delete(s),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),n++)}),em.waitFor(i).next(()=>n)}getTargetCount(e){return em.resolve(this.targetCount)}getTargetData(e,t){let r=this.ri.get(t)||null;return em.resolve(r)}addMatchingKeys(e,t,r){return this.si.$r(t,r),em.resolve()}removeMatchingKeys(e,t,r){this.si.Qr(t,r);let n=this.persistence.referenceDelegate,i=[];return n&&t.forEach(t=>{i.push(n.markPotentiallyOrphaned(e,t))}),em.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),em.resolve()}getMatchingKeysForTargetId(e,t){let r=this.si.jr(t);return em.resolve(r)}containsKey(e,t){return em.resolve(this.si.containsKey(t))}}class sV{constructor(e,t){this._i={},this.overlays={},this.ai=new ek(0),this.ui=!1,this.ui=!0,this.ci=new sk,this.referenceDelegate=e(this),this.li=new sM(this),this.indexManager=new i8,this.remoteDocumentCache=new sO(e=>this.referenceDelegate.hi(e)),this.serializer=new iR(t),this.Pi=new sR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new sP,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this._i[e.toKey()];return r||(r=new sx(t,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,r){_("MemoryPersistence","Starting transaction:",e);let n=new sF(this.ai.next());return this.referenceDelegate.Ti(),r(n).next(e=>this.referenceDelegate.Ii(n).next(()=>e)).toPromise().then(e=>(n.raiseOnCommittedEvent(),e))}Ei(e,t){return em.or(Object.values(this._i).map(r=>()=>r.containsKey(e,t)))}}class sF extends ef{constructor(e){super(),this.currentSequenceNumber=e}}class sU{constructor(e){this.persistence=e,this.Ri=new sN,this.Ai=null}static Vi(e){return new sU(e)}get di(){if(this.Ai)return this.Ai;throw E(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.di.delete(r.toString()),em.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.di.add(r.toString()),em.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),em.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach(e=>this.di.add(e.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.di.add(e.toString()))}).next(()=>r.removeTargetData(e,t))}Ti(){this.Ai=new Set}Ii(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return em.forEach(this.di,r=>{let n=G.fromPath(r);return this.mi(e,n).next(e=>{e||t.removeEntry(n,et.min())})}).next(()=>(this.Ai=null,t.apply(e)))}updateLimboDocument(e,t){return this.mi(e,t).next(e=>{e?this.di.delete(t.toString()):this.di.add(t.toString())})}hi(e){return 0}mi(e,t){return em.or([()=>em.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class sq{constructor(e,t){this.persistence=e,this.fi=new r7(e=>eO(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=new sy(this,t)}static Vi(e,t){return new sq(e,t)}Ti(){}Ii(e){return em.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}pr(e){let t=0;return this.mr(e,e=>{t++}).next(()=>t)}mr(e,t){return em.forEach(this.fi,(r,n)=>this.wr(e,r,n).next(e=>e?em.resolve():t(n)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,n=this.persistence.getRemoteDocumentCache(),i=n.newChangeBuffer();return n.ni(e,n=>this.wr(e,n,t).next(e=>{e||(r++,i.removeEntry(n,et.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),em.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),em.resolve()}removeReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),em.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),em.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=function e(t){switch(t8(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let r=tJ(t);return r?16+e(r):16;case 5:return 2*t.stringValue.length;case 6:return tG(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(t.arrayValue.values||[]).reduce((t,r)=>t+e(r),0);case 10:case 11:var n;let i;return n=t.mapValue,i=0,tP(n.fields,(t,r)=>{i+=t.length+e(r)}),i;default:throw E(13486,{value:t})}}(e.data.value)),t}wr(e,t,r){return em.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let e=this.fi.get(t);return em.resolve(void 0!==e&&e>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class sB{constructor(e){this.serializer=e}k(e,t,r,n){let i=new ey("createOrUpgrade",t);r<1&&n>=1&&(e.createObjectStore(eV),e.createObjectStore(eU,{keyPath:"userId"}),e.createObjectStore(eq,{keyPath:eB,autoIncrement:!0}).createIndex(ej,ez,{unique:!0}),e.createObjectStore(e$),sj(e),e.createObjectStore(eM));let s=em.resolve();return r<3&&n>=3&&(0!==r&&(e.deleteObjectStore(e6),e.deleteObjectStore(e0),e.deleteObjectStore(e7),sj(e)),s=s.next(()=>{let e,t;return e=i.store(e7),t={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:et.min().toTimestamp(),targetCount:0},e.put(e8,t)})),r<4&&n>=4&&(0!==r&&(s=s.next(()=>i.store(eq).H().next(t=>{e.deleteObjectStore(eq),e.createObjectStore(eq,{keyPath:eB,autoIncrement:!0}).createIndex(ej,ez,{unique:!0});let r=i.store(eq),n=t.map(e=>r.put(e));return em.waitFor(n)}))),s=s.next(()=>{e.createObjectStore(tt,{keyPath:"clientId"})})),r<5&&n>=5&&(s=s.next(()=>this.gi(i))),r<6&&n>=6&&(s=s.next(()=>(e.createObjectStore(eX),this.pi(i)))),r<7&&n>=7&&(s=s.next(()=>this.yi(i))),r<8&&n>=8&&(s=s.next(()=>this.wi(e,i))),r<9&&n>=9&&(s=s.next(()=>{e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")})),r<10&&n>=10&&(s=s.next(()=>this.bi(i))),r<11&&n>=11&&(s=s.next(()=>{e.createObjectStore(tr,{keyPath:"bundleId"}),e.createObjectStore(tn,{keyPath:"name"})})),r<12&&n>=12&&(s=s.next(()=>{let t;(t=e.createObjectStore(tp,{keyPath:tm})).createIndex(tg,ty,{unique:!1}),t.createIndex(t_,tv,{unique:!1})})),r<13&&n>=13&&(s=s.next(()=>{let t;(t=e.createObjectStore(eH,{keyPath:eK})).createIndex(eW,eQ),t.createIndex(eJ,eY)}).next(()=>this.Si(e,i)).next(()=>e.deleteObjectStore(eM))),r<14&&n>=14&&(s=s.next(()=>this.Di(e,i))),r<15&&n>=15&&(s=s.next(()=>{e.createObjectStore(ti,{keyPath:"indexId",autoIncrement:!0}).createIndex(ts,"collectionGroup",{unique:!1}),e.createObjectStore(ta,{keyPath:to}).createIndex(tl,tu,{unique:!1}),e.createObjectStore(tc,{keyPath:th}).createIndex(td,tf,{unique:!1})})),r<16&&n>=16&&(s=s.next(()=>{t.objectStore(ta).clear()}).next(()=>{t.objectStore(tc).clear()})),r<17&&n>=17&&(s=s.next(()=>{e.createObjectStore(tw,{keyPath:"name"})})),r<18&&n>=18&&c.isSafariOrWebkit()&&(s=s.next(()=>{t.objectStore(ta).clear()}).next(()=>{t.objectStore(tc).clear()})),s}pi(e){let t=0;return e.store(eM).ee((e,r)=>{t+=sa(r)}).next(()=>{let r={byteSize:t};return e.store(eX).put(eZ,r)})}gi(e){let t=e.store(eU),r=e.store(eq);return t.H().next(t=>em.forEach(t,t=>{let n=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return r.H(ej,n).next(r=>em.forEach(r,r=>{b(r.userId===t.userId,18650,"Cannot process batch from unexpected user",{batchId:r.batchId});let n=ix(this.serializer,r);return ss(e,t.userId,n).next(()=>{})}))}))}yi(e){let t=e.store(e6),r=e.store(eM);return e.store(e7).get(e8).next(e=>{let n=[];return r.ee((r,i)=>{let s=new B(r),a=[0,eO(s)];n.push(t.get(a).next(r=>r?em.resolve():t.put({targetId:0,path:eO(s),sequenceNumber:e.highestListenSequenceNumber})))}).next(()=>em.waitFor(n))})}wi(e,t){e.createObjectStore(e9,{keyPath:te});let r=t.store(e9),n=new i7,i=e=>{if(n.add(e)){let t=e.lastSegment(),n=e.popLast();return r.put({collectionId:t,parent:eO(n)})}};return t.store(eM).ee({Y:!0},(e,t)=>i(new B(e).popLast())).next(()=>t.store(e$).ee({Y:!0},([e,t,r],n)=>i(eL(t).popLast())))}bi(e){let t=e.store(e0);return t.ee((e,r)=>{let n=iO(r),i=iL(this.serializer,n);return t.put(i)})}Si(e,t){let r=t.store(eM),n=[];return r.ee((e,r)=>{let i=t.store(eH),s=(r.document?new G(B.fromString(r.document.name).popFirst(5)):r.noDocument?G.fromSegments(r.noDocument.path):r.unknownDocument?G.fromSegments(r.unknownDocument.path):E(36783)).path.toArray(),a={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:r.readTime||[0,0],unknownDocument:r.unknownDocument,noDocument:r.noDocument,document:r.document,hasCommittedMutations:!!r.hasCommittedMutations};n.push(i.put(a))}).next(()=>em.waitFor(n))}Di(e,t){let r=t.store(eq),n=new sI(this.serializer),i=new sV(sU.Vi,this.serializer.yt);return r.H().next(e=>{let r=new Map;return e.forEach(e=>{let t=r.get(e.userId)??na();ix(this.serializer,e).keys().forEach(e=>t=t.add(e)),r.set(e.userId,t)}),em.forEach(r,(e,r)=>{let s=new p(r),a=iB.wt(this.serializer,s),o=i.getIndexManager(s);return new sC(n,so.wt(s,this.serializer,o,i.referenceDelegate),a,o).recalculateAndSaveOverlaysForDocumentKeys(new tS(t,ek.ce),e).next()})})}}function sj(e){e.createObjectStore(e6,{keyPath:e3}).createIndex(e4,e5,{unique:!0}),e.createObjectStore(e0,{keyPath:"targetId"}).createIndex(e1,e2,{unique:!0}),e.createObjectStore(e7)}let sz="IndexedDbPersistence",sG="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",s$="main";class sH{constructor(e,t,r,n,i,s,a,o,l,u,c=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Ci=i,this.window=s,this.document=a,this.Fi=l,this.Mi=u,this.xi=c,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=-1/0,this.ki=e=>Promise.resolve(),!sH.v())throw new S(A.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new s_(this,n),this.Ki=t+s$,this.serializer=new iR(o),this.qi=new e_(this.Ki,this.xi,new sB(this.serializer)),this.ci=new ij,this.li=new sh(this.referenceDelegate,this.serializer),this.remoteDocumentCache=new sI(this.serializer),this.Pi=new iq,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,!1===u&&v(sz,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new S(A.FAILED_PRECONDITION,sG);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.li.getHighestSequenceNumber(e))}).then(e=>{this.ai=new ek(e,this.Fi)}).then(()=>{this.ui=!0}).catch(e=>(this.qi&&this.qi.close(),Promise.reject(e)))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q(async t=>{null===t.newVersion&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget(async()=>{this.started&&await this.$i()}))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>tC(e,tt).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ji(e).next(e=>{e||(this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)))})}).next(()=>this.Hi(e)).next(t=>this.isPrimary&&!t?this.Ji(e).next(()=>!1):!!t&&this.Zi(e).next(()=>!0))).catch(e=>{if(eE(e))return _(sz,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return _(sz,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable(()=>this.ki(e)),this.isPrimary=e})}ji(e){return tC(e,eV).get(eF).next(e=>em.resolve(this.Xi(e)))}Yi(e){return tC(e,tt).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,18e5)){this.Li=Date.now();let e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{let t=tC(e,tt);return t.H().next(e=>{let r=this.ns(e,18e5),n=e.filter(e=>-1===r.indexOf(e));return em.forEach(n,e=>t.delete(e.clientId)).next(()=>n)})}).catch(()=>[]);if(this.Ui)for(let t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.$i().then(()=>this.es()).then(()=>this.Gi()))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?em.resolve(!0):tC(e,eV).get(eF).next(t=>{if(null!==t&&this.ts(t.leaseTimestampMs,5e3)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new S(A.FAILED_PRECONDITION,sG);return!1}}return!(!this.networkEnabled||!this.inForeground)||tC(e,tt).H().next(e=>void 0===this.ns(e,5e3).find(e=>{if(this.clientId!==e.clientId){let t=!this.networkEnabled&&e.networkEnabled,r=!this.inForeground&&e.inForeground,n=this.networkEnabled===e.networkEnabled;if(t||r&&n)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&_(sz,`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[eV,tt],e=>{let t=new tS(e,ek.ce);return this.Ji(t).next(()=>this.Yi(t))}),this.qi.close(),this.ls()}ns(e,t){return e.filter(e=>this.ts(e.updateTimeMs,t)&&!this.ss(e.clientId))}hs(){return this.runTransaction("getActiveClients","readonly",e=>tC(e,tt).H().next(e=>this.ns(e,18e5).map(e=>e.clientId)))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return so.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new st(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return iB.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,r){var n;let i;_(sz,"Starting transaction:",e);let s=18===(n=this.xi)||17===n?tA:16===n||15===n?tb:14===n||13===n?tT:12===n?tE:11===n?tI:void E(60245);return this.qi.runTransaction(e,"readonly"===t?"readonly":"readwrite",s,n=>(i=new tS(n,this.ai?this.ai.next():ek.ce),"readwrite-primary"===t?this.ji(i).next(e=>!!e||this.Hi(i)).next(t=>{if(!t)throw v(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)),new S(A.FAILED_PRECONDITION,ed);return r(i)}).next(e=>this.Zi(i).next(()=>e)):this.Ps(i).next(()=>r(i)))).then(e=>(i.raiseOnCommittedEvent(),e))}Ps(e){return tC(e,eV).get(eF).next(e=>{if(null!==e&&this.ts(e.leaseTimestampMs,5e3)&&!this.ss(e.ownerId)&&!this.Xi(e)&&!(this.Mi||this.allowTabSynchronization&&e.allowTabSynchronization))throw new S(A.FAILED_PRECONDITION,sG)})}Zi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return tC(e,eV).put(eF,t)}static v(){return e_.v()}Ji(e){let t=tC(e,eV);return t.get(eF).next(e=>this.Xi(e)?(_(sz,"Releasing primary lease."),t.delete(eF)):em.resolve())}ts(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(v(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ni=()=>{this.Ci.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.$i()))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground="visible"===this.document.visibilityState)}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){"function"==typeof this.window?.addEventListener&&(this.Oi=()=>{this._s();let e=/(?:Version|Mobile)\/1[456]/;c.isSafari()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){try{let t=null!==this.Ui?.getItem(this.rs(e));return _(sz,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(e){return v(sz,"Failed to get zombied client id.",e),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){v("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch(e){}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function sK(e,t){let r=e.projectId;return e.isDefaultDatabase||(r+="."+e.database),"firestore/"+t+"/"+r+"/"}class sW{constructor(e,t,r,n){this.targetId=e,this.fromCache=t,this.Ts=r,this.Is=n}static Es(e,t){let r=na(),n=na();for(let e of t.docChanges)switch(e.type){case 0:r=r.add(e.doc.key);break;case 1:n=n.add(e.doc.key)}return new sW(e,t.fromCache,r,n)}}class sQ{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class sJ{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=c.isSafari()?8:ev(c.getUA())>0?6:4}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,n){let i={result:null};return this.gs(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.ps(e,t,n,r).next(e=>{i.result=e})}).next(()=>{if(i.result)return;let r=new sQ;return this.ys(e,t,r).next(n=>{if(i.result=n,this.As)return this.ws(e,t,r,n.size)})}).next(()=>i.result)}ws(e,t,r,n){return r.documentReadCount<this.Vs?(y()<=d.LogLevel.DEBUG&&_("QueryEngine","SDK will not create cache indexes for query:",r3(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),em.resolve()):(y()<=d.LogLevel.DEBUG&&_("QueryEngine","Query:",r3(t),"scans",r.documentReadCount,"local documents and returns",n,"documents as results."),r.documentReadCount>this.ds*n?(y()<=d.LogLevel.DEBUG&&_("QueryEngine","The SDK decides to create cache indexes for query:",r3(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,rX(t))):em.resolve())}gs(e,t){if(rW(t))return em.resolve(null);let r=rX(t);return this.indexManager.getIndexType(e,r).next(n=>0===n?null:(null!==t.limit&&1===n&&(r=rX(t=r1(t,null,"F"))),this.indexManager.getDocumentsMatchingTarget(e,r).next(n=>{let i=na(...n);return this.fs.getDocuments(e,i).next(n=>this.indexManager.getMinOffset(e,r).next(r=>{let s=this.bs(t,n);return this.Ss(t,s,i,r.readTime)?this.gs(e,r1(t,null,"F")):this.Ds(e,s,t,r)}))})))}ps(e,t,r,n){return rW(t)||n.isEqual(et.min())?em.resolve(null):this.fs.getDocuments(e,r).next(i=>{let s=this.bs(t,i);return this.Ss(t,s,r,n)?em.resolve(null):(y()<=d.LogLevel.DEBUG&&_("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),r3(t)),this.Ds(e,s,t,el(n,-1)).next(e=>e))})}bs(e,t){let r=new tL(r8(e));return t.forEach((t,n)=>{r4(e,n)&&(r=r.add(n))}),r}Ss(e,t,r,n){if(null===e.limit)return!1;if(r.size!==t.size)return!0;let i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(n)>0)}ys(e,t,r){return y()<=d.LogLevel.DEBUG&&_("QueryEngine","Using full collection scan to execute query:",r3(t)),this.fs.getDocumentsMatchingQuery(e,t,ec.min(),r)}Ds(e,t,r,n){return this.fs.getDocumentsMatchingQuery(e,r,n).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}let sY="LocalStore";class sX{constructor(e,t,r,n){this.persistence=e,this.Cs=t,this.serializer=n,this.vs=new tD(L),this.Fs=new r7(e=>rq(e),rB),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new sC(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.vs))}}async function sZ(e,t){return await e.persistence.runTransaction("Handle user change","readonly",r=>{let n;return e.mutationQueue.getAllMutationBatches(r).next(i=>(n=i,e.Os(t),e.mutationQueue.getAllMutationBatches(r))).next(t=>{let i=[],s=[],a=na();for(let e of n)for(let t of(i.push(e.batchId),e.mutations))a=a.add(t.key);for(let e of t)for(let t of(s.push(e.batchId),e.mutations))a=a.add(t.key);return e.localDocuments.getDocuments(r,a).next(e=>({Ns:e,removedBatchIds:i,addedBatchIds:s}))})})}function s0(e){return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.li.getLastRemoteSnapshotVersion(t))}function s1(e,t,r){let n=na(),i=na();return r.forEach(e=>n=n.add(e)),t.getEntries(e,n).next(e=>{let n=r9;return r.forEach((r,s)=>{let a=e.get(r);s.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(r)),s.isNoDocument()&&s.version.isEqual(et.min())?(t.removeEntry(r,s.readTime),n=n.insert(r,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(s),n=n.insert(r,s)):_(sY,"Ignoring outdated watch update for ",r,". Current version:",a.version," Watch version:",s.version)}),{Bs:n,Ls:i}})}function s2(e,t){return e.persistence.runTransaction("Allocate target","readwrite",r=>{let n;return e.li.getTargetData(r,t).next(i=>i?(n=i,em.resolve(n)):e.li.allocateTargetId(r).next(i=>(n=new iC(t,i,"TargetPurposeListen",r.currentSequenceNumber),e.li.addTargetData(r,n).next(()=>n))))}).then(r=>{let n=e.vs.get(r.targetId);return(null===n||r.snapshotVersion.compareTo(n.snapshotVersion)>0)&&(e.vs=e.vs.insert(r.targetId,r),e.Fs.set(t,r.targetId)),r})}async function s6(e,t,r){let n=e.vs.get(t);try{r||await e.persistence.runTransaction("Release target",r?"readwrite":"readwrite-primary",t=>e.persistence.referenceDelegate.removeTarget(t,n))}catch(e){if(!eE(e))throw e;_(sY,`Failed to update sequence numbers for target ${t}: ${e}`)}e.vs=e.vs.remove(t),e.Fs.delete(n.target)}function s3(e,t,r){let n=et.min(),i=na();return e.persistence.runTransaction("Execute query","readwrite",s=>{var a;let o;return(a=rX(t),void 0!==(o=e.Fs.get(a))?em.resolve(e.vs.get(o)):e.li.getTargetData(s,a)).next(t=>{if(t)return n=t.lastLimboFreeSnapshotVersion,e.li.getMatchingKeysForTargetId(s,t.targetId).next(e=>{i=e})}).next(()=>e.Cs.getDocumentsMatchingQuery(s,t,r?n:et.min(),r?i:na())).next(r=>(s8(e,r5(t),r),{documents:r,ks:i}))})}function s4(e,t){let r=e.li,n=e.vs.get(t);return n?Promise.resolve(n.target):e.persistence.runTransaction("Get target data","readonly",e=>r.At(e,t).next(e=>e?e.target:null))}function s5(e,t){let r=e.Ms.get(t)||et.min();return e.persistence.runTransaction("Get new document changes","readonly",n=>e.xs.getAllFromCollectionGroup(n,t,el(r,-1),Number.MAX_SAFE_INTEGER)).then(r=>(s8(e,t,r),r))}function s8(e,t,r){let n=e.Ms.get(t)||et.min();r.forEach((e,t)=>{t.readTime.compareTo(n)>0&&(n=t.readTime)}),e.Ms.set(t,n)}async function s7(e,t,r,n){let i=na(),s=r9;for(let e of r){let r=t.Ks(e.metadata.name);e.document&&(i=i.add(r));let n=t.qs(e);n.setReadTime(t.Us(e.metadata.readTime)),s=s.insert(r,n)}let a=e.xs.newChangeBuffer({trackRemovals:!0}),o=await s2(e,rX(rK(B.fromString(`__bundle__/docs/${n}`))));return e.persistence.runTransaction("Apply bundle documents","readwrite",t=>s1(t,a,s).next(e=>(a.apply(t),e)).next(r=>e.li.removeMatchingKeysForTargetId(t,o.targetId).next(()=>e.li.addMatchingKeys(t,i,o.targetId)).next(()=>e.localDocuments.getLocalViewOfDocuments(t,r.Bs,r.Ls)).next(()=>r.Bs)))}async function s9(e,t,r=na()){let n=await s2(e,rX(iM(t.bundledQuery)));return e.persistence.runTransaction("Save named query","readwrite",i=>{let s=ir(t.readTime);if(n.snapshotVersion.compareTo(s)>=0)return e.Pi.saveNamedQuery(i,t);let a=n.withResumeToken(tq.EMPTY_BYTE_STRING,s);return e.vs=e.vs.insert(a.targetId,a),e.li.updateTargetData(i,a).next(()=>e.li.removeMatchingKeysForTargetId(i,n.targetId)).next(()=>e.li.addMatchingKeys(i,r,n.targetId)).next(()=>e.Pi.saveNamedQuery(i,t))})}let ae="firestore_clients";function at(e,t){return`${ae}_${e}_${t}`}let ar="firestore_mutations";function an(e,t,r){let n=`${ar}_${e}_${r}`;return t.isAuthenticated()&&(n+=`_${t.uid}`),n}let ai="firestore_targets";function as(e,t){return`${ai}_${e}_${t}`}let aa="SharedClientState";class ao{constructor(e,t,r,n){this.user=e,this.batchId=t,this.state=r,this.error=n}static $s(e,t,r){let n=JSON.parse(r),i,s="object"==typeof n&&-1!==["pending","acknowledged","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return s&&n.error&&(s="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new S(n.error.code,n.error.message)),s?new ao(e,t,n.state,i):(v(aa,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class al{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static $s(e,t){let r=JSON.parse(t),n,i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(n=new S(r.error.code,r.error.message)),i?new al(e,r.state,n):(v(aa,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class au{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){let r=JSON.parse(t),n="object"==typeof r&&r.activeTargetIds instanceof Array,i=no;for(let e=0;n&&e<r.activeTargetIds.length;++e)n=ex(r.activeTargetIds[e]),i=i.add(r.activeTargetIds[e]);return n?new au(e,i):(v(aa,`Failed to parse client data for instance '${e}': ${t}`),null)}}class ac{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){let t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new ac(t.clientId,t.onlineState):(v(aa,`Failed to parse online state: ${e}`),null)}}class ah{constructor(){this.activeTargetIds=no}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){return JSON.stringify({activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()})}}class ad{constructor(e,t,r,n,i){var s,a,o;this.window=e,this.Ci=t,this.persistenceKey=r,this.zs=n,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new tD(L),this.started=!1,this.Zs=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Xs=at(this.persistenceKey,this.zs),this.Ys=(s=this.persistenceKey,`firestore_sequence_number_${s}`),this.Js=this.Js.insert(this.zs,new ah),this.eo=RegExp(`^${ae}_${l}_([^_]*)$`),this.no=RegExp(`^${ar}_${l}_(\\d+)(?:_(.*))?$`),this.ro=RegExp(`^${ai}_${l}_(\\d+)$`),this.io=(a=this.persistenceKey,`firestore_online_state_${a}`),this.so=(o=this.persistenceKey,`firestore_bundle_loaded_v2_${o}`),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){for(let e of(await this.syncEngine.hs())){if(e===this.zs)continue;let t=this.getItem(at(this.persistenceKey,e));if(t){let r=au.$s(e,t);r&&(this.Js=this.Js.insert(r.clientId,r))}}this.oo();let e=this.storage.getItem(this.io);if(e){let t=this._o(e);t&&this.ao(t)}for(let e of this.Zs)this.Hs(e);this.Zs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach((r,n)=>{n.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,r){this.co(e,t,r),this.lo(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let t=this.storage.getItem(as(this.persistenceKey,e));if(t){let n=al.$s(e,t);n&&(r=n.state)}}return t&&this.ho.Qs(e),this.oo(),r}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(as(this.persistenceKey,e))}updateQueryState(e,t,r){this.Po(e,t,r)}handleUserChange(e,t,r){t.forEach(e=>{this.lo(e)}),this.currentUser=e,r.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return _(aa,"READ",e,t),t}setItem(e,t){_(aa,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){_(aa,"REMOVE",e),this.storage.removeItem(e)}Hs(e){if(e.storageArea===this.storage){if(_(aa,"EVENT",e.key,e.newValue),e.key===this.Xs)return void v("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable(async()=>{if(this.started){if(null!==e.key){if(this.eo.test(e.key)){if(null==e.newValue){let t=this.Eo(e.key);return this.Ro(t,null)}{let t=this.Ao(e.key,e.newValue);if(t)return this.Ro(t.clientId,t)}}else if(this.no.test(e.key)){if(null!==e.newValue){let t=this.Vo(e.key,e.newValue);if(t)return this.mo(t)}}else if(this.ro.test(e.key)){if(null!==e.newValue){let t=this.fo(e.key,e.newValue);if(t)return this.po(t)}}else if(e.key===this.io){if(null!==e.newValue){let t=this._o(e.newValue);if(t)return this.ao(t)}}else if(e.key===this.Ys){let t=function(e){let t=ek.ce;if(null!=e)try{let r=JSON.parse(e);b("number"==typeof r,30636,{yo:e}),t=r}catch(e){v(aa,"Failed to read sequence number from WebStorage",e)}return t}(e.newValue);t!==ek.ce&&this.sequenceNumberHandler(t)}else if(e.key===this.so){let t=this.wo(e.newValue);await Promise.all(t.map(e=>this.syncEngine.bo(e)))}}}else this.Zs.push(e)})}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,r){let n=new ao(this.currentUser,e,t,r),i=an(this.persistenceKey,this.currentUser,e);this.setItem(i,n.Ws())}lo(e){let t=an(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){let t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,r){let n=as(this.persistenceKey,e),i=new al(e,t,r);this.setItem(n,i.Ws())}Io(e){let t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){let t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){let r=this.Eo(e);return au.$s(r,t)}Vo(e,t){let r=this.no.exec(e),n=Number(r[1]),i=void 0!==r[2]?r[2]:null;return ao.$s(new p(i),n,t)}fo(e,t){let r=Number(this.ro.exec(e)[1]);return al.$s(r,t)}_o(e){return ac.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);_(aa,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){let r=t?this.Js.insert(e,t):this.Js.remove(e),n=this.uo(this.Js),i=this.uo(r),s=[],a=[];return i.forEach(e=>{n.has(e)||s.push(e)}),n.forEach(e=>{i.has(e)||a.push(e)}),this.syncEngine.Co(s,a).then(()=>{this.Js=r})}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=no;return e.forEach((e,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}class af{constructor(){this.vo=new ah,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,r){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new ah,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class ap{Mo(e){}shutdown(){}}let am="ConnectivityMonitor";class ag{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){for(let e of(_(am,"Network connectivity changed: AVAILABLE"),this.Lo))e(0)}Bo(){for(let e of(_(am,"Network connectivity changed: UNAVAILABLE"),this.Lo))e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let ay=null;function a_(){return null===ay?ay=0x10000000+Math.round(0x80000000*Math.random()):ay++,"0x"+ay.toString(16)}let av="RestConnection",aw={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class aI{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),n=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${r}/databases/${n}`,this.$o=this.databaseId.database===tZ?`project_id=${r}`:`project_id=${r}&database_id=${n}`}Wo(e,t,r,n,i){let s=a_(),a=this.Qo(e,t.toUriEncodedString());_(av,`Sending RPC '${e}' ${s}:`,a,r);let o={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(o,n,i);let{host:l}=new URL(a),u=c.isCloudWorkstation(l);return this.zo(e,a,o,r,u).then(t=>(_(av,`Received RPC '${e}' ${s}: `,t),t),t=>{throw w(av,`RPC '${e}' ${s} failed with error: `,t,"url: ",a,"request:",r),t})}jo(e,t,r,n,i,s){return this.Wo(e,t,r,n,i)}Go(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+m,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,r)=>e[r]=t),r&&r.headers.forEach((t,r)=>e[r]=t)}Qo(e,t){let r=aw[e],n=`${this.qo}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(n=`${n}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),n}terminate(){}}class aE{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}let aT="WebChannelConnection",ab=(e,t,r)=>{e.listen(t,e=>{try{r(e)}catch(e){setTimeout(()=>{throw e},0)}})};class aA extends aI{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){aA.c_||(ab(f.getStatEventTarget(),f.Event.STAT_EVENT,e=>{e.stat===f.Stat.PROXY?_(aT,"STAT_EVENT: detected buffering proxy"):e.stat===f.Stat.NOPROXY&&_(aT,"STAT_EVENT: detected no buffering proxy")}),aA.c_=!0)}zo(e,t,r,n,i){let s=a_();return new Promise((i,a)=>{let o=new f.XhrIo;o.setWithCredentials(!0),o.listenOnce(f.EventType.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case f.ErrorCode.NO_ERROR:let t=o.getResponseJson();_(aT,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),i(t);break;case f.ErrorCode.TIMEOUT:_(aT,`RPC '${e}' ${s} timed out`),a(new S(A.DEADLINE_EXCEEDED,"Request time out"));break;case f.ErrorCode.HTTP_ERROR:let r=o.getStatus();if(_(aT,`RPC '${e}' ${s} failed with status:`,r,"response text:",o.getResponseText()),r>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);let t=e?.error;if(t&&t.status&&t.message){let e,r=(e=t.status.toLowerCase().replace(/_/g,"-"),Object.values(A).indexOf(e)>=0?e:A.UNKNOWN);a(new S(r,t.message))}else a(new S(A.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new S(A.UNAVAILABLE,"Connection failed."));break;default:E(9055,{l_:e,streamId:s,h_:o.getLastErrorCode(),P_:o.getLastError()})}}finally{_(aT,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(n);_(aT,`RPC '${e}' ${s} sending request:`,n),o.send(t,"POST",l,r,15)})}T_(e,t,r){let i=a_(),s=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=this.createWebChannelTransport(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Go(o.initMessageHeaders,t,r),o.encodeInitMessageHeaders=!0;let u=s.join("");_(aT,`Creating RPC '${e}' stream ${i}: ${u}`,o);let c=a.createWebChannel(u,o);this.I_(c);let h=!1,d=!1,p=new aE({Ho:t=>{d?_(aT,`Not sending because RPC '${e}' stream ${i} is closed:`,t):(h||(_(aT,`Opening RPC '${e}' stream ${i} transport.`),c.open(),h=!0),_(aT,`RPC '${e}' stream ${i} sending:`,t),c.send(t))},Jo:()=>c.close()});return ab(c,f.WebChannel.EventType.OPEN,()=>{d||(_(aT,`RPC '${e}' stream ${i} transport opened.`),p.i_())}),ab(c,f.WebChannel.EventType.CLOSE,()=>{d||(d=!0,_(aT,`RPC '${e}' stream ${i} transport closed`),p.o_(),this.E_(c))}),ab(c,f.WebChannel.EventType.ERROR,t=>{d||(d=!0,w(aT,`RPC '${e}' stream ${i} transport errored. Name:`,t.name,"Message:",t.message),p.o_(new S(A.UNAVAILABLE,"The operation could not be completed")))}),ab(c,f.WebChannel.EventType.MESSAGE,t=>{if(!d){let r=t.data[0];b(!!r,16349);let s=r?.error||r[0]?.error;if(s){_(aT,`RPC '${e}' stream ${i} received error:`,s);let t=s.status,r=function(e){let t=n[e];if(void 0!==t)return nj(t)}(t),a=s.message;void 0===r&&(r=A.INTERNAL,a="Unknown error status: "+t+" with message "+s.message),d=!0,p.o_(new S(r,a)),c.close()}else _(aT,`RPC '${e}' stream ${i} received:`,r),p.__(r)}}),aA.u_(),setTimeout(()=>{p.s_()},0),p}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(t=>t===e)}Go(e,t,r){super.Go(e,t,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return f.createWebChannelTransport()}}function aS(){return"undefined"!=typeof window?window:null}function aC(){return"undefined"!=typeof document?document:null}function aR(e){return new n7(e,!0)}aA.c_=!1;class aP{constructor(e,t,r=1e3,n=1.5,i=6e4){this.Ci=e,this.timerId=t,this.R_=r,this.A_=n,this.V_=i,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();let t=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),n=Math.max(0,t-r);n>0&&_("ExponentialBackoff",`Backing off for ${n} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,n,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}let ak="PersistentStream";class aN{constructor(e,t,r,n,i,s,a,o){this.Ci=e,this.b_=r,this.S_=n,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new aP(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===A.RESOURCE_EXHAUSTED?(v(t.toString()),v("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===A.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;let e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,r])=>{this.D_===t&&this.G_(e,r)},t=>{e(()=>{let e=new S(A.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){let r=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(e=>{r(()=>this.z_(e))}),this.stream.onMessage(e=>{r(()=>1==++this.F_?this.H_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return _(ak,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget(()=>this.D_===e?t():(_(ak,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class aD extends aN{constructor(e,t,r,n,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,n,s),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=function(e,t){let r;if("targetChange"in t){var n,i;t.targetChange;let s="NO_CHANGE"===(n=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===n?1:"REMOVE"===n?2:"CURRENT"===n?3:"RESET"===n?4:E(39313,{state:n}),a=t.targetChange.targetIds||[],o=(i=t.targetChange.resumeToken,e.useProto3Json?(b(void 0===i||"string"==typeof i,58123),tq.fromBase64String(i||"")):(b(void 0===i||i instanceof l.Buffer||i instanceof Uint8Array,16193),tq.fromUint8Array(i||new Uint8Array))),u=t.targetChange.cause;r=new n0(s,a,o,u&&new S(void 0===u.code?A.UNKNOWN:nj(u.code),u.message||"")||null)}else if("documentChange"in t){t.documentChange;let n=t.documentChange;n.document,n.document.name,n.document.updateTime;let i=il(e,n.document.name),s=ir(n.document.updateTime),a=n.document.createTime?ir(n.document.createTime):et.min(),o=new rg({mapValue:{fields:n.document.fields}}),l=ry.newFoundDocument(i,s,a,o);r=new nX(n.targetIds||[],n.removedTargetIds||[],l.key,l)}else if("documentDelete"in t){t.documentDelete;let n=t.documentDelete;n.document;let i=il(e,n.document),s=n.readTime?ir(n.readTime):et.min(),a=ry.newNoDocument(i,s);r=new nX([],n.removedTargetIds||[],a.key,a)}else if("documentRemove"in t){t.documentRemove;let n=t.documentRemove;n.document;let i=il(e,n.document);r=new nX([],n.removedTargetIds||[],i,null)}else{if(!("filter"in t))return E(11601,{Vt:t});{t.filter;let e=t.filter;e.targetId;let{count:n=0,unchangedNames:i}=e,s=new nq(n,i);r=new nZ(e.targetId,s)}}return r}(this.serializer,e),r=function(e){if(!("targetChange"in e))return et.min();let t=e.targetChange;return t.targetIds&&t.targetIds.length?et.min():t.readTime?ir(t.readTime):et.min()}(e);return this.listener.J_(t,r)}Z_(e){let t,r={};r.database=ih(this.serializer),r.addTarget=function(e,t){let r,n=t.target;if((r=rj(n)?{documents:iv(e,n)}:{query:iw(e,n).ft}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0){r.resumeToken=it(e,t.resumeToken);let n=n9(e,t.expectedCount);null!==n&&(r.expectedCount=n)}else if(t.snapshotVersion.compareTo(et.min())>0){r.readTime=ie(e,t.snapshotVersion.toTimestamp());let n=n9(e,t.expectedCount);null!==n&&(r.expectedCount=n)}return r}(this.serializer,e);let n=(this.serializer,null==(t=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return E(28987,{purpose:e})}}(e.purpose))?null:{"goog-listen-tags":t});n&&(r.labels=n),this.K_(r)}X_(e){let t={};t.database=ih(this.serializer),t.removeTarget=e,this.K_(t)}}class ax extends aN{constructor(e,t,r,n,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,n,s),this.serializer=i}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return b(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,b(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){var t,r;b(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let n=(t=e.writeResults,r=e.commitTime,t&&t.length>0?(b(void 0!==r,14353),t.map(e=>{let t;return(t=e.updateTime?ir(e.updateTime):ir(r)).isEqual(et.min())&&(t=ir(r)),new nE(t,e.transformResults||[])})):[]),i=ir(e.commitTime);return this.listener.na(i,n)}ra(){let e={};e.database=ih(this.serializer),this.K_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(e=>iy(this.serializer,e))};this.K_(t)}}class aO{}class aL extends aO{constructor(e,t,r,n){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=n,this.ia=!1}sa(){if(this.ia)throw new S(A.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,n){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Wo(e,is(t,r),n,i,s)).catch(e=>{throw"FirebaseError"===e.name?(e.code===A.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new S(A.UNKNOWN,e.toString())})}jo(e,t,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.jo(e,is(t,r),n,s,a,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===A.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new S(A.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class aM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(v(t),this.aa=!1):_("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}let aV="RemoteStore";class aF{constructor(e,t,r,n,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=i,this.Aa.Mo(e=>{r.enqueueAndForget(async()=>{aK(this)&&(_(aV,"Restarting streams for network reachability change."),await async function(e){e.Ea.add(4),await aq(e),e.Va.set("Unknown"),e.Ea.delete(4),await aU(e)}(this))})}),this.Va=new aM(r,n)}}async function aU(e){if(aK(e))for(let t of e.Ra)await t(!0)}async function aq(e){for(let t of e.Ra)await t(!1)}function aB(e,t){e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),aH(e)?a$(e):a9(e).O_()&&az(e,t))}function aj(e,t){let r=a9(e);e.Ia.delete(t),r.O_()&&aG(e,t),0===e.Ia.size&&(r.O_()?r.L_():aK(e)&&e.Va.set("Unknown"))}function az(e,t){if(e.da.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(et.min())>0){let r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}a9(e).Z_(t)}function aG(e,t){e.da.$e(t),a9(e).X_(t)}function a$(e){e.da=new n2({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),a9(e).start(),e.Va.ua()}function aH(e){return aK(e)&&!a9(e).x_()&&e.Ia.size>0}function aK(e){return 0===e.Ea.size}async function aW(e){e.Va.set("Online")}async function aQ(e){e.Ia.forEach((t,r)=>{az(e,t)})}async function aJ(e,t){e.da=void 0,aH(e)?(e.Va.ha(t),a$(e)):e.Va.set("Unknown")}async function aY(e,t,r){if(e.Va.set("Online"),t instanceof n0&&2===t.state&&t.cause)try{await async function(e,t){let r=t.cause;for(let n of t.targetIds)e.Ia.has(n)&&(await e.remoteSyncer.rejectListen(n,r),e.Ia.delete(n),e.da.removeTarget(n))}(e,t)}catch(r){_(aV,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await aX(e,r)}else if(t instanceof nX?e.da.Xe(t):t instanceof nZ?e.da.st(t):e.da.tt(t),!r.isEqual(et.min()))try{let t,n=await s0(e.localStore);r.compareTo(n)>=0&&await ((t=e.da.Tt(r)).targetChanges.forEach((t,n)=>{if(t.resumeToken.approximateByteSize()>0){let i=e.Ia.get(n);i&&e.Ia.set(n,i.withResumeToken(t.resumeToken,r))}}),t.targetMismatches.forEach((t,r)=>{let n=e.Ia.get(t);if(!n)return;e.Ia.set(t,n.withResumeToken(tq.EMPTY_BYTE_STRING,n.snapshotVersion)),aG(e,t);let i=new iC(n.target,t,r,n.sequenceNumber);az(e,i)}),e.remoteSyncer.applyRemoteEvent(t))}catch(t){_(aV,"Failed to raise snapshot:",t),await aX(e,t)}}async function aX(e,t,r){if(!eE(t))throw t;e.Ea.add(1),await aq(e),e.Va.set("Offline"),r||(r=()=>s0(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{_(aV,"Retrying IndexedDB access"),await r(),e.Ea.delete(1),await aU(e)})}function aZ(e,t){return t().catch(r=>aX(e,r,t))}async function a0(e){var t;let r=oe(e),n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:-1;for(;aK(t=e)&&t.Ta.length<10;)try{let t=await function(e,t){return e.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}(e.localStore,n);if(null===t){0===e.Ta.length&&r.L_();break}n=t.batchId,function(e,t){e.Ta.push(t);let r=oe(e);r.O_()&&r.Y_&&r.ea(t.mutations)}(e,t)}catch(t){await aX(e,t)}a1(e)&&a2(e)}function a1(e){return aK(e)&&!oe(e).x_()&&e.Ta.length>0}function a2(e){oe(e).start()}async function a6(e){oe(e).ra()}async function a3(e){let t=oe(e);for(let r of e.Ta)t.ea(r.mutations)}async function a4(e,t,r){let n=e.Ta.shift(),i=nV.from(n,t,r);await aZ(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await a0(e)}async function a5(e,t){t&&oe(e).Y_&&await async function(e,t){var r;if(nB(r=t.code)&&r!==A.ABORTED){let r=e.Ta.shift();oe(e).B_(),await aZ(e,()=>e.remoteSyncer.rejectFailedWrite(r.batchId,t)),await a0(e)}}(e,t),a1(e)&&a2(e)}async function a8(e,t){e.asyncQueue.verifyOperationInProgress(),_(aV,"RemoteStore received new credentials");let r=aK(e);e.Ea.add(3),await aq(e),r&&e.Va.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await aU(e)}async function a7(e,t){t?(e.Ea.delete(2),await aU(e)):t||(e.Ea.add(2),await aq(e),e.Va.set("Unknown"))}function a9(e){var t,r,n;return e.ma||(t=e.datastore,r=e.asyncQueue,n={Zo:aW.bind(null,e),Yo:aQ.bind(null,e),t_:aJ.bind(null,e),J_:aY.bind(null,e)},t.sa(),e.ma=new aD(r,t.connection,t.authCredentials,t.appCheckCredentials,t.serializer,n),e.Ra.push(async t=>{t?(e.ma.B_(),aH(e)?a$(e):e.Va.set("Unknown")):(await e.ma.stop(),e.da=void 0)})),e.ma}function oe(e){var t,r,n;return e.fa||(t=e.datastore,r=e.asyncQueue,n={Zo:()=>Promise.resolve(),Yo:a6.bind(null,e),t_:a5.bind(null,e),ta:a3.bind(null,e),na:a4.bind(null,e)},t.sa(),e.fa=new ax(r,t.connection,t.authCredentials,t.appCheckCredentials,t.serializer,n),e.Ra.push(async t=>{t?(e.fa.B_(),await a0(e)):(await e.fa.stop(),e.Ta.length>0&&(_(aV,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))})),e.fa}class ot{constructor(e,t,r,n,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=n,this.removalCallback=i,this.deferred=new C,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,n,i){let s=new ot(e,t,Date.now()+r,n,i);return s.start(r),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new S(A.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function or(e,t){if(v("AsyncQueue",`${t}: ${e}`),eE(e))return new S(A.UNAVAILABLE,`${t}: ${e}`);throw e}class on{static emptySet(e){return new on(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||G.comparator(t.key,r.key):(e,t)=>G.comparator(e.key,t.key),this.keyedMap=nt(),this.sortedSet=new tD(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof on)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let e=t.getNext().key,n=r.getNext().key;if(!e.isEqual(n))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){let r=new on;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class oi{constructor(){this.ga=new tD(G.comparator)}track(e){let t=e.doc.key,r=this.ga.get(t);r?0!==e.type&&3===r.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==r.type?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.ga=this.ga.remove(t):1===e.type&&2===r.type?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):E(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}}class os{constructor(e,t,r,n,i,s,a,o,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=n,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,n,i){let s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new os(e,t,on.emptySet(t),s,r,n,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&r2(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==r[e].type||!t[e].doc.isEqual(r[e].doc))return!1;return!0}}class oa{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}}class oo{constructor(){this.queries=ol(),this.onlineState="Unknown",this.Ca=new Set}terminate(){var e;let t;e=new S(A.ABORTED,"Firestore shutting down"),t=this.queries,this.queries=ol(),t.forEach((t,r)=>{for(let t of r.ba)t.onError(e)})}}function ol(){return new r7(e=>r6(e),r2)}async function ou(e,t){let r=3,n=t.query,i=e.queries.get(n);i?!i.Sa()&&t.Da()&&(r=2):(i=new oa,r=+!t.Da());try{switch(r){case 0:i.wa=await e.onListen(n,!0);break;case 1:i.wa=await e.onListen(n,!1);break;case 2:await e.onFirstRemoteStoreListen(n)}}catch(r){let e=or(r,`Initialization of query '${r3(t.query)}' failed`);return void t.onError(e)}e.queries.set(n,i),i.ba.push(t),t.va(e.onlineState),i.wa&&t.Fa(i.wa)&&of(e)}async function oc(e,t){let r=t.query,n=3,i=e.queries.get(r);if(i){let e=i.ba.indexOf(t);e>=0&&(i.ba.splice(e,1),0===i.ba.length?n=+!t.Da():!i.Sa()&&t.Da()&&(n=2))}switch(n){case 0:return e.queries.delete(r),e.onUnlisten(r,!0);case 1:return e.queries.delete(r),e.onUnlisten(r,!1);case 2:return e.onLastRemoteStoreUnlisten(r);default:return}}function oh(e,t){let r=!1;for(let n of t){let t=n.query,i=e.queries.get(t);if(i){for(let e of i.ba)e.Fa(n)&&(r=!0);i.wa=n}}r&&of(e)}function od(e,t,r){let n=e.queries.get(t);if(n)for(let e of n.ba)e.onError(r);e.queries.delete(t)}function of(e){e.Ca.forEach(e=>{e.next()})}(a=s||(s={})).Ma="default",a.Cache="cache";class op{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){let t=[];for(let r of e.docChanges)3!==r.type&&t.push(r);e=new os(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){return!(e.fromCache&&this.Da())||(!this.options.Ka||"Offline"===t)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=os.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==s.Cache}}class om{constructor(e,t){this.qa=e,this.byteLength=t}Ua(){return"metadata"in this.qa}}class og{constructor(e){this.serializer=e}Ks(e){return il(this.serializer,e)}qs(e){return e.metadata.exists?ig(this.serializer,e.document,!1):ry.newNoDocument(this.Ks(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return ir(e)}}class oy{constructor(e,t){this.$a=e,this.serializer=t,this.Wa=[],this.Qa=[],this.collectionGroups=new Set,this.progress=o_(e)}get queries(){return this.Wa}get documents(){return this.Qa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Wa.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Qa.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;let r=B.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.qa.document&&(this.Qa[this.Qa.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){let t=new Map,r=new og(this.serializer);for(let n of e)if(n.metadata.queries){let e=r.Ks(n.metadata.name);for(let r of n.metadata.queries){let n=(t.get(r)||na()).add(e);t.set(r,n)}}return t}async ja(e){let t=await s7(e,new og(this.serializer),this.Qa,this.$a.id),r=this.za(this.documents);for(let t of this.Wa)await s9(e,t,r.get(t.name));return this.progress.taskState="Success",{progress:this.progress,Ha:this.collectionGroups,Ja:t}}}function o_(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class ov{constructor(e){this.key=e}}class ow{constructor(e){this.key=e}}class oI{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=na(),this.mutatedKeys=na(),this.eu=r8(e),this.tu=new on(this.eu)}get nu(){return this.Za}ru(e,t){let r=t?t.iu:new oi,n=t?t.tu:this.tu,i=t?t.mutatedKeys:this.mutatedKeys,s=n,a=!1,o="F"===this.query.limitType&&n.size===this.query.limit?n.last():null,l="L"===this.query.limitType&&n.size===this.query.limit?n.first():null;if(e.inorderTraversal((e,t)=>{let u=n.get(e),c=r4(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!c&&(c.hasLocalMutations||this.mutatedKeys.has(c.key)&&c.hasCommittedMutations),f=!1;u&&c?u.data.isEqual(c.data)?h!==d&&(r.track({type:3,doc:c}),f=!0):this.su(u,c)||(r.track({type:2,doc:c}),f=!0,(o&&this.eu(c,o)>0||l&&0>this.eu(c,l))&&(a=!0)):!u&&c?(r.track({type:0,doc:c}),f=!0):u&&!c&&(r.track({type:1,doc:u}),f=!0,(o||l)&&(a=!0)),f&&(c?(s=s.add(c),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){let e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),r.track({type:1,doc:e})}return{tu:s,iu:r,Ss:a,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,n){let i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let s=e.iu.ya();s.sort((e,t)=>{var r,n;let i;return r=e.type,n=t.type,(i=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return E(20277,{Vt:e})}})(r)-i(n)||this.eu(e.doc,t.doc)}),this.ou(r),n=n??!1;let a=t&&!n?this._u():[],o=0===this.Ya.size&&this.current&&!n?1:0,l=o!==this.Xa;return(this.Xa=o,0!==s.length||l)?{snapshot:new os(this.query,e.tu,i,s,e.mutatedKeys,0===o,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new oi,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Za=this.Za.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Za=this.Za.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Ya;this.Ya=na(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Ya=this.Ya.add(e.key))});let t=[];return e.forEach(e=>{this.Ya.has(e)||t.push(new ow(e))}),this.Ya.forEach(r=>{e.has(r)||t.push(new ov(r))}),t}cu(e){this.Za=e.ks,this.Ya=na();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return os.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Xa,this.hasCachedResults)}}let oE="SyncEngine";class oT{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class ob{constructor(e){this.key=e,this.hu=!1}}class oA{constructor(e,t,r,n,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=n,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new r7(e=>r6(e),r2),this.Iu=new Map,this.Eu=new Set,this.Ru=new tD(G.comparator),this.Au=new Map,this.Vu=new sN,this.du={},this.mu=new Map,this.fu=sc.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function oS(e,t,r=!0){let n,i=o6(e),s=i.Tu.get(t);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),n=s.view.lu()):n=await oR(i,t,r,!0),n}async function oC(e,t){let r=o6(e);await oR(r,t,!0,!1)}async function oR(e,t,r,n){let i,s=await s2(e.localStore,rX(t)),a=s.targetId,o=e.sharedClientState.addLocalQueryTarget(a,r);return n&&(i=await oP(e,t,a,"current"===o,s.resumeToken)),e.isPrimaryClient&&r&&aB(e.remoteStore,s),i}async function oP(e,t,r,n,i){e.pu=(t,r,n)=>(async function(e,t,r,n){let i=t.view.ru(r);i.Ss&&(i=await s3(e.localStore,t.query,!1).then(({documents:e})=>t.view.ru(e,i)));let s=n&&n.targetChanges.get(t.targetId),a=n&&null!=n.targetMismatches.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s,a);return oz(e,t.targetId,o.au),o.snapshot})(e,t,r,n);let s=await s3(e.localStore,t,!0),a=new oI(t,s.ks),o=a.ru(s.documents),l=nY.createSynthesizedTargetChangeForCurrentChange(r,n&&"Offline"!==e.onlineState,i),u=a.applyChanges(o,e.isPrimaryClient,l);oz(e,r,u.au);let c=new oT(t,r,a);return e.Tu.set(t,c),e.Iu.has(r)?e.Iu.get(r).push(t):e.Iu.set(r,[t]),u.snapshot}async function ok(e,t,r){let n=e.Tu.get(t),i=e.Iu.get(n.targetId);i.length>1?(e.Iu.set(n.targetId,i.filter(e=>!r2(e,t))),e.Tu.delete(t)):e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(n.targetId),e.sharedClientState.isActiveQueryTarget(n.targetId)||await s6(e.localStore,n.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(n.targetId),r&&aj(e.remoteStore,n.targetId),oB(e,n.targetId)}).catch(ep)):(oB(e,n.targetId),await s6(e.localStore,n.targetId,!0))}async function oN(e,t){let r=e.Tu.get(t),n=e.Iu.get(r.targetId);e.isPrimaryClient&&1===n.length&&(e.sharedClientState.removeLocalQueryTarget(r.targetId),aj(e.remoteStore,r.targetId))}async function oD(e,t,r){let n=o3(e);try{var i,s;let e,a,o,l,u,c=await (i=n.localStore,o=ee.now(),l=t.reduce((e,t)=>e.add(t.key),na()),i.persistence.runTransaction("Locally write mutations","readwrite",r=>{let n=r9,s=na();return i.xs.getEntries(r,l).next(e=>{(n=e).forEach((e,t)=>{t.isValidDocument()||(s=s.add(e))})}).next(()=>i.localDocuments.getOverlayedDocuments(r,n)).next(n=>{e=n;let s=[];for(let r of t){let t=function(e,t){let r=null;for(let n of e.fieldTransforms){let e=t.data.field(n.field),i=nd(n.transform,e||null);null!=i&&(null===r&&(r=rg.empty()),r.set(n.field,i))}return r||null}(r,e.get(r.key).overlayedDocument);null!=t&&s.push(new nk(r.key,t,function e(t){let r=[];return tP(t.fields,(t,n)=>{let i=new z([t]);if(ru(n)){let t=e(n.mapValue).fields;if(0===t.length)r.push(i);else for(let e of t)r.push(i.child(e))}else r.push(i)}),new tF(r)}(t.value.mapValue),nT.exists(!0)))}return i.mutationQueue.addMutationBatch(r,o,s,t)}).next(t=>{a=t;let n=t.applyToLocalDocumentSet(e,s);return i.documentOverlayCache.saveOverlays(r,t.batchId,n)})}).then(()=>({batchId:a.batchId,changes:nr(e)})));n.sharedClientState.addPendingMutation(c.batchId),s=c.batchId,(u=n.du[n.currentUser.toKey()])||(u=new tD(L)),u=u.insert(s,r),n.du[n.currentUser.toKey()]=u,await o$(n,c.changes),await a0(n.remoteStore)}catch(t){let e=or(t,"Failed to persist write");r.reject(e)}}async function ox(e,t){var r;try{let n,i,s=await (r=e.localStore,n=t.snapshotVersion,i=r.vs,r.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{let s=r.xs.newChangeBuffer({trackRemovals:!0});i=r.vs;let a=[];t.targetChanges.forEach((s,o)=>{var l;let u=i.get(o);if(!u)return;a.push(r.li.removeMatchingKeys(e,s.removedDocuments,o).next(()=>r.li.addMatchingKeys(e,s.addedDocuments,o)));let c=u.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(tq.EMPTY_BYTE_STRING,et.min()).withLastLimboFreeSnapshotVersion(et.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,n)),i=i.insert(o,c),l=c,(0===u.resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-u.snapshotVersion.toMicroseconds()>=3e8||s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size>0)&&a.push(r.li.updateTargetData(e,c))});let o=r9,l=na();if(t.documentUpdates.forEach(n=>{t.resolvedLimboDocuments.has(n)&&a.push(r.persistence.referenceDelegate.updateLimboDocument(e,n))}),a.push(s1(e,s,t.documentUpdates).next(e=>{o=e.Bs,l=e.Ls})),!n.isEqual(et.min())){let t=r.li.getLastRemoteSnapshotVersion(e).next(t=>r.li.setTargetsMetadata(e,e.currentSequenceNumber,n));a.push(t)}return em.waitFor(a).next(()=>s.apply(e)).next(()=>r.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(r.vs=i,e)));t.targetChanges.forEach((t,r)=>{let n=e.Au.get(r);n&&(b(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1,22616),t.addedDocuments.size>0?n.hu=!0:t.modifiedDocuments.size>0?b(n.hu,14607):t.removedDocuments.size>0&&(b(n.hu,42227),n.hu=!1))}),await o$(e,s,t)}catch(e){await ep(e)}}function oO(e,t,r){var n;if(e.isPrimaryClient&&0===r||!e.isPrimaryClient&&1===r){let r,i=[];e.Tu.forEach((e,r)=>{let n=r.view.va(t);n.snapshot&&i.push(n.snapshot)}),(n=e.eventManager).onlineState=t,r=!1,n.queries.forEach((e,n)=>{for(let e of n.ba)e.va(t)&&(r=!0)}),r&&of(n),i.length&&e.Pu.J_(i),e.onlineState=t,e.isPrimaryClient&&e.sharedClientState.setOnlineState(t)}}async function oL(e,t,r){e.sharedClientState.updateQueryState(t,"rejected",r);let n=e.Au.get(t),i=n&&n.key;if(i){let r=new tD(G.comparator);r=r.insert(i,ry.newNoDocument(i,et.min()));let n=na().add(i),s=new nJ(et.min(),new Map,new tD(L),r,n);await ox(e,s),e.Ru=e.Ru.remove(i),e.Au.delete(t),oG(e)}else await s6(e.localStore,t,!1).then(()=>oB(e,t,r)).catch(ep)}async function oM(e,t){var r;let n=t.batch.batchId;try{let i=await (r=e.localStore,r.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{let n,i,s,a=t.batch.keys(),o=r.xs.newChangeBuffer({trackRemovals:!0});return(i=(n=t.batch).keys(),s=em.resolve(),i.forEach(r=>{s=s.next(()=>o.getEntry(e,r)).next(e=>{let i=t.docVersions.get(r);b(null!==i,48541),0>e.version.compareTo(i)&&(n.applyToRemoteDocument(e,t),e.isValidDocument()&&(e.setReadTime(t.commitVersion),o.addEntry(e)))})}),s.next(()=>r.mutationQueue.removeMutationBatch(e,n))).next(()=>o.apply(e)).next(()=>r.mutationQueue.performConsistencyCheck(e)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(e,a,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=na();for(let r=0;r<e.mutationResults.length;++r)e.mutationResults[r].transformResults.length>0&&(t=t.add(e.batch.mutations[r].key));return t}(t))).next(()=>r.localDocuments.getDocuments(e,a))}));oq(e,n,null),oU(e,n),e.sharedClientState.updateMutationState(n,"acknowledged"),await o$(e,i)}catch(e){await ep(e)}}async function oV(e,t,r){var n;try{let i=await (n=e.localStore,n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(b(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))}));oq(e,t,r),oU(e,t),e.sharedClientState.updateMutationState(t,"rejected",r),await o$(e,i)}catch(e){await ep(e)}}async function oF(e,t){var r;aK(e.remoteStore)||_(oE,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let n=await (r=e.localStore).persistence.runTransaction("Get highest unacknowledged batch id","readonly",e=>r.mutationQueue.getHighestUnacknowledgedBatchId(e));if(-1===n)return void t.resolve();let i=e.mu.get(n)||[];i.push(t),e.mu.set(n,i)}catch(r){let e=or(r,"Initialization of waitForPendingWrites() operation failed");t.reject(e)}}function oU(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function oq(e,t,r){let n=e.du[e.currentUser.toKey()];if(n){let i=n.get(t);i&&(r?i.reject(r):i.resolve(),n=n.remove(t)),e.du[e.currentUser.toKey()]=n}}function oB(e,t,r=null){for(let n of(e.sharedClientState.removeLocalQueryTarget(t),e.Iu.get(t)))e.Tu.delete(n),r&&e.Pu.yu(n,r);e.Iu.delete(t),e.isPrimaryClient&&e.Vu.Gr(t).forEach(t=>{e.Vu.containsKey(t)||oj(e,t)})}function oj(e,t){e.Eu.delete(t.path.canonicalString());let r=e.Ru.get(t);null!==r&&(aj(e.remoteStore,r),e.Ru=e.Ru.remove(t),e.Au.delete(r),oG(e))}function oz(e,t,r){for(let n of r)n instanceof ov?(e.Vu.addReference(n.key,t),function(e,t){let r=t.key,n=r.path.canonicalString();e.Ru.get(r)||e.Eu.has(n)||(_(oE,"New document in limbo: "+r),e.Eu.add(n),oG(e))}(e,n)):n instanceof ow?(_(oE,"Document no longer in limbo: "+n.key),e.Vu.removeReference(n.key,t),e.Vu.containsKey(n.key)||oj(e,n.key)):E(19791,{wu:n})}function oG(e){for(;e.Eu.size>0&&e.Ru.size<e.maxConcurrentLimboResolutions;){let t=e.Eu.values().next().value;e.Eu.delete(t);let r=new G(B.fromString(t)),n=e.fu.next();e.Au.set(n,new ob(r)),e.Ru=e.Ru.insert(r,n),aB(e.remoteStore,new iC(rX(rK(r.path)),n,"TargetPurposeLimboResolution",ek.ce))}}async function o$(e,t,r){let n=[],i=[],s=[];e.Tu.isEmpty()||(e.Tu.forEach((a,o)=>{s.push(e.pu(o,t,r).then(t=>{if((t||r)&&e.isPrimaryClient){let n=t?!t.fromCache:r?.targetChanges.get(o.targetId)?.current;e.sharedClientState.updateQueryState(o.targetId,n?"current":"not-current")}if(t){n.push(t);let e=sW.Es(o.targetId,t);i.push(e)}}))}),await Promise.all(s),e.Pu.J_(n),await async function(e,t){try{await e.persistence.runTransaction("notifyLocalViewChanges","readwrite",r=>em.forEach(t,t=>em.forEach(t.Ts,n=>e.persistence.referenceDelegate.addReference(r,t.targetId,n)).next(()=>em.forEach(t.Is,n=>e.persistence.referenceDelegate.removeReference(r,t.targetId,n)))))}catch(e){if(!eE(e))throw e;_(sY,"Failed to update sequence numbers: "+e)}for(let r of t){let t=r.targetId;if(!r.fromCache){let r=e.vs.get(t),n=r.snapshotVersion,i=r.withLastLimboFreeSnapshotVersion(n);e.vs=e.vs.insert(t,i)}}}(e.localStore,i))}async function oH(e,t){if(!e.currentUser.isEqual(t)){_(oE,"User change. New user:",t.toKey());let r=await sZ(e.localStore,t);e.currentUser=t,e.mu.forEach(e=>{e.forEach(e=>{e.reject(new S(A.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.mu.clear(),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await o$(e,r.Ns)}}function oK(e,t){let r=e.Au.get(t);if(r&&r.hu)return na().add(r.key);{let r=na(),n=e.Iu.get(t);if(!n)return r;for(let t of n){let n=e.Tu.get(t);r=r.unionWith(n.view.nu)}return r}}async function oW(e,t){let r=await s3(e.localStore,t.query,!0),n=t.view.cu(r);return e.isPrimaryClient&&oz(e,t.targetId,n.au),n}async function oQ(e,t){return s5(e.localStore,t).then(t=>o$(e,t))}async function oJ(e,t,r,n){var i,s;let a,o=await (i=e.localStore,a=i.mutationQueue,i.persistence.runTransaction("Lookup mutation documents","readonly",e=>a.Xn(e,t).next(t=>t?i.localDocuments.getDocuments(e,t):em.resolve(null))));null!==o?("pending"===r?await a0(e.remoteStore):"acknowledged"===r||"rejected"===r?(oq(e,t,n||null),oU(e,t),s=e.localStore,s.mutationQueue.nr(t)):E(6720,"Unknown batchState",{bu:r}),await o$(e,o)):_(oE,"Cannot apply mutation batch with id: "+t)}async function oY(e,t){if(o6(e),o3(e),!0===t&&!0!==e.gu){let t=e.sharedClientState.getAllActiveQueryTargets(),r=await oX(e,t.toArray());for(let t of(e.gu=!0,await a7(e.remoteStore,!0),r))aB(e.remoteStore,t)}else if(!1===t&&!1!==e.gu){let t=[],r=Promise.resolve();e.Iu.forEach((n,i)=>{e.sharedClientState.isLocalQueryTarget(i)?t.push(i):r=r.then(()=>(oB(e,i),s6(e.localStore,i,!0))),aj(e.remoteStore,i)}),await r,await oX(e,t),e.Au.forEach((t,r)=>{aj(e.remoteStore,r)}),e.Vu.zr(),e.Au=new Map,e.Ru=new tD(G.comparator),e.gu=!1,await a7(e.remoteStore,!1)}}async function oX(e,t,r){let n=[],i=[];for(let r of t){let t,s=e.Iu.get(r);if(s&&0!==s.length)for(let r of(t=await s2(e.localStore,rX(s[0])),s)){let t=e.Tu.get(r),n=await oW(e,t);n.snapshot&&i.push(n.snapshot)}else{let n=await s4(e.localStore,r);t=await s2(e.localStore,n),await oP(e,oZ(n),r,!1,t.resumeToken)}n.push(t)}return e.Pu.J_(i),n}function oZ(e){var t,r,n,i,s;return t=e.path,r=e.collectionGroup,n=e.orderBy,i=e.filters,s=e.limit,new rH(t,r,n,i,s,"F",e.startAt,e.endAt)}function o0(e){return e.localStore.persistence.hs()}async function o1(e,t,r,n){if(e.gu)return void _(oE,"Ignoring unexpected query state notification.");let i=e.Iu.get(t);if(i&&i.length>0)switch(r){case"current":case"not-current":{let n=await s5(e.localStore,r5(i[0])),s=nJ.createSynthesizedRemoteEventForCurrentChange(t,"current"===r,tq.EMPTY_BYTE_STRING);await o$(e,n,s);break}case"rejected":await s6(e.localStore,t,!0),oB(e,t,n);break;default:E(64155,r)}}async function o2(e,t,r){let n=o6(e);if(n.gu){for(let e of t){if(n.Iu.has(e)&&n.sharedClientState.isActiveQueryTarget(e)){_(oE,"Adding an already active target "+e);continue}let t=await s4(n.localStore,e),r=await s2(n.localStore,t);await oP(n,oZ(t),r.targetId,!1,r.resumeToken),aB(n.remoteStore,r)}for(let e of r)n.Iu.has(e)&&await s6(n.localStore,e,!1).then(()=>{aj(n.remoteStore,e),oB(n,e)}).catch(ep)}}function o6(e){return e.remoteStore.remoteSyncer.applyRemoteEvent=ox.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=oK.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=oL.bind(null,e),e.Pu.J_=oh.bind(null,e.eventManager),e.Pu.yu=od.bind(null,e.eventManager),e}function o3(e){return e.remoteStore.remoteSyncer.applySuccessfulWrite=oM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=oV.bind(null,e),e}class o4{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=aR(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){var t,r;return t=this.persistence,r=new sJ,new sX(t,r,e.initialUser,this.serializer)}Cu(e){return new sV(sU.Vi,this.serializer)}Du(e){return new af}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}o4.provider={build:()=>new o4};class o5 extends o4{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){return b(this.persistence.referenceDelegate instanceof sq,46915),new sg(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Cu(e){let t=void 0!==this.cacheSizeBytes?si.withCacheSize(this.cacheSizeBytes):si.DEFAULT;return new sV(e=>sq.Vi(e,t),this.serializer)}}class o8 extends o4{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await o3(this.xu.syncEngine),await a0(this.xu.remoteStore),await this.persistence.zi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){var t,r;return t=this.persistence,r=new sJ,new sX(t,r,e.initialUser,this.serializer)}Fu(e,t){return new sg(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Mu(e,t){let r=new eP(t,this.persistence);return new eR(e.asyncQueue,r)}Cu(e){let t=sK(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?si.withCacheSize(this.cacheSizeBytes):si.DEFAULT;return new sH(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,aS(),aC(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new af}}class o7 extends o8{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);let t=this.xu.syncEngine;this.sharedClientState instanceof ad&&(this.sharedClientState.syncEngine={So:oJ.bind(null,t),Do:o1.bind(null,t),Co:o2.bind(null,t),hs:o0.bind(null,t),bo:oQ.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi(async e=>{await oY(this.xu.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())})}Du(e){let t=aS();if(!ad.v(t))throw new S(A.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=sK(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ad(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class o9{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>oO(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=oH.bind(null,this.syncEngine),await a7(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new oo}createDatastore(e){var t;let r=aR(e.databaseInfo.databaseId),n=new aA(e.databaseInfo);return t=e.authCredentials,new aL(t,e.appCheckCredentials,n,r)}createRemoteStore(e){var t,r;return t=this.localStore,r=this.datastore,new aF(t,r,e.asyncQueue,e=>oO(this.syncEngine,e,0),ag.v()?new ag:new ap)}createSyncEngine(e,t){var r,n,i,s,a,o;let l;return r=this.localStore,n=this.remoteStore,i=this.eventManager,s=this.sharedClientState,a=e.initialUser,o=e.maxConcurrentLimboResolutions,l=new oA(r,n,i,s,a,o),t&&(l.gu=!0),l}async terminate(){await async function(e){_(aV,"RemoteStore shutting down."),e.Ea.add(5),await aq(e),e.Aa.shutdown(),e.Va.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}function le(e,t=10240){let r=0;return{async read(){if(r<e.byteLength){let n={value:e.slice(r,r+t),done:!1};return r+=t,n}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}o9.provider={build:()=>new o9};class lt{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):v("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class lr{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new C,this.buffer=new Uint8Array,this.Lu=new TextDecoder("utf-8"),this.ku().then(e=>{e&&e.Ua()?this.metadata.resolve(e.qa.metadata):this.metadata.reject(Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(e?.qa)}`))},e=>this.metadata.reject(e))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.ku()}async ku(){let e=await this.Ku();if(null===e)return null;let t=this.Lu.decode(e),r=Number(t);return isNaN(r)&&this.qu(`length string (${t}) is not valid number`),new om(JSON.parse(await this.Uu(r)),e.length+r)}$u(){return this.buffer.findIndex(e=>123===e)}async Ku(){for(;0>this.$u()&&!await this.Wu(););if(0===this.buffer.length)return null;let e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Uu(e){for(;this.buffer.length<e;)await this.Wu()&&this.qu("Reached the end of bundle when more is expected.");let t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Bu.cancel(),Error(`Invalid bundle format: ${e}`)}async Wu(){let e=await this.Bu.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class ln{constructor(e,t){this.bundleData=e,this.serializer=t,this.cursor=0,this.elements=[];let r=this.Su();if(!r||!r.Ua())throw Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(r?.qa)}`);this.metadata=r;do null!==(r=this.Su())&&this.elements.push(r);while(null!==r)}getMetadata(){return this.metadata}Qu(){return this.elements}Su(){if(this.cursor===this.bundleData.length)return null;let e=this.Ku();return new om(JSON.parse(this.Uu(e)),e)}Uu(e){if(this.cursor+e>this.bundleData.length)throw new S(A.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}Ku(){let e=this.cursor,t=this.cursor;for(;t<this.bundleData.length;){if("{"===this.bundleData[t]){if(t===e)throw Error("First character is a bracket and not a number");return this.cursor=t,Number(this.bundleData.slice(e,t))}t++}throw Error("Reached the end of bundle when more is expected.")}}class li{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new S(A.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=await async function(e,t){let r={documents:t.map(t=>io(e.serializer,t))},n=await e.jo("BatchGetDocuments",e.serializer.databaseId,B.emptyPath(),r,t.length),i=new Map;n.forEach(t=>{var r;let n,s,a,o,l,u,c=(r=e.serializer,"found"in t?(b(!!t.found,43571),t.found.name,t.found.updateTime,n=il(r,t.found.name),s=ir(t.found.updateTime),a=t.found.createTime?ir(t.found.createTime):et.min(),o=new rg({mapValue:{fields:t.found.fields}}),ry.newFoundDocument(n,s,a,o)):"missing"in t?(b(!!t.missing,3894),b(!!t.readTime,22933),l=il(r,t.missing),u=ir(t.readTime),ry.newNoDocument(l,u)):E(7234,{result:t}));i.set(c.key.toString(),c)});let s=[];return t.forEach(e=>{let t=i.get(e.toString());b(!!t,55234,{key:e}),s.push(t)}),s}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new nO(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{let r=G.fromPath(t);this.mutations.push(new nL(r,this.precondition(r)))}),await async function(e,t){let r={writes:t.map(t=>iy(e.serializer,t))};await e.Wo("Commit",e.serializer.databaseId,B.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw E(50498,{Gu:e.constructor.name});t=et.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new S(A.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(et.min())?nT.exists(!1):nT.updateTime(t):nT.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(et.min()))throw new S(A.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return nT.updateTime(t)}return nT.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class ls{constructor(e,t,r,n,i){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=n,this.deferred=i,this.zu=r.maxAttempts,this.M_=new aP(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_(async()=>{let e=new li(this.datastore),t=this.Ju(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.Zu(e)}))}).catch(e=>{this.Zu(e)})})}Ju(e){try{let t=this.updateFunction(e);return!eN(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Hu(),Promise.resolve()))):this.deferred.reject(e)}Xu(e){if("FirebaseError"===e?.name){let t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!nB(t)}return!1}}let la="FirestoreClient";class lo{constructor(e,t,r,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this._databaseInfo=n,this.user=p.UNAUTHENTICATED,this.clientId=O.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async e=>{_(la,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(r,e=>(_(la,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new C;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){let t=or(r,"Failed to shutdown persistence");e.reject(t)}}),e.promise}}async function ll(e,t){e.asyncQueue.verifyOperationInProgress(),_(la,"Initializing OfflineComponentProvider");let r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async e=>{n.isEqual(e)||(await sZ(t.localStore,e),n=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function lu(e,t){e.asyncQueue.verifyOperationInProgress();let r=await lc(e);_(la,"Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(e=>a8(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,r)=>a8(t.remoteStore,r)),e._onlineComponents=t}async function lc(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){_(la,"Using user provided OfflineComponentProvider");try{await ll(e,e._uninitializedComponentsProvider._offline)}catch(t){if(!("FirebaseError"===t.name?t.code===A.FAILED_PRECONDITION||t.code===A.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw t;w("Error using user provided cache. Falling back to memory cache: "+t),await ll(e,new o4)}}else _(la,"Using default OfflineComponentProvider"),await ll(e,new o5(void 0));return e._offlineComponents}async function lh(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(_(la,"Using user provided OnlineComponentProvider"),await lu(e,e._uninitializedComponentsProvider._online)):(_(la,"Using default OnlineComponentProvider"),await lu(e,new o9))),e._onlineComponents}function ld(e){return lc(e).then(e=>e.persistence)}function lf(e){return lc(e).then(e=>e.localStore)}function lp(e){return lh(e).then(e=>e.remoteStore)}function lm(e){return lh(e).then(e=>e.syncEngine)}function lg(e){return lh(e).then(e=>e.datastore)}async function ly(e){let t=await lh(e),r=t.eventManager;return r.onListen=oS.bind(null,t.syncEngine),r.onUnlisten=ok.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=oC.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=oN.bind(null,t.syncEngine),r}function l_(e){let t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}let lv="ComponentProvider",lw=new Map;function lI(e,t,r,n,i){return new tX(e,t,r,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,l_(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,n)}let lE="firestore.googleapis.com";class lT{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new S(A.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=lE,this.ssl=!0}else this.host=e.host,this.ssl=e.ssl??!0;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=0x2800000;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new S(A.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}H("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=l_(e.experimentalLongPollingOptions??{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new S(A.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new S(A.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new S(A.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){var t,r;return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,r=e.experimentalLongPollingOptions,t.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class lb{constructor(e,t,r,n){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new S(A.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new S(A.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lT(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new P;switch(e.type){case"firstParty":return new D(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new S(A.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){let e;return(e=lw.get(this))&&(_(lv,"Removing Datastore"),lw.delete(this),e.terminate()),Promise.resolve()}}function lA(e,t,r,n={}){e=Y(e,lb);let i=c.isCloudWorkstation(t),s=e._getSettings(),a={...s,emulatorOptions:e._getEmulatorOptions()},o=`${t}:${r}`;i&&(c.pingServer(`https://${o}`),c.updateEmulatorBanner("Firestore",!0)),s.host!==lE&&s.host!==o&&w("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l={...s,host:o,ssl:i,emulatorOptions:n};if(!c.deepEqual(l,a)&&(e._setSettings(l),n.mockUserToken)){let t,r;if("string"==typeof n.mockUserToken)t=n.mockUserToken,r=p.MOCK_USER;else{t=c.createMockUserToken(n.mockUserToken,e._app?.options.projectId);let i=n.mockUserToken.sub||n.mockUserToken.user_id;if(!i)throw new S(A.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");r=new p(i)}e._authCredentials=new k(new R(t,r))}}class lS{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new lS(this.firestore,e,this._query)}}class lC{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new lR(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new lC(this.firestore,e,this._key)}toJSON(){return{type:lC._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Z(t,lC._jsonSchema))return new lC(e,r||null,new G(B.fromString(t.referencePath)))}}lC._jsonSchemaVersion="firestore/documentReference/1.0",lC._jsonSchema={type:X("string",lC._jsonSchemaVersion),referencePath:X("string")};class lR extends lS{constructor(e,t,r){super(e,t,rK(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new lC(this.firestore,null,new G(e))}withConverter(e){return new lR(this.firestore,e,this._path)}}let lP="AsyncQueue";class lk{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new aP(this,"async_queue_retry"),this._c=()=>{let e=aC();e&&_(lP,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=aC();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=aC();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new C;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(0!==this.Yu.length){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!eE(e))throw e;_(lP,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,v("INTERNAL UNHANDLED ERROR: ",lN(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let n=ot.createAndSchedule(this,e,t,r,e=>this.hc(e));return this.tc.push(n),n}uc(){this.nc&&E(47125,{Pc:lN(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{for(let t of(this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs),this.tc))if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}}function lN(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class lD{constructor(){this._progressObserver={},this._taskCompletionResolver=new C,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class lx extends lb{constructor(e,t,r,n){super(e,t,r,n),this.type="firestore",this._queue=new lk,this._persistenceKey=n?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new lk(e),this._firestoreClient=void 0,await e}}}function lO(e){if(e._terminated)throw new S(A.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||lL(e),e._firestoreClient}function lL(e){var t;let r,n=e._freezeSettings(),i=lI(e._databaseId,e._app?.options.appId||"",e._persistenceKey,e._app?.options.apiKey,n);e._componentsProvider||n.localCache?._offlineComponentProvider&&n.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:n.localCache._offlineComponentProvider,_online:n.localCache._onlineComponentProvider}),e._firestoreClient=new lo(e._authCredentials,e._appCheckCredentials,e._queue,i,e._componentsProvider&&(t=e._componentsProvider,r=t?._online.build(),{_offline:t?._offline.build(r),_online:r}))}async function lM(e){w("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=e._freezeSettings();lV(e,o9.provider,{build:e=>new o7(e,t.cacheSizeBytes)})}function lV(e,t,r){if((e=Y(e,lx))._firestoreClient||e._terminated)throw new S(A.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new S(A.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:r},lL(e)}class lF{constructor(e){this._byteString=e}static fromBase64String(e){try{return new lF(tq.fromBase64String(e))}catch(e){throw new S(A.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new lF(tq.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:lF._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Z(e,lF._jsonSchema))return lF.fromBase64String(e.bytes)}}lF._jsonSchemaVersion="firestore/bytes/1.0",lF._jsonSchema={type:X("string",lF._jsonSchemaVersion),bytes:X("string")};class lU{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new S(A.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new z(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class lq{constructor(e){this._methodName=e}}class lB{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new S(A.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new S(A.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return L(this._lat,e._lat)||L(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:lB._jsonSchemaVersion}}static fromJSON(e){if(Z(e,lB._jsonSchema))return new lB(e.latitude,e.longitude)}}lB._jsonSchemaVersion="firestore/geoPoint/1.0",lB._jsonSchema={type:X("string",lB._jsonSchemaVersion),latitude:X("number"),longitude:X("number")};class lj{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(this._values,e._values)}toJSON(){return{type:lj._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Z(e,lj._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new lj(e.vectorValues);throw new S(A.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}lj._jsonSchemaVersion="firestore/vectorValue/1.0",lj._jsonSchema={type:X("string",lj._jsonSchemaVersion),vectorValues:X("object")};let lz=/^__.*__$/;class lG{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new nk(e,this.data,this.fieldMask,t,this.fieldTransforms):new nP(e,this.data,t,this.fieldTransforms)}}class l${constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new nk(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function lH(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw E(40011,{dataSource:e})}}class lK{constructor(e,t,r,n,i,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=n,void 0===i&&this.validatePath(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new lK({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return l7(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(0===e.length)throw this.createError("Document fields must not be empty");if(lH(this.dataSource)&&lz.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class lW{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||aR(e)}createContext(e,t,r,n=!1){return new lK({dataSource:e,methodName:t,targetDoc:r,path:z.emptyPath(),arrayElement:!1,hasConverter:n},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}class lQ extends lq{_toFieldTransform(e){if(2!==e.dataSource)throw 1===e.dataSource?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof lQ}}function lJ(e,t,r){return new lK({dataSource:3,targetDoc:t.settings.targetDoc,methodName:e._methodName,arrayElement:r},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class lY extends lq{_toFieldTransform(e){return new nI(e.path,new nf)}isEqual(e){return e instanceof lY}}class lX extends lq{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){let t=lJ(this,e,!0),r=new np(this.Ac.map(e=>l1(e,t)));return new nI(e.path,r)}isEqual(e){return e instanceof lX&&c.deepEqual(this.Ac,e.Ac)}}class lZ extends lq{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){let t=lJ(this,e,!0),r=new ng(this.Ac.map(e=>l1(e,t)));return new nI(e.path,r)}isEqual(e){return e instanceof lZ&&c.deepEqual(this.Ac,e.Ac)}}class l0 extends lq{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){let t=new n_(e.serializer,nc(e.serializer,this.Vc));return new nI(e.path,t)}isEqual(e){return e instanceof l0&&this.Vc===e.Vc}}function l1(e,t){if(l6(e=c.getModularInstance(e)))return l3("Unsupported field value:",t,e),l2(e,t);if(e instanceof lq)return function(e,t){if(!lH(t.dataSource))throw t.createError(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.createError(`${e._methodName}() is not currently supported inside arrays`);let r=e._toFieldTransform(t);r&&t.fieldTransforms.push(r)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.arrayElement&&4!==t.dataSource)throw t.createError("Nested arrays are not supported");let r=[],n=0;for(let i of e){let e=l1(i,t.childContextForArray(n));null==e&&(e={nullValue:"NULL_VALUE"}),r.push(e),n++}return{arrayValue:{values:r}}}return function(e,t){if(null===(e=c.getModularInstance(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return nc(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){let r=ee.fromDate(e);return{timestampValue:ie(t.serializer,r)}}if(e instanceof ee){let r=new ee(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:ie(t.serializer,r)}}if(e instanceof lB)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof lF)return{bytesValue:it(t.serializer,e._byteString)};if(e instanceof lC){let r=t.databaseId,n=e.firestore._databaseId;if(!n.isEqual(r))throw t.createError(`Document reference is for database ${n.projectId}/${n.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:ii(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof lj){var r;return{mapValue:{fields:{[t1]:{stringValue:t3},[t4]:{arrayValue:{values:((r=e)instanceof lj?r.toArray():r).map(e=>{if("number"!=typeof e)throw t.createError("VectorValues must only contain numeric values.");return nl(t.serializer,e)})}}}}}}if(iS(e))return e._toProto(t.serializer);throw t.createError(`Unsupported field value: ${J(e)}`)}(e,t)}function l2(e,t){let r={};return tN(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):tP(e,(e,n)=>{let i=l1(n,t.childContextForField(e));null!=i&&(r[e]=i)}),{mapValue:{fields:r}}}function l6(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ee||e instanceof lB||e instanceof lF||e instanceof lC||e instanceof lq||e instanceof lj||iS(e))}function l3(e,t,r){if(!l6(r)||!Q(r)){let n=J(r);throw"an object"===n?t.createError(e+" a custom object"):t.createError(e+" "+n)}}function l4(e,t,r){if((t=c.getModularInstance(t))instanceof lU)return t._internalPath;if("string"==typeof t)return l8(e,t);throw l7("Field path arguments must be of type string or ",e,!1,void 0,r)}let l5=RegExp("[~\\*/\\[\\]]");function l8(e,t,r){if(t.search(l5)>=0)throw l7(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new lU(...t.split("."))._internalPath}catch(n){throw l7(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function l7(e,t,r,n,i){let s=n&&!n.isEmpty(),a=void 0!==i,o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new S(A.INVALID_ARGUMENT,o+e+l)}function l9(e,t){return e.some(e=>e.isEqual(t))}class ue{convertValue(e,t="none"){switch(t8(e)){case 0:return null;case 1:return e.booleanValue;case 2:return tz(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(tG(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw E(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return tP(e,(e,n)=>{r[e]=this.convertValue(n,t)}),r}convertVectorValue(e){return new lj(e.fields?.[t4].arrayValue?.values?.map(e=>tz(e.doubleValue)))}convertGeoPoint(e){return new lB(tz(e.latitude),tz(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=tJ(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(tY(e));default:return null}}convertTimestamp(e){let t=tj(e);return new ee(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=B.fromString(e);b(iA(r),9688,{name:e});let n=new t0(r.get(1),r.get(3)),i=new G(r.popFirst(5));return n.isEqual(t)||v(`Document ${i} contains a document reference within a different database (${n.projectId}/${n.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}class ut{constructor(e){this.optionDefinitions=e}_getKnownOptions(e,t){let r=rg.empty();for(let n in this.optionDefinitions)if(this.optionDefinitions.hasOwnProperty(n)){let i=this.optionDefinitions[n];if(n in e){let s,a=e[n];i.nestedOptions&&Q(a)?s={mapValue:{fields:new ut(i.nestedOptions).getOptionsProto(t,a)}}:a&&(s=l1(a,t)??void 0),s&&r.set(z.fromServerFormat(i.serverName),s)}}return r}getOptionsProto(e,t,r){let n=this._getKnownOptions(t,e);if(r){let t=new Map(tk(r,(t,r)=>[z.fromServerFormat(r),void 0!==t?l1(t,e):null]));n.setAll(t)}return n.value.mapValue.fields??{}}}class ur{constructor(e={},t={}){this.dc=e,this.mc=t,this.fc=new ut({indexMode:{serverName:"index_mode"}})}_readUserData(e){this.proto=this.fc.getOptionsProto(e,this.dc,this.mc)}}class un{constructor(e,t){this.pipeline=e,this.options=t}_toProto(e){return{pipeline:this.pipeline._toProto(e),options:this.options.proto}}}r.AbstractUserDataWriter=ue,r.Bound=r_,r.ByteString=tq,r.Bytes=lF,r.C=A,r.CollectionReference=lR,r.CompositeFilter=rb,r.DatabaseId=t0,r.DocumentKey=G,r.DocumentReference=lC,r.DocumentSet=on,r.FieldFilter=rT,r.FieldIndex=er,r.FieldPath=lU,r.FieldPath$1=z,r.FieldValue=lq,r.Firestore=lx,r.FirestoreError=S,r.GeoPoint=lB,r.IndexSegment=ea,r.IndexState=eo,r.LoadBundleTask=lD,r.M=U,r.ObjectValue=rg,r.OnlineComponentProvider=o9,r.OptionsUtil=ut,r.OrderBy=rI,r.Precondition=nT,r.Query=lS,r.ResourcePath=B,r.StructuredPipeline=un,r.Timestamp=ee,r.UserDataReader=lW,r.VectorValue=lj,r.ViewSnapshot=os,r.__PRIVATE_AggregateImpl=nU,r.__PRIVATE_AutoId=O,r.__PRIVATE_BundleLoader=oy,r.__PRIVATE_DeleteMutation=nO,r.__PRIVATE_EmptyAppCheckTokenProvider=class{getToken(){return Promise.resolve(new x(""))}invalidateToken(){}start(e,t){}shutdown(){}},r.__PRIVATE_EmptyAuthCredentialsProvider=P,r.__PRIVATE_ExpUserDataWriter=class extends ue{constructor(e){super(),this.firestore=e}convertBytes(e){return new lF(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new lC(this.firestore,null,t)}},r.__PRIVATE_FirebaseAppCheckTokenProvider=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,u._isFirebaseServerApp(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){b(void 0===this.o,3512);let r=e=>{null!=e.error&&_("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let r=e.token!==this.m;return this.m=e.token,_("FirebaseAppCheckTokenProvider",`Received ${r?"new":"existing"} token.`),r?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>r(t))};let n=e=>{_("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>n(e)),setTimeout(()=>{if(!this.appCheck){let e=this.V.getImmediate({optional:!0});e?n(e):_("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new x(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(b("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new x(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}},r.__PRIVATE_FirebaseAuthCredentialsProvider=class{constructor(e){this.t=e,this.currentUser=p.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){b(void 0===this.o,42304);let r=this.i,n=e=>this.i!==r?(r=this.i,t(e)):Promise.resolve(),i=new C;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new C,e.enqueueRetryable(()=>n(this.currentUser))};let s=()=>{let t=i;e.enqueueRetryable(async()=>{await t.promise,await n(this.currentUser)})},a=e=>{_("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){let e=this.t.getImmediate({optional:!0});e?a(e):(_("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new C)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(_("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(b("string"==typeof t.accessToken,31837,{l:t}),new R(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return b(null===e||"string"==typeof e,2055,{h:e}),new p(e)}},r.__PRIVATE_IndexedDbOfflineComponentProvider=o8,r.__PRIVATE_LruGcMemoryOfflineComponentProvider=o5,r.__PRIVATE_MemoryOfflineComponentProvider=o4,r.__PRIVATE_MultiTabOfflineComponentProvider=o7,r.__PRIVATE_StructuredPipelineOptions=ur,r.__PRIVATE_cast=Y,r.__PRIVATE_createBundleReaderSync=function(e,t){return new ln(e,t)},r.__PRIVATE_databaseIdFromApp=function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new S(A.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new t0(e.options.projectId,t)},r.__PRIVATE_debugAssert=function(e,t){e||E(57014,t)},r.__PRIVATE_documentKeySet=na,r.__PRIVATE_fieldPathFromArgument=l4,r.__PRIVATE_fieldPathFromDotSeparatedString=l8,r.__PRIVATE_firestoreClientAddSnapshotsInSyncListener=function(e,t){let r=new lt(t);return e.asyncQueue.enqueueAndForget(async()=>{var t;return t=await ly(e),void(t.Ca.add(r),r.next())}),()=>{r.Nu(),e.asyncQueue.enqueueAndForget(async()=>{var t;return t=await ly(e),void t.Ca.delete(r)})}},r.__PRIVATE_firestoreClientDeleteAllFieldIndexes=function(e){return e.asyncQueue.enqueue(async()=>{var t;let r;return r=(t=await lf(e)).indexManager,t.persistence.runTransaction("Delete All Indexes","readwrite",e=>r.deleteAllFieldIndexes(e))})},r.__PRIVATE_firestoreClientExecutePipeline=function(e,t){let r=new C;return e.asyncQueue.enqueueAndForget(async()=>{try{let n=await lg(e);r.resolve(async function(e,t){let r={database:ih(e.serializer),structuredPipeline:t._toProto(e.serializer)},n=await e.jo("ExecutePipeline",e.serializer.databaseId,B.emptyPath(),r),i=[];return n.forEach(t=>{if(t.results&&0!==t.results.length)return t.results.forEach(r=>i.push(im(e.serializer,t,r)));i.push(im(e.serializer,t))}),i}(n,t))}catch(e){r.reject(e)}}),r.promise},r.__PRIVATE_firestoreClientGetDocumentFromLocalCache=function(e,t){let r=new C;return e.asyncQueue.enqueueAndForget(async()=>(async function(e,t,r){try{let n=await e.persistence.runTransaction("read document","readonly",r=>e.localDocuments.getDocument(r,t));n.isFoundDocument()?r.resolve(n):n.isNoDocument()?r.resolve(null):r.reject(new S(A.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(n){let e=or(n,`Failed to get document '${t} from cache`);r.reject(e)}})(await lf(e),t,r)),r.promise},r.__PRIVATE_firestoreClientGetDocumentViaSnapshotListener=function(e,t,r={}){let n=new C;return e.asyncQueue.enqueueAndForget(async()=>{var i,s;let a,o;return i=await ly(e),s=e.asyncQueue,a=new lt({next:e=>{a.Nu(),s.enqueueAndForget(()=>oc(i,o));let l=e.docs.has(t);!l&&e.fromCache?n.reject(new S(A.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&e.fromCache&&r&&"server"===r.source?n.reject(new S(A.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):n.resolve(e)},error:e=>n.reject(e)}),ou(i,o=new op(rK(t.path),a,{includeMetadataChanges:!0,Ka:!0}))}),n.promise},r.__PRIVATE_firestoreClientGetDocumentsFromLocalCache=function(e,t){let r=new C;return e.asyncQueue.enqueueAndForget(async()=>(async function(e,t,r){try{let n=await s3(e,t,!0),i=new oI(t,n.ks),s=i.ru(n.documents),a=i.applyChanges(s,!1);r.resolve(a.snapshot)}catch(n){let e=or(n,`Failed to execute query '${t} against cache`);r.reject(e)}})(await lf(e),t,r)),r.promise},r.__PRIVATE_firestoreClientGetDocumentsViaSnapshotListener=function(e,t,r={}){let n=new C;return e.asyncQueue.enqueueAndForget(async()=>{var i,s;let a,o;return i=await ly(e),s=e.asyncQueue,o=new op(t,a=new lt({next:e=>{a.Nu(),s.enqueueAndForget(()=>oc(i,o)),e.fromCache&&"server"===r.source?n.reject(new S(A.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):n.resolve(e)},error:e=>n.reject(e)}),{includeMetadataChanges:!0,Ka:!0}),ou(i,o)}),n.promise},r.__PRIVATE_firestoreClientListen=function(e,t,r,n){let i=new lt(n),s=new op(t,i,r);return e.asyncQueue.enqueueAndForget(async()=>ou(await ly(e),s)),()=>{i.Nu(),e.asyncQueue.enqueueAndForget(async()=>oc(await ly(e),s))}},r.__PRIVATE_firestoreClientRunAggregateQuery=function(e,t,r){let n=new C;return e.asyncQueue.enqueueAndForget(async()=>{try{let i=await lg(e);n.resolve(async function(e,t,r){let{request:n,gt:i,parent:s}=iI(e.serializer,rZ(t),r);e.connection.Ko||delete n.parent;let a=(await e.jo("RunAggregationQuery",e.serializer.databaseId,s,n,1)).filter(e=>!!e.result);b(1===a.length,64727);let o=a[0].result?.aggregateFields;return Object.keys(o).reduce((e,t)=>(e[i[t]]=o[t],e),{})}(i,t,r))}catch(e){n.reject(e)}}),n.promise},r.__PRIVATE_firestoreClientSetIndexConfiguration=function(e,t){return e.asyncQueue.enqueue(async()=>(async function(e,t){let r=e.indexManager,n=[];return e.persistence.runTransaction("Configure indexes","readwrite",e=>r.getFieldIndexes(e).next(i=>(function(e,t,r,n,i){t=[...t],(e=[...e]).sort(r),t.sort(r);let s=e.length,a=t.length,o=0,l=0;for(;o<a&&l<s;){let s=r(e[l],t[o]);s<0?i(e[l++]):s>0?n(t[o++]):(o++,l++)}for(;o<a;)n(t[o++]);for(;l<s;)i(e[l++])})(i,t,es,t=>{n.push(r.addFieldIndex(e,t))},t=>{n.push(r.deleteFieldIndex(e,t))})).next(()=>em.waitFor(n)))})(await lf(e),t))},r.__PRIVATE_firestoreClientSetPersistentCacheIndexAutoCreationEnabled=function(e,t){return e.asyncQueue.enqueue(async()=>{var r;return r=await lf(e),void(r.Cs.As=t)})},r.__PRIVATE_firestoreClientTransaction=function(e,t,r){let n=new C;return e.asyncQueue.enqueueAndForget(async()=>{let i=await lg(e);new ls(e.asyncQueue,i,r,t,n).ju()}),n.promise},r.__PRIVATE_firestoreClientWrite=function(e,t){let r=new C;return e.asyncQueue.enqueueAndForget(async()=>oD(await lm(e),t,r)),r.promise},r.__PRIVATE_fromBundledQuery=iM,r.__PRIVATE_fromDocument=ig,r.__PRIVATE_hardAssert=b,r.__PRIVATE_isBase64Available=function(){return"undefined"!=typeof atob},r.__PRIVATE_isCollectionGroupQuery=rJ,r.__PRIVATE_isCollectionReference=function(e){return e instanceof lR},r.__PRIVATE_isDocumentQuery$1=rQ,r.__PRIVATE_isNumber$1=function(e){return"number"==typeof e},r.__PRIVATE_isOptionalEqual=function(e,t,r){return void 0===e&&void 0===t||void 0!==e&&void 0!==t&&r(e,t)},r.__PRIVATE_isPlainObject=Q,r.__PRIVATE_isServerTimestamp=tQ,r.__PRIVATE_isString=function(e){return"string"==typeof e},r.__PRIVATE_isUserData=function(e){return"function"==typeof e._readUserData},r.__PRIVATE_logDebug=_,r.__PRIVATE_logWarn=w,r.__PRIVATE_mapToArray=tk,r.__PRIVATE_newQueryForPath=rK,r.__PRIVATE_newSerializer=aR,r.__PRIVATE_newUserDataReader=function(e){let t=e._freezeSettings(),r=aR(e._databaseId);return new lW(e._databaseId,!!t.ignoreUndefinedProperties,r)},r.__PRIVATE_parseData=l1,r.__PRIVATE_parseQueryValue=function(e,t,r,n=!1){return l1(r,e.createContext(n?4:3,t))},r.__PRIVATE_parseSetData=function(e,t,r,n,i,s={}){let a,o,l=e.createContext(s.merge||s.mergeFields?2:0,t,r,i);l3("Data must be an object, but it was:",l,n);let u=l2(n,l);if(s.merge)a=new tF(l.fieldMask),o=l.fieldTransforms;else if(s.mergeFields){let e=[];for(let n of s.mergeFields){let i=l4(t,n,r);if(!l.contains(i))throw new S(A.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);l9(e,i)||e.push(i)}a=new tF(e),o=l.fieldTransforms.filter(e=>a.covers(e.field))}else a=null,o=l.fieldTransforms;return new lG(new rg(u),a,o)},r.__PRIVATE_parseUpdateData=function(e,t,r,n){let i=e.createContext(1,t,r);l3("Data must be an object, but it was:",i,n);let s=[],a=rg.empty();return tP(n,(e,n)=>{let o=l8(t,e,r);n=c.getModularInstance(n);let l=i.childContextForFieldPath(o);if(n instanceof lQ)s.push(o);else{let e=l1(n,l);null!=e&&(s.push(o),a.set(o,e))}}),new l$(a,new tF(s),i.fieldTransforms)},r.__PRIVATE_parseUpdateVarargs=function(e,t,r,n,i,s){let a=e.createContext(1,t,r),o=[l4(t,n,r)],l=[i];if(s.length%2!=0)throw new S(A.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)o.push(l4(t,s[e])),l.push(s[e+1]);let u=[],h=rg.empty();for(let e=o.length-1;e>=0;--e)if(!l9(u,o[e])){let t=o[e],r=l[e];r=c.getModularInstance(r);let n=a.childContextForFieldPath(t);if(r instanceof lQ)u.push(t);else{let e=l1(r,n);null!=e&&(u.push(t),h.set(t,e))}}return new l$(h,new tF(u),a.fieldTransforms)},r.__PRIVATE_queryNormalizedOrderBy=rY,r.__PRIVATE_queryWithAddedFilter=function(e,t){let r=e.filters.concat([t]);return new rH(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)},r.__PRIVATE_queryWithAddedOrderBy=function(e,t){let r=e.explicitOrderBy.concat([t]);return new rH(e.path,e.collectionGroup,r,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)},r.__PRIVATE_queryWithEndAt=function(e,t){return new rH(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)},r.__PRIVATE_queryWithLimit=r1,r.__PRIVATE_queryWithStartAt=function(e,t){return new rH(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)},r.__PRIVATE_refValue=ri,r.__PRIVATE_setSDKVersion=function(e){m=e},r.__PRIVATE_setTestingHooksSpi=function(e){if(nz)throw Error("a TestingHooksSpi instance is already set");nz=e},r.__PRIVATE_toMapValue=function(e,t){let r={fields:{}};return t.forEach((t,n)=>{if("string"!=typeof n)throw Error(`Cannot encode map with non-string key: ${n}`);r.fields[n]=t._toProto(e)}),{mapValue:r}},r.__PRIVATE_toPipelineValue=function(e){return{pipelineValue:e}},r.__PRIVATE_toStringValue=function(e){return{stringValue:e}},r.__PRIVATE_validateIsNotUsedTogether=H,r.__PRIVATE_validateJSON=Z,r.__PRIVATE_validatePositiveNumber=function(e,t){if(t<=0)throw new S(A.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)},r.__PRIVATE_valueDescription=J,r._internalAggregationQueryToProtoRunAggregationQueryRequest=function(e,t){let r=tk(t,(e,t)=>new nU(t,e.aggregateType,e._internalFieldPath)),n=lO(Y(e.firestore,lx)),i=n._onlineComponents?.datastore.serializer;return void 0===i?null:iI(i,rZ(e._query),r,!0).request},r._internalPipelineToExecutePipelineRequestProto=function(e){let t=function(e){if(e._terminated)throw new S(A.FAILED_PRECONDITION,"The client has already been terminated.");if(!lw.has(e)){var t;_(lv,"Initializing Datastore");let r=new aA(lI(e._databaseId,e.app.options.appId||"",e._persistenceKey,e.app.options.apiKey,e._freezeSettings())),n=aR(e._databaseId),i=(t=e._authCredentials,new aL(t,e._appCheckCredentials,r,n));lw.set(e,i)}return lw.get(e)}(Y(e._db,lx)).serializer;if(void 0===t)return null;let r=new un(e,new ur);return{database:ih(t),structuredPipeline:r._toProto(t)}},r._internalQueryToProtoQueryTarget=function(e){let t=lO(Y(e.firestore,lx)),r=t._onlineComponents?.datastore.serializer;return void 0===r?null:iw(r,rX(e._query)).ft},r.arrayRemove=function(...e){return new lZ("arrayRemove",e)},r.arrayUnion=function(...e){return new lX("arrayUnion",e)},r.clearIndexedDbPersistence=function(e){if(e._initialized&&!e._terminated)throw new S(A.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let t=new C;return e._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(e){if(!e_.v())return Promise.resolve();await e_.delete(e+s$)}(sK(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}}),t.promise},r.collection=function(e,t,...r){if(e=c.getModularInstance(e),$("collection","path",t),e instanceof lb){let n=B.fromString(t,...r);return W(n),new lR(e,null,n)}{if(!(e instanceof lC||e instanceof lR))throw new S(A.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=e._path.child(B.fromString(t,...r));return W(n),new lR(e.firestore,null,n)}},r.collectionGroup=function(e,t){if(e=Y(e,lb),$("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new S(A.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new lS(e,null,new rH(B.emptyPath(),t))},r.connectFirestoreEmulator=lA,r.deleteField=function(){return new lQ("deleteField")},r.disableNetwork=function(e){var t;return(t=lO(e=Y(e,lx))).asyncQueue.enqueue(async()=>{let e=await ld(t),r=await lp(t);return e.setNetworkEnabled(!1),async function(e){e.Ea.add(0),await aq(e),e.Va.set("Offline")}(r)})},r.doc=function(e,t,...r){if(e=c.getModularInstance(e),1==arguments.length&&(t=O.newId()),$("doc","path",t),e instanceof lb){let n=B.fromString(t,...r);return K(n),new lC(e,null,new G(n))}{if(!(e instanceof lC||e instanceof lR))throw new S(A.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=e._path.child(B.fromString(t,...r));return K(n),new lC(e.firestore,e instanceof lR?e.converter:null,new G(n))}},r.documentId=function(){return new lU(U)},r.enableIndexedDbPersistence=function(e,t){w("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=e._freezeSettings();return lV(e,o9.provider,{build:e=>new o8(e,r.cacheSizeBytes,t?.forceOwnership)}),Promise.resolve()},r.enableMultiTabIndexedDbPersistence=lM,r.enableNetwork=function(e){var t;return(t=lO(e=Y(e,lx))).asyncQueue.enqueue(async()=>{let e=await ld(t),r=await lp(t);return e.setNetworkEnabled(!0),r.Ea.delete(0),aU(r)})},r.ensureFirestoreConfigured=lO,r.fail=E,r.getFirestore=function(e,t){let r="object"==typeof e?e:u.getApp(),n="string"==typeof e?e:t||tZ,i=u._getProvider(r,"firestore").getImmediate({identifier:n});if(!i._initialized){let e=c.getDefaultEmulatorHostnameAndPort("firestore");e&&lA(i,...e)}return i},r.increment=function(e){return new l0("increment",e)},r.initializeFirestore=function(e,t,r){r||(r=tZ);let n=u._getProvider(e,"firestore");if(n.isInitialized(r)){let e=n.getImmediate({identifier:r}),i=n.getOptions(r);if(c.deepEqual(i,t))return e;throw new S(A.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==t.cacheSizeBytes&&void 0!==t.localCache)throw new S(A.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(void 0!==t.cacheSizeBytes&&-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new S(A.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return t.host&&c.isCloudWorkstation(t.host)&&c.pingServer(t.host),n.initialize({options:t,instanceIdentifier:r})},r.loadBundle=function(e,t){let r=lO(e=Y(e,lx)),n=new lD;return function(e,t,r,n){var i;let s=(i=aR(t),new lr(function(e,t){if(e instanceof Uint8Array)return le(e,void 0);if(e instanceof ArrayBuffer)return le(new Uint8Array(e),void 0);if(e instanceof ReadableStream)return e.getReader();throw Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof r?nG().encode(r):r),i));e.asyncQueue.enqueueAndForget(async()=>{var t;(async function(e,t,r){try{var n,i;let s,a=await t.getMetadata();if(await (n=e.localStore,s=ir(a.createTime),n.persistence.runTransaction("hasNewerBundle","readonly",e=>n.Pi.getBundleMetadata(e,a.id)).then(e=>!!e&&e.createTime.compareTo(s)>=0)))return await t.close(),r._completeWith({taskState:"Success",documentsLoaded:a.totalDocuments,bytesLoaded:a.totalBytes,totalDocuments:a.totalDocuments,totalBytes:a.totalBytes}),Promise.resolve(new Set);r._updateProgress(o_(a));let o=new oy(a,t.serializer),l=await t.Su();for(;l;){let e=await o.Ga(l);e&&r._updateProgress(e),l=await t.Su()}let u=await o.ja(e.localStore);return await o$(e,u.Ja,void 0),await (i=e.localStore,i.persistence.runTransaction("Save bundle","readwrite",e=>i.Pi.saveBundleMetadata(e,a))),r._completeWith(u.progress),Promise.resolve(u.Ha)}catch(e){return w(oE,`Loading bundle failed with ${e}`),r._failWith(e),Promise.resolve(new Set)}})(t=await lm(e),s,n).then(e=>{t.sharedClientState.notifyBundleLoaded(e)})})}(r,e._databaseId,t,n),n},r.namedQuery=function(e,t){var r;return(r=lO(e=Y(e,lx)),r.asyncQueue.enqueue(async()=>{var e;return e=await lf(r),e.persistence.runTransaction("Get named query","readonly",r=>e.Pi.getNamedQuery(r,t))})).then(t=>t?new lS(e,null,t.query):null)},r.on=-1,r.property=X,r.queryEqual=function(e,t){return e=c.getModularInstance(e),t=c.getModularInstance(t),e instanceof lS&&t instanceof lS&&e.firestore===t.firestore&&r2(e._query,t._query)&&e.converter===t.converter},r.refEqual=function(e,t){return e=c.getModularInstance(e),t=c.getModularInstance(t),(e instanceof lC||e instanceof lR)&&(t instanceof lC||t instanceof lR)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter},r.serverTimestamp=function(){return new lY("serverTimestamp")},r.setLogLevel=function(e){g.setLogLevel(e)},r.terminate=function(e){return u._removeServiceInstance(e.app,"firestore",e._databaseId.database),e._delete()},r.toNumber=nc,r.vector=function(e){return new lj(e)},r.waitForPendingWrites=function(e){var t;let r;return t=lO(e=Y(e,lx)),r=new C,t.asyncQueue.enqueueAndForget(async()=>oF(await lm(t),r)),r.promise}},417343,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e.r(336952),i=e.r(140952),s=e.r(771821),a=e.r(650043);e.r(848720),e.r(601402),e.r(301207);let o="@firebase/firestore",l="4.10.0";function u(e){if("object"!=typeof e||null===e)return!1;for(let t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}class c{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class h{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}_fieldsProto(){return new s.ObjectValue({mapValue:{fields:this._data}}).clone().value.mapValue.fields}}class d{constructor(e,t,r,n,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=n,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new s.DocumentReference(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){let e=new f(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){let t=this._document.data.field(s.__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class f extends d{data(){return super.data()}}function p(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new s.FirestoreError(s.C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class m{}class g extends m{}class y extends g{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new y(e,t,r)}_apply(e){let t=this._parse(e);return S(e._query,t),new s.Query(e.firestore,e.converter,s.__PRIVATE_queryWithAddedFilter(e._query,t))}_parse(e){let t=s.__PRIVATE_newUserDataReader(e.firestore);return function(e,t,r,n,i,a,o){let l;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new s.FirestoreError(s.C.INVALID_ARGUMENT,`Invalid Query. You can't perform '${a}' queries on documentId().`);if("in"===a||"not-in"===a){A(o,a);let t=[];for(let r of o)t.push(b(n,e,r));l={arrayValue:{values:t}}}else l=b(n,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||A(o,a),l=s.__PRIVATE_parseQueryValue(r,t,o,"in"===a||"not-in"===a);return s.FieldFilter.create(i,a,l)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class _ extends m{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new _(e,t)}_parse(e){let t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:s.CompositeFilter.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let r=e;for(let e of t.getFlattenedFilters())S(r,e),r=s.__PRIVATE_queryWithAddedFilter(r,e)}(e._query,t),new s.Query(e.firestore,e.converter,s.__PRIVATE_queryWithAddedFilter(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class v extends g{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new v(e,t)}_apply(e){let t=function(e,t,r){if(null!==e.startAt)throw new s.FirestoreError(s.C.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new s.FirestoreError(s.C.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new s.OrderBy(t,r)}(e._query,this._field,this._direction);return new s.Query(e.firestore,e.converter,s.__PRIVATE_queryWithAddedOrderBy(e._query,t))}}class w extends g{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new w(e,t,r)}_apply(e){return new s.Query(e.firestore,e.converter,s.__PRIVATE_queryWithLimit(e._query,this._limit,this._limitType))}}class I extends g{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new I(e,t,r)}_apply(e){let t=T(e,this.type,this._docOrFields,this._inclusive);return new s.Query(e.firestore,e.converter,s.__PRIVATE_queryWithStartAt(e._query,t))}}class E extends g{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new E(e,t,r)}_apply(e){let t=T(e,this.type,this._docOrFields,this._inclusive);return new s.Query(e.firestore,e.converter,s.__PRIVATE_queryWithEndAt(e._query,t))}}function T(e,t,r,n){if(r[0]=a.getModularInstance(r[0]),r[0]instanceof d)return function(e,t,r,n,i){if(!n)throw new s.FirestoreError(s.C.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${r}().`);let a=[];for(let r of s.__PRIVATE_queryNormalizedOrderBy(e))if(r.field.isKeyField())a.push(s.__PRIVATE_refValue(t,n.key));else{let e=n.data.field(r.field);if(s.__PRIVATE_isServerTimestamp(e))throw new s.FirestoreError(s.C.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+r.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){let e=r.field.canonicalString();throw new s.FirestoreError(s.C.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}a.push(e)}return new s.Bound(a,i)}(e._query,e.firestore._databaseId,t,r[0]._document,n);{let i=s.__PRIVATE_newUserDataReader(e.firestore);return function(e,t,r,n,i,a){let o=e.explicitOrderBy;if(i.length>o.length)throw new s.FirestoreError(s.C.INVALID_ARGUMENT,`Too many arguments provided to ${n}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let l=[];for(let a=0;a<i.length;a++){let u=i[a];if(o[a].field.isKeyField()){if("string"!=typeof u)throw new s.FirestoreError(s.C.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${n}(), but got a ${typeof u}`);if(!s.__PRIVATE_isCollectionGroupQuery(e)&&-1!==u.indexOf("/"))throw new s.FirestoreError(s.C.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${n}() must be a plain document ID, but '${u}' contains a slash.`);let r=e.path.child(s.ResourcePath.fromString(u));if(!s.DocumentKey.isDocumentKey(r))throw new s.FirestoreError(s.C.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${n}() must result in a valid document path, but '${r}' is not because it contains an odd number of segments.`);let i=new s.DocumentKey(r);l.push(s.__PRIVATE_refValue(t,i))}else{let e=s.__PRIVATE_parseQueryValue(r,n,u);l.push(e)}}return new s.Bound(l,a)}(e._query,e.firestore._databaseId,i,t,r,n)}}function b(e,t,r){if("string"==typeof(r=a.getModularInstance(r))){if(""===r)throw new s.FirestoreError(s.C.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!s.__PRIVATE_isCollectionGroupQuery(t)&&-1!==r.indexOf("/"))throw new s.FirestoreError(s.C.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);let n=t.path.child(s.ResourcePath.fromString(r));if(!s.DocumentKey.isDocumentKey(n))throw new s.FirestoreError(s.C.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return s.__PRIVATE_refValue(e,new s.DocumentKey(n))}if(r instanceof s.DocumentReference)return s.__PRIVATE_refValue(e,r._key);throw new s.FirestoreError(s.C.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${s.__PRIVATE_valueDescription(r)}.`)}function A(e,t){if(!Array.isArray(e)||0===e.length)throw new s.FirestoreError(s.C.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function S(e,t){let r=function(e,t){for(let r of e)for(let e of r.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==r)throw r===t.op?new s.FirestoreError(s.C.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new s.FirestoreError(s.C.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}function C(e,t){if(!(t instanceof y||t instanceof _))throw new s.FirestoreError(s.C.INVALID_ARGUMENT,`Function ${e}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}function R(e,t,r){return e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t}class P extends s.AbstractUserDataWriter{constructor(e){super(),this.firestore=e}convertBytes(e){return new s.Bytes(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new s.DocumentReference(this.firestore,null,t)}}function k(){return new c("count")}function N(e,t){let r=s.__PRIVATE_cast(e.firestore,s.Firestore),n=s.ensureFirestoreConfigured(r),i=s.__PRIVATE_mapToArray(t,(e,t)=>new s.__PRIVATE_AggregateImpl(t,e.aggregateType,e._internalFieldPath));return s.__PRIVATE_firestoreClientRunAggregateQuery(n,e._query,i).then(t=>new h(e,new s.__PRIVATE_ExpUserDataWriter(r),t))}class D{constructor(e){this.kind="memory",this._onlineComponentProvider=s.OnlineComponentProvider.provider,this._offlineComponentProvider=e?.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new s.__PRIVATE_LruGcMemoryOfflineComponentProvider(void 0)}}toJSON(){return{kind:this.kind}}}class x{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=F(void 0))._initialize(e),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class O{constructor(){this.kind="memoryEager",this._offlineComponentProvider=s.__PRIVATE_MemoryOfflineComponentProvider.provider}toJSON(){return{kind:this.kind}}}class L{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new s.__PRIVATE_LruGcMemoryOfflineComponentProvider(e)}}toJSON(){return{kind:this.kind}}}class M{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=s.OnlineComponentProvider.provider,this._offlineComponentProvider={build:t=>new s.__PRIVATE_IndexedDbOfflineComponentProvider(t,e?.cacheSizeBytes,this.forceOwnership)}}}class V{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=s.OnlineComponentProvider.provider,this._offlineComponentProvider={build:t=>new s.__PRIVATE_MultiTabOfflineComponentProvider(t,e?.cacheSizeBytes)}}}function F(e){return new M(e?.forceOwnership)}let U="NOT SUPPORTED";class q{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class B extends d{constructor(e,t,r,n,i,s){super(e,t,r,n,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new j(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(s.__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new s.FirestoreError(s.C.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=B._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()&&(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),this._firestore,this.ref.path,t.bundle="NOT SUPPORTED"),t}}B._jsonSchemaVersion="firestore/documentSnapshot/1.0",B._jsonSchema={type:s.property("string",B._jsonSchemaVersion),bundleSource:s.property("string","DocumentSnapshot"),bundleName:s.property("string"),bundle:s.property("string")};class j extends B{data(e={}){return super.data(e)}}class z{constructor(e,t,r,n){this._firestore=e,this._userDataWriter=t,this._snapshot=n,this.metadata=new q(n.hasPendingWrites,n.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new j(this._firestore,this._userDataWriter,r.key,r,new q(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new s.FirestoreError(s.C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(r=>{let n=new j(e._firestore,e._userDataWriter,r.doc.key,r.doc,new q(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter);return r.doc,{type:"added",doc:n,oldIndex:-1,newIndex:t++}})}{let r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{let n=new j(e._firestore,e._userDataWriter,t.doc.key,t.doc,new q(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:function(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return s.fail(61501,{type:e})}}(t.type),doc:n,oldIndex:i,newIndex:a}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new s.FirestoreError(s.C.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=z._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=s.__PRIVATE_AutoId.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],n=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),r.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),n.push(e.ref.path))}),this._firestore,this.query._query,e.bundleName,e.bundle="NOT SUPPORTED",e}}z._jsonSchemaVersion="firestore/querySnapshot/1.0",z._jsonSchema={type:s.property("string",z._jsonSchemaVersion),bundleSource:s.property("string","QuerySnapshot"),bundleName:s.property("string"),bundle:s.property("string")};let G={maxAttempts:5};class ${constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=s.__PRIVATE_newUserDataReader(e)}set(e,t,r){this._verifyNotCommitted();let n=H(e,this._firestore),i=R(n.converter,t,r),a=s.__PRIVATE_parseSetData(this._dataReader,"WriteBatch.set",n._key,i,null!==n.converter,r);return this._mutations.push(a.toMutation(n._key,s.Precondition.none())),this}update(e,t,r,...n){let i;this._verifyNotCommitted();let o=H(e,this._firestore);return i="string"==typeof(t=a.getModularInstance(t))||t instanceof s.FieldPath?s.__PRIVATE_parseUpdateVarargs(this._dataReader,"WriteBatch.update",o._key,t,r,n):s.__PRIVATE_parseUpdateData(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(i.toMutation(o._key,s.Precondition.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=H(e,this._firestore);return this._mutations=this._mutations.concat(new s.__PRIVATE_DeleteMutation(t._key,s.Precondition.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new s.FirestoreError(s.C.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function H(e,t){if((e=a.getModularInstance(e)).firestore!==t)throw new s.FirestoreError(s.C.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class K{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=s.__PRIVATE_newUserDataReader(e)}get(e){let t=H(e,this._firestore),r=new P(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return s.fail(24041);let n=e[0];if(n.isFoundDocument())return new d(this._firestore,r,n.key,n,t.converter);if(n.isNoDocument())return new d(this._firestore,r,t._key,null,t.converter);throw s.fail(18433,{doc:n})})}set(e,t,r){let n=H(e,this._firestore),i=R(n.converter,t,r),a=s.__PRIVATE_parseSetData(this._dataReader,"Transaction.set",n._key,i,null!==n.converter,r);return this._transaction.set(n._key,a),this}update(e,t,r,...n){let i,o=H(e,this._firestore);return i="string"==typeof(t=a.getModularInstance(t))||t instanceof s.FieldPath?s.__PRIVATE_parseUpdateVarargs(this._dataReader,"Transaction.update",o._key,t,r,n):s.__PRIVATE_parseUpdateData(this._dataReader,"Transaction.update",o._key,t),this._transaction.update(o._key,i),this}delete(e){let t=H(e,this._firestore);return this._transaction.delete(t._key),this}}class W extends K{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=H(e,this._firestore),r=new s.__PRIVATE_ExpUserDataWriter(this._firestore);return super.get(e).then(e=>new B(this._firestore,r,t._key,e._document,new q(!1,!1),t.converter))}}function Q(e,...t){let r,n,i;e=a.getModularInstance(e);let o={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof t[0]||u(t[l])||(o=t[l++]);let c={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(u(t[l])){let e=t[l];t[l]=e.next?.bind(e),t[l+1]=e.error?.bind(e),t[l+2]=e.complete?.bind(e)}if(e instanceof s.DocumentReference)n=s.__PRIVATE_cast(e.firestore,s.Firestore),i=s.__PRIVATE_newQueryForPath(e._key.path),r={next:r=>{t[l]&&t[l](Y(n,e,r))},error:t[l+1],complete:t[l+2]};else{let a=s.__PRIVATE_cast(e,s.Query);n=s.__PRIVATE_cast(a.firestore,s.Firestore),i=a._query;let o=new s.__PRIVATE_ExpUserDataWriter(n);r={next:e=>{t[l]&&t[l](new z(n,o,a,e))},error:t[l+1],complete:t[l+2]},p(e._query)}let h=s.ensureFirestoreConfigured(n);return s.__PRIVATE_firestoreClientListen(h,i,c,r)}function J(e,t){let r=s.ensureFirestoreConfigured(e);return s.__PRIVATE_firestoreClientWrite(r,t)}function Y(e,t,r){let n=r.docs.get(t._key),i=new s.__PRIVATE_ExpUserDataWriter(e);return new B(e,i,t._key,n,new q(r.hasPendingWrites,r.fromCache),t.converter)}function X(e,t){if("string"!=typeof e[t])throw new s.FirestoreError(s.C.INVALID_ARGUMENT,"Missing string value for: "+t);return e[t]}class Z{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function ee(e,t){let r=s.ensureFirestoreConfigured(e._firestore);s.__PRIVATE_firestoreClientSetPersistentCacheIndexAutoCreationEnabled(r,t).then(e=>s.__PRIVATE_logDebug(`setting persistent cache index auto creation isEnabled=${t} succeeded`)).catch(e=>s.__PRIVATE_logWarn(`setting persistent cache index auto creation isEnabled=${t} failed`,e))}let et=new WeakMap;class er{constructor(){this.i=new Map}static get instance(){return en||(en=new er,s.__PRIVATE_setTestingHooksSpi(en)),en}u(e){this.i.forEach(t=>t(e))}onExistenceFilterMismatch(e){let t=Symbol(),r=this.i;return r.set(t,e),()=>r.delete(t)}}let en=null;!function(e=!0){s.__PRIVATE_setSDKVersion(n.SDK_VERSION),n._registerComponent(new i.Component("firestore",(t,{instanceIdentifier:r,options:n})=>{let i=t.getProvider("app").getImmediate(),a=new s.Firestore(new s.__PRIVATE_FirebaseAuthCredentialsProvider(t.getProvider("auth-internal")),new s.__PRIVATE_FirebaseAppCheckTokenProvider(i,t.getProvider("app-check-internal")),s.__PRIVATE_databaseIdFromApp(i,r),i);return n={useFetchStreams:e,...n},a._setSettings(n),a},"PUBLIC").setMultipleInstances(!0)),n.registerVersion(o,l,void 0),n.registerVersion(o,l,"cjs2020")}(),r.AbstractUserDataWriter=s.AbstractUserDataWriter,r.Bytes=s.Bytes,r.CACHE_SIZE_UNLIMITED=s.on,r.CollectionReference=s.CollectionReference,r.DocumentReference=s.DocumentReference,r.FieldPath=s.FieldPath,r.FieldValue=s.FieldValue,r.Firestore=s.Firestore,r.FirestoreError=s.FirestoreError,r.GeoPoint=s.GeoPoint,r.LoadBundleTask=s.LoadBundleTask,r.Query=s.Query,r.Timestamp=s.Timestamp,r.VectorValue=s.VectorValue,r._AutoId=s.__PRIVATE_AutoId,r._ByteString=s.ByteString,r._DatabaseId=s.DatabaseId,r._DocumentKey=s.DocumentKey,r._EmptyAppCheckTokenProvider=s.__PRIVATE_EmptyAppCheckTokenProvider,r._EmptyAuthCredentialsProvider=s.__PRIVATE_EmptyAuthCredentialsProvider,r._FieldPath=s.FieldPath$1,r._cast=s.__PRIVATE_cast,r._debugAssert=s.__PRIVATE_debugAssert,r._internalAggregationQueryToProtoRunAggregationQueryRequest=s._internalAggregationQueryToProtoRunAggregationQueryRequest,r._internalQueryToProtoQueryTarget=s._internalQueryToProtoQueryTarget,r._isBase64Available=s.__PRIVATE_isBase64Available,r._logWarn=s.__PRIVATE_logWarn,r._validateIsNotUsedTogether=s.__PRIVATE_validateIsNotUsedTogether,r.arrayRemove=s.arrayRemove,r.arrayUnion=s.arrayUnion,r.clearIndexedDbPersistence=s.clearIndexedDbPersistence,r.collection=s.collection,r.collectionGroup=s.collectionGroup,r.connectFirestoreEmulator=s.connectFirestoreEmulator,r.deleteField=s.deleteField,r.disableNetwork=s.disableNetwork,r.doc=s.doc,r.documentId=s.documentId,r.enableIndexedDbPersistence=s.enableIndexedDbPersistence,r.enableMultiTabIndexedDbPersistence=s.enableMultiTabIndexedDbPersistence,r.enableNetwork=s.enableNetwork,r.ensureFirestoreConfigured=s.ensureFirestoreConfigured,r.getFirestore=s.getFirestore,r.increment=s.increment,r.initializeFirestore=s.initializeFirestore,r.loadBundle=s.loadBundle,r.namedQuery=s.namedQuery,r.queryEqual=s.queryEqual,r.refEqual=s.refEqual,r.serverTimestamp=s.serverTimestamp,r.setLogLevel=s.setLogLevel,r.terminate=s.terminate,r.vector=s.vector,r.waitForPendingWrites=s.waitForPendingWrites,r.AggregateField=c,r.AggregateQuerySnapshot=h,r.DocumentSnapshot=B,r.PersistentCacheIndexManager=Z,r.QueryCompositeFilterConstraint=_,r.QueryConstraint=g,r.QueryDocumentSnapshot=j,r.QueryEndAtConstraint=E,r.QueryFieldFilterConstraint=y,r.QueryLimitConstraint=w,r.QueryOrderByConstraint=v,r.QuerySnapshot=z,r.QueryStartAtConstraint=I,r.SnapshotMetadata=q,r.Transaction=W,r.WriteBatch=$,r._TestingHooks=class{constructor(){throw Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return er.instance.onExistenceFilterMismatch(e)}},r.addDoc=function(e,t){let r=s.__PRIVATE_cast(e.firestore,s.Firestore),n=s.doc(e),i=R(e.converter,t),a=s.__PRIVATE_newUserDataReader(e.firestore);return J(r,[s.__PRIVATE_parseSetData(a,"addDoc",n._key,i,null!==e.converter,{}).toMutation(n._key,s.Precondition.exists(!1))]).then(()=>n)},r.aggregateFieldEqual=function(e,t){return e instanceof c&&t instanceof c&&e.aggregateType===t.aggregateType&&e._internalFieldPath?.canonicalString()===t._internalFieldPath?.canonicalString()},r.aggregateQuerySnapshotEqual=function(e,t){return s.queryEqual(e.query,t.query)&&a.deepEqual(e.data(),t.data())},r.and=function(...e){return e.forEach(e=>C("and",e)),_._create("and",e)},r.average=function(e){return new c("avg",s.__PRIVATE_fieldPathFromArgument("average",e))},r.count=k,r.deleteAllPersistentCacheIndexes=function(e){let t=s.ensureFirestoreConfigured(e._firestore);s.__PRIVATE_firestoreClientDeleteAllFieldIndexes(t).then(e=>s.__PRIVATE_logDebug("deleting all persistent cache indexes succeeded")).catch(e=>s.__PRIVATE_logWarn("deleting all persistent cache indexes failed",e))},r.deleteDoc=function(e){return J(s.__PRIVATE_cast(e.firestore,s.Firestore),[new s.__PRIVATE_DeleteMutation(e._key,s.Precondition.none())])},r.disablePersistentCacheIndexAutoCreation=function(e){ee(e,!1)},r.documentSnapshotFromJSON=function(e,t,r){if(s.__PRIVATE_validateJSON(t,B._jsonSchema)){if(t.bundle===U)throw new s.FirestoreError(s.C.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");let n=s.__PRIVATE_newSerializer(e._databaseId),i=s.__PRIVATE_createBundleReaderSync(t.bundle,n),a=i.t(),o=new s.__PRIVATE_BundleLoader(i.getMetadata(),n);for(let e of a)o.o(e);let l=o.documents;if(1!==l.length)throw new s.FirestoreError(s.C.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${l.length} documents.`);let u=s.__PRIVATE_fromDocument(n,l[0].document),c=new s.DocumentKey(s.ResourcePath.fromString(t.bundleName));return new B(e,new P(e),c,u,new q(!1,!1),r||null)}},r.enablePersistentCacheIndexAutoCreation=function(e){ee(e,!0)},r.endAt=function(...e){return E._create("endAt",e,!0)},r.endBefore=function(...e){return E._create("endBefore",e,!1)},r.executeWrite=J,r.getAggregateFromServer=N,r.getCountFromServer=function(e){return N(e,{count:k()})},r.getDoc=function(e){e=s.__PRIVATE_cast(e,s.DocumentReference);let t=s.__PRIVATE_cast(e.firestore,s.Firestore),r=s.ensureFirestoreConfigured(t);return s.__PRIVATE_firestoreClientGetDocumentViaSnapshotListener(r,e._key).then(r=>Y(t,e,r))},r.getDocFromCache=function(e){e=s.__PRIVATE_cast(e,s.DocumentReference);let t=s.__PRIVATE_cast(e.firestore,s.Firestore),r=s.ensureFirestoreConfigured(t),n=new s.__PRIVATE_ExpUserDataWriter(t);return s.__PRIVATE_firestoreClientGetDocumentFromLocalCache(r,e._key).then(r=>new B(t,n,e._key,r,new q(null!==r&&r.hasLocalMutations,!0),e.converter))},r.getDocFromServer=function(e){e=s.__PRIVATE_cast(e,s.DocumentReference);let t=s.__PRIVATE_cast(e.firestore,s.Firestore),r=s.ensureFirestoreConfigured(t);return s.__PRIVATE_firestoreClientGetDocumentViaSnapshotListener(r,e._key,{source:"server"}).then(r=>Y(t,e,r))},r.getDocs=function(e){e=s.__PRIVATE_cast(e,s.Query);let t=s.__PRIVATE_cast(e.firestore,s.Firestore),r=s.ensureFirestoreConfigured(t),n=new s.__PRIVATE_ExpUserDataWriter(t);return p(e._query),s.__PRIVATE_firestoreClientGetDocumentsViaSnapshotListener(r,e._query).then(r=>new z(t,n,e,r))},r.getDocsFromCache=function(e){e=s.__PRIVATE_cast(e,s.Query);let t=s.__PRIVATE_cast(e.firestore,s.Firestore),r=s.ensureFirestoreConfigured(t),n=new s.__PRIVATE_ExpUserDataWriter(t);return s.__PRIVATE_firestoreClientGetDocumentsFromLocalCache(r,e._query).then(r=>new z(t,n,e,r))},r.getDocsFromServer=function(e){e=s.__PRIVATE_cast(e,s.Query);let t=s.__PRIVATE_cast(e.firestore,s.Firestore),r=s.ensureFirestoreConfigured(t),n=new s.__PRIVATE_ExpUserDataWriter(t);return s.__PRIVATE_firestoreClientGetDocumentsViaSnapshotListener(r,e._query,{source:"server"}).then(r=>new z(t,n,e,r))},r.getPersistentCacheIndexManager=function(e){e=s.__PRIVATE_cast(e,s.Firestore);let t=et.get(e);if(t)return t;let r=s.ensureFirestoreConfigured(e);if("persistent"!==r._uninitializedComponentsProvider?._offline.kind)return null;let n=new Z(e);return et.set(e,n),n},r.limit=function(e){return s.__PRIVATE_validatePositiveNumber("limit",e),w._create("limit",e,"F")},r.limitToLast=function(e){return s.__PRIVATE_validatePositiveNumber("limitToLast",e),w._create("limitToLast",e,"L")},r.memoryEagerGarbageCollector=function(){return new O},r.memoryLocalCache=function(e){return new D(e)},r.memoryLruGarbageCollector=function(e){return new L(e?.cacheSizeBytes)},r.onSnapshot=Q,r.onSnapshotResume=function(e,t,...r){var n,i,o,l,c,h;let d=a.getModularInstance(e),f=function(e){let t={bundle:"",bundleName:"",bundleSource:""};for(let r of["bundle","bundleName","bundleSource"]){if(!(r in e)){t.error=`snapshotJson missing required field: ${r}`;break}let n=e[r];if("string"!=typeof n){t.error=`snapshotJson field '${r}' must be a string.`;break}if(0===n.length){t.error=`snapshotJson field '${r}' cannot be an empty string.`;break}"bundle"===r?t.bundle=n:"bundleName"===r?t.bundleName=n:"bundleSource"===r&&(t.bundleSource=n)}return t}(t);if(f.error)throw new s.FirestoreError(s.C.INVALID_ARGUMENT,f.error);let p,m=0;if("object"!=typeof r[0]||u(r[m])||(p=r[m++]),"QuerySnapshot"===f.bundleSource){let e,t,a=null;if("object"==typeof r[m]&&u(r[m])){let e=r[m++];a={next:e.next,error:e.error,complete:e.complete}}else a={next:r[m++],error:r[m++],complete:r[m++]};return n=p,i=a,o=r[m],t=!1,s.loadBundle(d,f.bundle).then(()=>s.namedQuery(d,f.bundleName)).then(r=>{r&&!t&&(o&&r.withConverter(o),e=Q(r,n||{},i))}).catch(e=>(i.error&&i.error(e),()=>{})),()=>{t||(t=!0,e&&e())}}if("DocumentSnapshot"===f.bundleSource){let e,t,n=null;if("object"==typeof r[m]&&u(r[m])){let e=r[m++];n={next:e.next,error:e.error,complete:e.complete}}else n={next:r[m++],error:r[m++],complete:r[m++]};return l=p,c=n,h=r[m],t=!1,s.loadBundle(d,f.bundle).then(()=>{t||(e=Q(new s.DocumentReference(d,h||null,s.DocumentKey.fromPath(f.bundleName)),l||{},c))}).catch(e=>(c.error&&c.error(e),()=>{})),()=>{t||(t=!0,e&&e())}}throw new s.FirestoreError(s.C.INVALID_ARGUMENT,`unsupported bundle source: ${f.bundleSource}`)},r.onSnapshotsInSync=function(e,t){e=s.__PRIVATE_cast(e,s.Firestore);let r=s.ensureFirestoreConfigured(e),n=u(t)?t:{next:t};return s.__PRIVATE_firestoreClientAddSnapshotsInSyncListener(r,n)},r.or=function(...e){return e.forEach(e=>C("or",e)),_._create("or",e)},r.orderBy=function(e,t="asc"){let r=s.__PRIVATE_fieldPathFromArgument("orderBy",e);return v._create(r,t)},r.persistentLocalCache=function(e){return new x(e)},r.persistentMultipleTabManager=function(){return new V},r.persistentSingleTabManager=F,r.query=function(e,t,...r){let n=[];for(let i of(t instanceof m&&n.push(t),function(e){let t=e.filter(e=>e instanceof _).length,r=e.filter(e=>e instanceof y).length;if(t>1||t>0&&r>0)throw new s.FirestoreError(s.C.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n=n.concat(r)),n))e=i._apply(e);return e},r.querySnapshotFromJSON=function(e,t,r){if(s.__PRIVATE_validateJSON(t,z._jsonSchema)){if(t.bundle===U)throw new s.FirestoreError(s.C.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");let n=s.__PRIVATE_newSerializer(e._databaseId),i=s.__PRIVATE_createBundleReaderSync(t.bundle,n),a=i.t(),o=new s.__PRIVATE_BundleLoader(i.getMetadata(),n);for(let e of a)o.o(e);if(1!==o.queries.length)throw new s.FirestoreError(s.C.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${o.queries.length} queries.`);let l=s.__PRIVATE_fromBundledQuery(o.queries[0].bundledQuery),u=o.documents,c=new s.DocumentSet;u.map(e=>{let t=s.__PRIVATE_fromDocument(n,e.document);c=c.add(t)});let h=s.ViewSnapshot.fromInitialDocuments(l,c,s.__PRIVATE_documentKeySet(),!1,!1),d=new s.Query(e,r||null,l);return new z(e,new P(e),d,h)}},r.runTransaction=function(e,t,r){e=s.__PRIVATE_cast(e,s.Firestore);let n={...G,...r};if(n.maxAttempts<1)throw new s.FirestoreError(s.C.INVALID_ARGUMENT,"Max attempts must be at least 1");let i=s.ensureFirestoreConfigured(e);return s.__PRIVATE_firestoreClientTransaction(i,r=>t(new W(e,r)),n)},r.setDoc=function(e,t,r){e=s.__PRIVATE_cast(e,s.DocumentReference);let n=s.__PRIVATE_cast(e.firestore,s.Firestore),i=R(e.converter,t,r),a=s.__PRIVATE_newUserDataReader(n);return J(n,[s.__PRIVATE_parseSetData(a,"setDoc",e._key,i,null!==e.converter,r).toMutation(e._key,s.Precondition.none())])},r.setIndexConfiguration=function(e,t){e=s.__PRIVATE_cast(e,s.Firestore);let r=s.ensureFirestoreConfigured(e);if(!r._uninitializedComponentsProvider||"memory"===r._uninitializedComponentsProvider._offline.kind)return s.__PRIVATE_logWarn("Cannot enable indexes when persistence is disabled"),Promise.resolve();let n=function(e){let t="string"==typeof e?function(e){try{return JSON.parse(e)}catch(e){throw new s.FirestoreError(s.C.INVALID_ARGUMENT,"Failed to parse JSON: "+e?.message)}}(e):e,r=[];if(Array.isArray(t.indexes))for(let e of t.indexes){let t=X(e,"collectionGroup"),n=[];if(Array.isArray(e.fields))for(let t of e.fields){let e=X(t,"fieldPath"),r=s.__PRIVATE_fieldPathFromDotSeparatedString("setIndexConfiguration",e);"CONTAINS"===t.arrayConfig?n.push(new s.IndexSegment(r,2)):"ASCENDING"===t.order?n.push(new s.IndexSegment(r,0)):"DESCENDING"===t.order&&n.push(new s.IndexSegment(r,1))}r.push(new s.FieldIndex(s.FieldIndex.UNKNOWN_ID,t,n,s.IndexState.empty()))}return r}(t);return s.__PRIVATE_firestoreClientSetIndexConfiguration(r,n)},r.snapshotEqual=function(e,t){return e instanceof B&&t instanceof B?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof z&&t instanceof z&&e._firestore===t._firestore&&s.queryEqual(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)},r.startAfter=function(...e){return I._create("startAfter",e,!1)},r.startAt=function(...e){return I._create("startAt",e,!0)},r.sum=function(e){return new c("sum",s.__PRIVATE_fieldPathFromArgument("sum",e))},r.updateDoc=function(e,t,r,...n){e=s.__PRIVATE_cast(e,s.DocumentReference);let i=s.__PRIVATE_cast(e.firestore,s.Firestore),o=s.__PRIVATE_newUserDataReader(i);return J(i,[("string"==typeof(t=a.getModularInstance(t))||t instanceof s.FieldPath?s.__PRIVATE_parseUpdateVarargs(o,"updateDoc",e._key,t,r,n):s.__PRIVATE_parseUpdateData(o,"updateDoc",e._key,t)).toMutation(e._key,s.Precondition.exists(!0))])},r.where=function(e,t,r){let n=s.__PRIVATE_fieldPathFromArgument("where",e);return y._create(n,t,r)},r.writeBatch=function(e){return e=s.__PRIVATE_cast(e,s.Firestore),s.ensureFirestoreConfigured(e),new $(e,t=>J(e,t))}},14756,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e.r(417343);Object.keys(n).forEach(function(e){"default"===e||r.hasOwnProperty(e)||Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}})})},4157,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,i,s,a=e.r(336952),o=e.r(650043),l=e.r(140952);let u="firebasestorage.googleapis.com",c="storageBucket";class h extends o.FirebaseError{constructor(e,t,r=0){super(d(e),`Firebase Storage: ${t} (${d(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,h.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return d(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function d(e){return"storage/"+e}function f(){return new h(r.StorageErrorCode.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function p(){return new h(r.StorageErrorCode.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function m(){return new h(r.StorageErrorCode.CANCELED,"User canceled the upload/download.")}function g(){return new h(r.StorageErrorCode.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function y(e){return new h(r.StorageErrorCode.INVALID_ARGUMENT,e)}function _(){return new h(r.StorageErrorCode.APP_DELETED,"The Firebase app was deleted.")}function v(e){return new h(r.StorageErrorCode.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function w(e,t){return new h(r.StorageErrorCode.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function I(e){throw new h(r.StorageErrorCode.INTERNAL_ERROR,"Internal error: "+e)}r.StorageErrorCode=void 0,(n=r.StorageErrorCode||(r.StorageErrorCode={})).UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment";class E{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=E.makeFromUrl(e,t)}catch(t){return new E(e,"")}if(""===n.path)return n;throw new h(r.StorageErrorCode.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}static makeFromUrl(e,t){let n=null,i="([A-Za-z0-9.\\-_]+)",s=RegExp("^gs://"+i+"(/(.*))?$","i");function a(e){e.path_=decodeURIComponent(e.path)}let o=t.replace(/[.]/g,"\\."),l=RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),c=t===u?"(?:storage.googleapis.com|storage.cloud.google.com)":t,d=[{regex:s,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:l,indices:{bucket:1,path:3},postModify:a},{regex:RegExp(`^https?://${c}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:a}];for(let t=0;t<d.length;t++){let r=d[t],i=r.regex.exec(e);if(i){let e=i[r.indices.bucket],t=i[r.indices.path];t||(t=""),n=new E(e,t),r.postModify(n);break}}if(null==n)throw new h(r.StorageErrorCode.INVALID_URL,"Invalid URL '"+e+"'.");return n}}class T{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function b(e){return"string"==typeof e||e instanceof String}function A(e){return S()&&e instanceof Blob}function S(){return"undefined"!=typeof Blob}function C(e,t,r,n){if(n<t)throw y(`Invalid value for '${e}'. Expected ${t} or greater.`);if(n>r)throw y(`Invalid value for '${e}'. Expected ${r} or less.`)}function R(e,t,r){let n=t;return null==r&&(n=`https://${t}`),`${r}://${n}/v0${e}`}function P(e){let t=encodeURIComponent,r="?";for(let n in e)e.hasOwnProperty(n)&&(r=r+(t(n)+"=")+t(e[n])+"&");return r.slice(0,-1)}function k(e,t){let r=e>=500&&e<600,n=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return r||n||i}(i=s||(s={}))[i.NO_ERROR=0]="NO_ERROR",i[i.NETWORK_ERROR=1]="NETWORK_ERROR",i[i.ABORT=2]="ABORT";class N{constructor(e,t,r,n,i,s,a,o,l,u,c,h=!0,d=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=n,this.successCodes_=i,this.additionalRetryCodes_=s,this.callback_=a,this.errorCallback_=o,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=c,this.retry=h,this.isUsingEmulator=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){let e=(e,t)=>{if(t)return void e(!1,new D(!1,null,!0));let r=this.connectionFactory_();this.pendingConnection_=r;let n=e=>{let t=e.loaded,r=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,r)};null!==this.progressCallback_&&r.addUploadProgressListener(n),r.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&r.removeUploadProgressListener(n),this.pendingConnection_=null;let t=r.getErrorCode()===s.NO_ERROR,i=r.getStatus();!t||k(i,this.additionalRetryCodes_)&&this.retry?e(!1,new D(!1,null,r.getErrorCode()===s.ABORT)):e(!0,new D(-1!==this.successCodes_.indexOf(i),r))})},t=(e,t)=>{let r=this.resolve_,n=this.reject_,i=t.connection;if(t.wasSuccessCode)try{let e=this.callback_(i,i.getResponse());void 0!==e?r(e):r()}catch(e){n(e)}else if(null!==i){let e=f();e.serverResponse=i.getErrorText(),n(this.errorCallback_?this.errorCallback_(i,e):e)}else n(t.canceled?this.appDelete_?_():m():p())};this.canceled_?t(!1,new D(!1,null,!0)):this.backoffId_=function(e,t,r){let n=1,i=null,s=null,a=!1,o=0,l=!1;function u(...e){l||(l=!0,t.apply(null,e))}function c(t){i=setTimeout(()=>{i=null,e(d,2===o)},t)}function h(){s&&clearTimeout(s)}function d(e,...t){let r;if(l)return void h();if(e||2===o||a){h(),u.call(null,e,...t);return}n<64&&(n*=2),1===o?(o=2,r=0):r=(n+Math.random())*1e3,c(r)}let f=!1;function p(e){f||(f=!0,h(),!l&&(null!==i?(e||(o=2),clearTimeout(i),c(0)):e||(o=1)))}return c(0),s=setTimeout(()=>{a=!0,p(!0)},r),p}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class D{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function x(...e){let t="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==t){let r=new t;for(let t=0;t<e.length;t++)r.append(e[t]);return r.getBlob()}if(S())return new Blob(e);throw new h(r.StorageErrorCode.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}let O={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class L{constructor(e,t){this.data=e,this.contentType=t||null}}function M(e,t){switch(e){case O.RAW:return new L(V(t));case O.BASE64:case O.BASE64URL:return new L(F(e,t));case O.DATA_URL:return new L(function(e){let t,r=new U(e);if(r.base64)return F(O.BASE64,r.rest);var n=r.rest;try{t=decodeURIComponent(n)}catch(e){throw w(O.DATA_URL,"Malformed data URL.")}return V(t)}(t),new U(t).contentType)}throw f()}function V(e){let t=[];for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);n<=127?t.push(n):n<=2047?t.push(192|n>>6,128|63&n):(64512&n)==55296?r<e.length-1&&(64512&e.charCodeAt(r+1))==56320?(n=65536|(1023&n)<<10|1023&e.charCodeAt(++r),t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n)):t.push(239,191,189):(64512&n)==56320?t.push(239,191,189):t.push(224|n>>12,128|n>>6&63,128|63&n)}return new Uint8Array(t)}function F(e,t){let n;switch(e){case O.BASE64:{let r=-1!==t.indexOf("-"),n=-1!==t.indexOf("_");if(r||n)throw w(e,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case O.BASE64URL:{let r=-1!==t.indexOf("+"),n=-1!==t.indexOf("/");if(r||n)throw w(e,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/")}}try{n=function(e){if("undefined"==typeof atob)throw new h(r.StorageErrorCode.UNSUPPORTED_ENVIRONMENT,"base-64 is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.");return atob(e)}(t)}catch(t){if(t.message.includes("polyfill"))throw t;throw w(e,"Invalid character found")}let i=new Uint8Array(n.length);for(let e=0;e<n.length;e++)i[e]=n.charCodeAt(e);return i}class U{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw w(O.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;null!=r&&(this.base64=function(e,t){return e.length>=t.length&&e.substring(e.length-t.length)===t}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class q{constructor(e,t){let r=0,n="";A(e)?(this.data_=e,r=e.size,n=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=n}size(){return this.size_}type(){return this.type_}slice(e,t){if(!A(this.data_))return new q(new Uint8Array(this.data_.buffer,e,t-e),!0);{var r,n,i;let s=(r=this.data_,n=e,i=t,r.webkitSlice?r.webkitSlice(n,i):r.mozSlice?r.mozSlice(n,i):r.slice?r.slice(n,i):null);return null===s?null:new q(s)}}static getBlob(...e){if(S()){let t=e.map(e=>e instanceof q?e.data_:e);return new q(x.apply(null,t))}{let t=e.map(e=>b(e)?M(O.RAW,e).data:e.data_),r=0;t.forEach(e=>{r+=e.byteLength});let n=new Uint8Array(r),i=0;return t.forEach(e=>{for(let t=0;t<e.length;t++)n[i++]=e[t]}),new q(n,!0)}}uploadData(){return this.data_}}function B(e){var t;let r;try{r=JSON.parse(e)}catch(e){return null}return"object"!=typeof(t=r)||Array.isArray(t)?null:r}function j(e){let t=e.lastIndexOf("/",e.length-2);return -1===t?e:e.slice(t+1)}function z(e,t){return t}class G{constructor(e,t,r,n){this.server=e,this.local=t||e,this.writable=!!r,this.xform=n||z}}let $=null;function H(){if($)return $;let e=[];e.push(new G("bucket")),e.push(new G("generation")),e.push(new G("metageneration")),e.push(new G("name","fullPath",!0));let t=new G("name");t.xform=function(e,t){return!b(t)||t.length<2?t:j(t)},e.push(t);let r=new G("size");return r.xform=function(e,t){return void 0!==t?Number(t):t},e.push(r),e.push(new G("timeCreated")),e.push(new G("updated")),e.push(new G("md5Hash",null,!0)),e.push(new G("cacheControl",null,!0)),e.push(new G("contentDisposition",null,!0)),e.push(new G("contentEncoding",null,!0)),e.push(new G("contentLanguage",null,!0)),e.push(new G("contentType",null,!0)),e.push(new G("metadata","customMetadata",!0)),$=e}function K(e,t,r){let n=B(t);return null===n?null:function(e,t,r){let n={};n.type="file";let i=r.length;for(let e=0;e<i;e++){let i=r[e];n[i.local]=i.xform(n,t[i.server])}return Object.defineProperty(n,"ref",{get:function(){let t=new E(n.bucket,n.fullPath);return e._makeStorageReference(t)}}),n}(e,n,r)}function W(e,t){let r={},n=t.length;for(let i=0;i<n;i++){let n=t[i];n.writable&&(r[n.server]=e[n.local])}return JSON.stringify(r)}let Q="prefixes",J="items";class Y{constructor(e,t,r,n){this.url=e,this.method=t,this.handler=r,this.timeout=n,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function X(e){if(!e)throw f()}function Z(e,t){return function(r,n){let i=K(e,n,t);return X(null!==i),i}}function ee(e){return function(t,n){var i,s;let a;return 401===t.getStatus()?a=t.getErrorText().includes("Firebase App Check token is invalid")?new h(r.StorageErrorCode.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new h(r.StorageErrorCode.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(i=e.bucket,a=new h(r.StorageErrorCode.QUOTA_EXCEEDED,"Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(s=e.path,a=new h(r.StorageErrorCode.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")):a=n,a.status=t.getStatus(),a.serverResponse=n.serverResponse,a}}function et(e){let t=ee(e);return function(n,i){var s;let a=t(n,i);return 404===n.getStatus()&&(s=e.path,a=new h(r.StorageErrorCode.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")),a.serverResponse=i.serverResponse,a}}function er(e,t,r){let n=R(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,s=new Y(n,"GET",Z(e,r),i);return s.errorHandler=et(t),s}function en(e,t,r){let n=new Y(R(t.fullServerUrl(),e.host,e._protocol)+"?alt=media","GET",(e,t)=>t,e.maxOperationRetryTime);return n.errorHandler=et(t),void 0!==r&&(n.headers.Range=`bytes=0-${r}`,n.successCodes=[200,206]),n}function ei(e,t,r){let n=Object.assign({},r);return n.fullPath=e.path,n.size=t.size(),n.contentType||(n.contentType=t&&t.type()||"application/octet-stream"),n}function es(e,t,r,n,i){let s=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},o=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();a["Content-Type"]="multipart/related; boundary="+o;let l=ei(t,n,i),u="--"+o+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+W(l,r)+"\r\n--"+o+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",c=q.getBlob(u,n,"\r\n--"+o+"--");if(null===c)throw g();let h={name:l.fullPath},d=R(s,e.host,e._protocol),f=e.maxUploadRetryTime,p=new Y(d,"POST",Z(e,r),f);return p.urlParams=h,p.headers=a,p.body=c.uploadData(),p.errorHandler=ee(t),p}class ea{constructor(e,t,r,n){this.current=e,this.total=t,this.finalized=!!r,this.metadata=n||null}}function eo(e,t){let r=null;try{r=e.getResponseHeader("X-Goog-Upload-Status")}catch(e){X(!1)}return X(!!r&&-1!==(t||["active"]).indexOf(r)),r}let el={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function eu(e){switch(e){case"running":case"pausing":case"canceling":return el.RUNNING;case"paused":return el.PAUSED;case"success":return el.SUCCESS;case"canceled":return el.CANCELED;default:return el.ERROR}}class ec{constructor(e,t,r){"function"==typeof e||null!=t||null!=r?(this.next=e,this.error=t??void 0,this.complete=r??void 0):(this.next=e.next,this.error=e.error,this.complete=e.complete)}}function eh(e){return(...t)=>{Promise.resolve().then(()=>e(...t))}}class ed{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=s.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=s.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=s.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,n,i){if(this.sent_)throw I("cannot .send() more than once");if(o.isCloudWorkstation(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(let e in i)i.hasOwnProperty(e)&&this.xhr_.setRequestHeader(e,i[e].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw I("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw I("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return -1}}getResponse(){if(!this.sent_)throw I("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw I("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class ef extends ed{initXhr(){this.xhr_.responseType="text"}}function ep(){return new ef}class em extends ed{initXhr(){this.xhr_.responseType="arraybuffer"}}function eg(){return new em}class ey extends ed{initXhr(){this.xhr_.responseType="blob"}}function e_(){return new ey}class ev{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,t,n=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=H(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=e=>{if(this._request=void 0,this._chunkMultiplier=1,e._codeEquals(r.StorageErrorCode.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let t=this.isExponentialBackoffExpired();if(k(e.status,[]))if(t)e=p();else{this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=e,this._transition("error")}},this._metadataErrorHandler=e=>{this._request=void 0,e._codeEquals(r.StorageErrorCode.CANCELED)?this.completeTransitions_():(this._error=e,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((e,t)=>{this._resolve=e,this._reject=t,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){let e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"!==this._state||void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{var r,n,i,s,a;let o,l,u,c,h,d,f,p=(r=this._ref.storage,n=this._ref._location,i=this._mappings,s=this._blob,a=this._metadata,o=n.bucketOnlyServerUrl(),u={name:(l=ei(n,s,a)).fullPath},c=R(o,r.host,r._protocol),h={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${s.size()}`,"X-Goog-Upload-Header-Content-Type":l.contentType,"Content-Type":"application/json; charset=utf-8"},d=W(l,i),(f=new Y(c,"POST",function(e){let t;eo(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(e){X(!1)}return X(b(t)),t},r.maxUploadRetryTime)).urlParams=u,f.headers=h,f.body=d,f.errorHandler=ee(n),f),m=this._ref.storage._makeRequest(p,ep,e,t);this._request=m,m.getPromise().then(e=>{this._request=void 0,this._uploadUrl=e,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((t,r)=>{var n,i,s;let a,o=(n=this._ref.storage,i=this._ref._location,s=this._blob,(a=new Y(e,"POST",function(e){let t=eo(e,["active","final"]),r=null;try{r=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){X(!1)}r||X(!1);let n=Number(r);return X(!isNaN(n)),new ea(n,s.size(),"final"===t)},n.maxUploadRetryTime)).headers={"X-Goog-Upload-Command":"query"},a.errorHandler=ee(i),a),l=this._ref.storage._makeRequest(o,ep,t,r);this._request=l,l.getPromise().then(e=>{this._request=void 0,this._updateProgress(e.current),this._needToFetchStatus=!1,e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=262144*this._chunkMultiplier,t=new ea(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken((i,s)=>{let a;try{a=function(e,t,n,i,s,a,o,l){let u=new ea(0,0);if(o?(u.current=o.current,u.total=o.total):(u.current=0,u.total=i.size()),i.size()!==u.total)throw new h(r.StorageErrorCode.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");let c=u.total-u.current,d=c;s>0&&(d=Math.min(d,s));let f=u.current,p=f+d,m={"X-Goog-Upload-Command":0===d?"finalize":c===d?"upload, finalize":"upload","X-Goog-Upload-Offset":`${u.current}`},y=i.slice(f,p);if(null===y)throw g();let _=new Y(n,"POST",function(e,r){let n,s=eo(e,["active","final"]),o=u.current+d,l=i.size();return n="final"===s?Z(t,a)(e,r):null,new ea(o,l,"final"===s,n)},t.maxUploadRetryTime);return _.headers=m,_.body=y.uploadData(),_.progressCallback=l||null,_.errorHandler=ee(e),_}(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(e){this._error=e,this._transition("error");return}let o=this._ref.storage._makeRequest(a,ep,i,s,!1);this._request=o,o.getPromise().then(e=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(e.current),e.finalized?(this._metadata=e.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){2*(262144*this._chunkMultiplier)<0x2000000&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{let r=er(this._ref.storage,this._ref._location,this._mappings),n=this._ref.storage._makeRequest(r,ep,e,t);this._request=n,n.getPromise().then(e=>{this._request=void 0,this._metadata=e,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{let r=es(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),n=this._ref.storage._makeRequest(r,ep,e,t);this._request=n,n.getPromise().then(e=>{this._request=void 0,this._metadata=e,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=m(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){let e=eu(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,n){let i=new ec(t||void 0,r||void 0,n||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(e=>{this._notifyObserver(e)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(eu(this._state)){case el.SUCCESS:eh(this._resolve.bind(null,this.snapshot))();break;case el.CANCELED:case el.ERROR:eh(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(eu(this._state)){case el.RUNNING:case el.PAUSED:e.next&&eh(e.next.bind(e,this.snapshot))();break;case el.SUCCESS:e.complete&&eh(e.complete.bind(e))();break;case el.CANCELED:case el.ERROR:default:e.error&&eh(e.error.bind(e,this._error))()}}resume(){let e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){let e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){let e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class ew{constructor(e,t){this._service=e,t instanceof E?this._location=t:this._location=E.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new ew(e,t)}get root(){let e=new E(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return j(this._location.path)}get storage(){return this._service}get parent(){let e=function(e){if(0===e.length)return null;let t=e.lastIndexOf("/");return -1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;let t=new E(this._location.bucket,e);return new ew(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw v(e)}}function eI(e,t,r){e._throwIfRoot("uploadBytes");let n=es(e.storage,e._location,H(),new q(t,!0),r);return e.storage.makeRequestWithTokens(n,ep).then(t=>({metadata:t,ref:e}))}async function eE(e,t,r){let n=await eT(e,{pageToken:r});t.prefixes.push(...n.prefixes),t.items.push(...n.items),null!=n.nextPageToken&&await eE(e,t,n.nextPageToken)}function eT(e,t){var r,n,i,s,a;let o,l,u,c;null!=t&&"number"==typeof t.maxResults&&C("options.maxResults",1,1e3,t.maxResults);let h=t||{},d=(r=e.storage,n=e._location,i=h.pageToken,s=h.maxResults,o={},n.isRoot?o.prefix="":o.prefix=n.path+"/",o.delimiter="/",i&&(o.pageToken=i),s&&(o.maxResults=s),l=R(n.bucketOnlyServerUrl(),r.host,r._protocol),u=r.maxOperationRetryTime,(c=new Y(l,"GET",(a=n.bucket,function(e,t){let n=function(e,t,r){let n=B(r);if(null===n)return null;let i={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[Q])for(let r of n[Q]){let n=r.replace(/\/$/,""),s=e._makeStorageReference(new E(t,n));i.prefixes.push(s)}if(n[J])for(let r of n[J]){let n=e._makeStorageReference(new E(t,r.name));i.items.push(n)}return i}(r,a,t);return X(null!==n),n}),u)).urlParams=o,c.errorHandler=ee(n),c);return e.storage.makeRequestWithTokens(d,ep)}function eb(e,t){var r;let n,i=(r=e._location.path,n=t.split("/").filter(e=>e.length>0).join("/"),0===r.length?n:r+"/"+n),s=new E(e._location.bucket,i);return new ew(e.storage,s)}function eA(e,t){let r=t?.[c];return null==r?null:E.makeFromBucketSpec(r,e)}class eS{constructor(e,t,r,n,i,s=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=n,this._firebaseVersion=i,this._isUsingEmulator=s,this._bucket=null,this._host=u,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,null!=n?this._bucket=E.makeFromBucketSpec(n,this._host):this._bucket=eA(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=E.makeFromBucketSpec(this._url,e):this._bucket=eA(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){C("time",0,1/0,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){C("time",0,1/0,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){if(a._isFirebaseServerApp(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ew(this,e)}_makeRequest(e,t,r,n,i=!0){if(this._deleted)return new T(_());{let s=function(e,t,r,n,i,s,a=!0,o=!1){let l=P(e.urlParams),u=e.url+l,c=Object.assign({},e.headers);return t&&(c["X-Firebase-GMPID"]=t),null!==r&&r.length>0&&(c.Authorization="Firebase "+r),c["X-Firebase-Storage-Version"]="webjs/"+(s??"AppManager"),null!==n&&(c["X-Firebase-AppCheck"]=n),new N(u,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,a,o)}(e,this._appId,r,n,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,t){let[r,n]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,n).getPromise()}}let eC="@firebase/storage",eR="0.14.0",eP="storage";function ek(e,t,r,n={}){!function(e,t,r,n={}){e.host=`${t}:${r}`;let i=o.isCloudWorkstation(t);i&&(o.pingServer(`https://${e.host}/b`),o.updateEmulatorBanner("Storage",!0)),e._isUsingEmulator=!0,e._protocol=i?"https":"http";let{mockUserToken:s}=n;s&&(e._overrideAuthToken="string"==typeof s?s:o.createMockUserToken(s,e.app.options.projectId))}(e,t,r,n)}a._registerComponent(new l.Component(eP,function(e,{instanceIdentifier:t}){return new eS(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t,a.SDK_VERSION)},"PUBLIC").setMultipleInstances(!0)),a.registerVersion(eC,eR,""),a.registerVersion(eC,eR,"cjs2020"),r.StorageError=h,r.StringFormat=O,r._FbsBlob=q,r._Location=E,r._TaskEvent={STATE_CHANGED:"state_changed"},r._TaskState=el,r._UploadTask=ev,r._dataFromString=M,r._getChild=function(e,t){return eb(e,t)},r._invalidArgument=y,r._invalidRootOperation=v,r.connectStorageEmulator=ek,r.deleteObject=function(e){var t,r,n;let i,s;return(t=e=o.getModularInstance(e))._throwIfRoot("deleteObject"),r=t.storage,(i=new Y(R((n=t._location).fullServerUrl(),r.host,r._protocol),"DELETE",function(e,t){},r.maxOperationRetryTime)).successCodes=[200,204],i.errorHandler=et(n),s=i,t.storage.makeRequestWithTokens(s,ep)},r.getBlob=function(e,t){var r;let n;return r=e=o.getModularInstance(e),r._throwIfRoot("getBlob"),n=en(r.storage,r._location,t),r.storage.makeRequestWithTokens(n,e_).then(e=>void 0!==t?e.slice(0,t):e)},r.getBytes=function(e,t){var r;let n;return r=e=o.getModularInstance(e),r._throwIfRoot("getBytes"),n=en(r.storage,r._location,t),r.storage.makeRequestWithTokens(n,eg).then(e=>void 0!==t?e.slice(0,t):e)},r.getDownloadURL=function(e){var t,n,i,s;let a,l,u,c;return(t=e=o.getModularInstance(e))._throwIfRoot("getDownloadURL"),n=t.storage,i=t._location,s=H(),a=R(i.fullServerUrl(),n.host,n._protocol),l=n.maxOperationRetryTime,(u=new Y(a,"GET",function(e,t){let r=K(n,t,s);return X(null!==r),function(e,t,r,n){let i=B(t);if(null===i||!b(i.downloadTokens))return null;let s=i.downloadTokens;if(0===s.length)return null;let a=encodeURIComponent;return s.split(",").map(t=>{let i=e.bucket,s=e.fullPath;return R("/b/"+a(i)+"/o/"+a(s),r,n)+P({alt:"media",token:t})})[0]}(r,t,n.host,n._protocol)},l)).errorHandler=et(i),c=u,t.storage.makeRequestWithTokens(c,ep).then(e=>{if(null===e)throw new h(r.StorageErrorCode.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e})},r.getMetadata=function(e){var t;let r;return(t=e=o.getModularInstance(e))._throwIfRoot("getMetadata"),r=er(t.storage,t._location,H()),t.storage.makeRequestWithTokens(r,ep)},r.getStorage=function(e=a.getApp(),t){e=o.getModularInstance(e);let r=a._getProvider(e,eP).getImmediate({identifier:t}),n=o.getDefaultEmulatorHostnameAndPort("storage");return n&&ek(r,...n),r},r.getStream=function(e,t){throw Error("getStream() is only supported by NodeJS builds")},r.list=function(e,t){return eT(e=o.getModularInstance(e),t)},r.listAll=function(e){let t;return t={prefixes:[],items:[]},eE(e=o.getModularInstance(e),t).then(()=>t)},r.ref=function(e,t){var n=e=o.getModularInstance(e);if(!(t&&/^[A-Za-z]+:\/\//.test(t)))return function e(t,n){if(t instanceof eS){if(null==t._bucket)throw new h(r.StorageErrorCode.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+c+"' property when initializing the app?");let i=new ew(t,t._bucket);return null!=n?e(i,n):i}return void 0!==n?eb(t,n):t}(n,t);if(n instanceof eS)return new ew(n,t);throw y("To use ref(service, url), the first argument must be a Storage instance.")},r.updateMetadata=function(e,t){var r,n,i,s;let a,l,u,c,h;return r=e=o.getModularInstance(e),r._throwIfRoot("updateMetadata"),n=r.storage,i=r._location,s=H(),a=R(i.fullServerUrl(),n.host,n._protocol),l=W(t,s),u=n.maxOperationRetryTime,(c=new Y(a,"PATCH",Z(n,s),u)).headers={"Content-Type":"application/json; charset=utf-8"},c.body=l,c.errorHandler=et(i),h=c,r.storage.makeRequestWithTokens(h,ep)},r.uploadBytes=function(e,t,r){return eI(e=o.getModularInstance(e),t,r)},r.uploadBytesResumable=function(e,t,r){var n;return n=e=o.getModularInstance(e),n._throwIfRoot("uploadBytesResumable"),new ev(n,new q(t),r)},r.uploadString=function(e,t,r,n){return function(e,t,r=O.RAW,n){e._throwIfRoot("uploadString");let i=M(r,t),s={...n};return null==s.contentType&&null!=i.contentType&&(s.contentType=i.contentType),eI(e,i.data,s)}(e=o.getModularInstance(e),t,r,n)}},616383,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e.r(4157);Object.keys(n).forEach(function(e){"default"===e||r.hasOwnProperty(e)||Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}})})},597482,e=>{"use strict";var t=e.i(151495);let r={container:{get:()=>({})}},n={currentUser:null,onAuthStateChanged:()=>()=>{},signOut:async()=>{},getApp:()=>({container:r.container}),app:{container:r.container},INTERNAL:r,container:r.container,collection:()=>({doc:()=>({get:async()=>({exists:()=>!1})})}),doc:()=>({get:async()=>({exists:()=>!1})}),ref:()=>({put:async()=>({})})};e.g.firebase=e.g.firebase||{INTERNAL:r},e.g.firebaseApp=e.g.firebaseApp||n,e.g._firebaseApp=e.g._firebaseApp||n,e.g.firebaseInternalContainer=r.container;let i=null,s=null,a=null,o=null;function l(){if(!i)try{let{initializeApp:r,getApps:n}=e.r(934168),{getAuth:l}=e.r(76436),{initializeFirestore:u,CACHE_SIZE_UNLIMITED:c}=e.r(14756),{getStorage:h}=e.r(616383),d=(t.default.env.NEXT_PUBLIC_FIREBASE_API_KEY??"").trim(),f={apiKey:d,authDomain:(t.default.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN??"").trim(),projectId:(t.default.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID??"").trim(),storageBucket:(t.default.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET??"").trim(),messagingSenderId:(t.default.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID??"").trim(),appId:(t.default.env.NEXT_PUBLIC_FIREBASE_APP_ID??"").trim()};d&&(i=0===n().length?r(f):n()[0])&&"1"!==t.default.env.SKIP_AUTH&&(s=l(i),a=u(i,{experimentalForceLongPolling:!0,cacheSizeBytes:c}),o=h(i))}catch(e){}}let u=(l(),s||n),c=(l(),a||n),h=(l(),o||n);l(),e.s(["auth",0,u,"db",0,c,"storage",0,h])}]);