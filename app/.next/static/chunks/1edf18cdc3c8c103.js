(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,587975,e=>{"use strict";let t=(0,e.i(946089).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],587975)},763739,e=>{"use strict";let t=(0,e.i(946089).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>t],763739)},482142,e=>{"use strict";let t=(0,e.i(946089).default)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]);e.s(["TrendingDown",()=>t],482142)},338346,e=>{"use strict";var t=e.i(430459),a=e.i(833145),s=e.i(615090);e.i(240925);var i=e.i(977031),l=e.i(597482),n=e.i(416493),c=e.i(749442),r=e.i(557354),o=e.i(482142),d=e.i(860205),m=e.i(91435),x=e.i(763739),u=e.i(651752),h=e.i(167301),p=e.i(359887),j=e.i(374406),f=e.i(255006);let y={draft:{color:"#71717a",label:"Rascunho"},generating:{color:"#3b82f6",label:"Gerando"},review:{color:"#f59e0b",label:"Avaliar"},approved:{color:"#10b981",label:"Aprovado"},adjusting:{color:"#8b5cf6",label:"Ajustando"},executing:{color:"#06b6d4",label:"Executando"},completed:{color:"#10b981",label:"ConcluÃ­do"},killed:{color:"#ef4444",label:"Cancelado"}};function v({data:e,maxValue:a}){return(0,t.jsx)("div",{className:"flex items-end gap-1 h-24",children:e.map((e,i)=>{let l=a>0?e.count/a*100:0;return(0,t.jsx)(s.motion.div,{initial:{height:0},animate:{height:`${l}%`},transition:{delay:.1*i,duration:.3},className:"flex-1 rounded-t-sm transition-all hover:opacity-80",style:{backgroundColor:e.color,minHeight:e.count>0?"8px":"2px"},title:`${e.label}: ${e.count}`},e.status)})})}function b({data:e,total:a}){let i=0;return(0,t.jsxs)("div",{className:"relative w-32 h-32",children:[(0,t.jsxs)("svg",{viewBox:"0 0 36 36",className:"w-full h-full transform -rotate-90",children:[(0,t.jsx)("circle",{cx:"18",cy:"18",r:"15.9",fill:"none",stroke:"#27272a",strokeWidth:"3"}),e.map((e,l)=>{let n=a>0?e.count/a*100:0,c=`${n} ${100-n}`,r=-i;return i+=n,(0,t.jsx)(s.motion.circle,{cx:"18",cy:"18",r:"15.9",fill:"none",stroke:e.color,strokeWidth:"3",strokeDasharray:c,strokeDashoffset:r,strokeLinecap:"round",initial:{opacity:0},animate:{opacity:1},transition:{delay:.1*l}},e.status)})]}),(0,t.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,t.jsx)("span",{className:"text-2xl font-bold text-white",children:a}),(0,t.jsx)("span",{className:"text-xs text-zinc-500",children:"total"})]})]})}function g({icon:e,label:a,value:s,trend:i,color:l="emerald"}){return(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:(0,f.cn)("flex h-10 w-10 items-center justify-center rounded-lg",{emerald:"bg-emerald-500/10 text-emerald-400",amber:"bg-amber-500/10 text-amber-400",red:"bg-red-500/10 text-red-400",blue:"bg-blue-500/10 text-blue-400"}[l]),children:(0,t.jsx)(e,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-zinc-500",children:a}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("p",{className:"text-lg font-semibold text-white",children:s}),i&&(0,t.jsxs)("span",{className:(0,f.cn)("flex items-center text-xs",i.positive?"text-emerald-400":"text-red-400"),children:[i.positive?(0,t.jsx)(r.TrendingUp,{className:"h-3 w-3"}):(0,t.jsx)(o.TrendingDown,{className:"h-3 w-3"}),Math.abs(i.value),"%"]})]})]})]})}function N({funnels:e,decisions:i,className:l}){let n=(0,a.useMemo)(()=>{let t=Object.entries(y).map(([t,a])=>({status:t,count:e.filter(e=>e.status===t).length,...a})),a=e.length,s=e.filter(e=>!["completed","killed","draft"].includes(e.status)).length,l=e.filter(e=>"approved"===e.status).length,n=e.filter(e=>"killed"===e.status).length,c=new Date;c.setDate(1),c.setHours(0,0,0,0);let r=i.filter(e=>(e.createdAt?.toDate?.()||new Date(e.createdAt))>=c).length,o=i.filter(e=>"EXECUTAR"===e.type).length,d=o+i.filter(e=>"AJUSTAR"===e.type).length+i.filter(e=>"MATAR"===e.type).length;return{statusCounts:t,total:a,active:s,approved:l,killed:n,decisionsThisMonth:r,approvalRate:d>0?Math.round(o/d*100):0,objectiveCounts:["leads","sales","calls","retention"].map(t=>({objective:t,count:e.filter(e=>e.context.objective===t).length})),maxStatusCount:Math.max(...t.map(e=>e.count))}},[e,i]);return 0===e.length?null:(0,t.jsxs)("div",{className:(0,f.cn)("space-y-6",l),children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(j.Activity,{className:"h-5 w-5 text-emerald-400"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Analytics"})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,t.jsx)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card-premium p-4",children:(0,t.jsx)(g,{icon:d.Target,label:"Total de Funis",value:n.total,color:"emerald"})}),(0,t.jsx)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"card-premium p-4",children:(0,t.jsx)(g,{icon:u.Zap,label:"Funis Ativos",value:n.active,color:"blue"})}),(0,t.jsx)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"card-premium p-4",children:(0,t.jsx)(g,{icon:m.CheckCircle2,label:"Taxa de AprovaÃ§Ã£o",value:`${n.approvalRate}%`,trend:{value:n.approvalRate,positive:n.approvalRate>=50},color:"emerald"})}),(0,t.jsx)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"card-premium p-4",children:(0,t.jsx)(g,{icon:x.Clock,label:"DecisÃµes este mÃªs",value:n.decisionsThisMonth,color:"amber"})})]}),(0,t.jsxs)("div",{className:"grid gap-5 md:grid-cols-2",children:[(0,t.jsxs)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"card-premium p-5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)(p.PieChart,{className:"h-4 w-4 text-zinc-500"}),(0,t.jsx)("h4",{className:"text-sm font-medium text-zinc-400",children:"DistribuiÃ§Ã£o por Status"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-6",children:[(0,t.jsx)(b,{data:n.statusCounts.filter(e=>e.count>0),total:n.total}),(0,t.jsx)("div",{className:"flex-1 space-y-2",children:n.statusCounts.filter(e=>e.count>0).map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),(0,t.jsx)("span",{className:"text-zinc-400",children:e.label})]}),(0,t.jsx)("span",{className:"font-medium text-white",children:e.count})]},e.status))})]})]}),(0,t.jsxs)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"card-premium p-5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)(h.BarChart3,{className:"h-4 w-4 text-zinc-500"}),(0,t.jsx)("h4",{className:"text-sm font-medium text-zinc-400",children:"Funis por Status"})]}),(0,t.jsx)(v,{data:n.statusCounts,maxValue:n.maxStatusCount}),(0,t.jsx)("div",{className:"flex justify-between mt-2 text-xs text-zinc-600",children:n.statusCounts.slice(0,4).map(e=>(0,t.jsx)("span",{children:e.label.slice(0,3)},e.status))})]})]}),(0,t.jsxs)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"card-premium p-5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)(d.Target,{className:"h-4 w-4 text-zinc-500"}),(0,t.jsx)("h4",{className:"text-sm font-medium text-zinc-400",children:"Funis por Objetivo"})]}),(0,t.jsx)("div",{className:"grid grid-cols-4 gap-4",children:n.objectiveCounts.map((e,a)=>{let i=n.total>0?Math.round(e.count/n.total*100):0,l={leads:{label:"Leads",icon:"ðŸ“§"},sales:{label:"Vendas",icon:"ðŸ’°"},calls:{label:"Chamadas",icon:"ðŸ“ž"},retention:{label:"RetenÃ§Ã£o",icon:"ðŸ”„"}};return(0,t.jsxs)(s.motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.7+.1*a},className:"text-center p-3 rounded-lg bg-white/[0.02]",children:[(0,t.jsx)("div",{className:"text-2xl mb-1",children:l[e.objective]?.icon||"ðŸ“Š"}),(0,t.jsx)("p",{className:"text-lg font-semibold text-white",children:e.count}),(0,t.jsx)("p",{className:"text-xs text-zinc-500",children:l[e.objective]?.label||e.objective}),(0,t.jsx)("div",{className:"mt-2 h-1 bg-zinc-800 rounded-full overflow-hidden",children:(0,t.jsx)(s.motion.div,{initial:{width:0},animate:{width:`${i}%`},transition:{delay:.8+.1*a,duration:.5},className:"h-full bg-emerald-500 rounded-full"})})]},e.objective)})})]})]})}var w=e.i(587975);function C(){let{user:e}=(0,n.useAuthStore)(),[r,o]=(0,a.useState)([]),[d,m]=(0,a.useState)([]),[x,u]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{!async function(){if(e)try{let t=(0,i.query)((0,i.collection)(l.db,"funnels"),(0,i.where)("userId","==",e.uid)),a=(await (0,i.getDocs)(t)).docs.map(e=>({id:e.id,...e.data()}));o(a);let s=(0,i.query)((0,i.collection)(l.db,"decisions"),(0,i.where)("userId","==",e.uid)),n=(await (0,i.getDocs)(s)).docs.map(e=>({id:e.id,...e.data()}));n.sort((e,t)=>{let a=e.createdAt?.seconds||0;return(t.createdAt?.seconds||0)-a}),m(n)}catch(e){console.error("Error loading analytics data:",e)}finally{u(!1)}}()},[e]),x)?(0,t.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,t.jsx)(c.Header,{title:"Analytics"}),(0,t.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,t.jsx)(w.Loader2,{className:"h-8 w-8 animate-spin text-zinc-500"})})]}):(0,t.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,t.jsx)(c.Header,{title:"Analytics"}),(0,t.jsxs)("div",{className:"flex-1 p-8",children:[(0,t.jsxs)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:[(0,t.jsxs)("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[(0,t.jsx)(h.BarChart3,{className:"h-7 w-7 text-emerald-400"}),"Analytics de Funis"]}),(0,t.jsx)("p",{className:"mt-2 text-zinc-400",children:"Visualize mÃ©tricas e insights sobre seus funis"})]}),0===r.length?(0,t.jsxs)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},className:"card-premium p-12 text-center",children:[(0,t.jsx)(h.BarChart3,{className:"h-12 w-12 text-zinc-600 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:"Nenhum dado ainda"}),(0,t.jsx)("p",{className:"text-zinc-500",children:"Crie seu primeiro funil para comeÃ§ar a ver analytics"})]}):(0,t.jsx)(N,{funnels:r,decisions:d})]})]})}e.s(["default",()=>C],338346)}]);